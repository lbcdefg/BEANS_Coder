"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5252],{68099:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{Z:function(){return ContentVoteMenu}});var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(52322),_heroicons_react_24_outline__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(80746),_heroicons_react_24_outline__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(64701),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(2784),_libs_fn_string__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(86922),_hooks_use_if_authorized__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(50270);function ContentVoteMenu(param){let{voted,voteCount,onAssent,onDissent}=param,{ifAuthorizedUserCallback}=(0,_hooks_use_if_authorized__WEBPACK_IMPORTED_MODULE_2__.Z)(),up=voted>0,down=voted<0,handleUp=(0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(()=>{ifAuthorizedUserCallback(()=>onAssent(!up))},[onAssent,up,ifAuthorizedUserCallback]),handleDown=(0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(()=>{ifAuthorizedUserCallback(()=>onDissent(!down))},[onDissent,down,ifAuthorizedUserCallback]);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("button",{type:"button",className:"group relative flex h-[38px] w-[35px] items-center justify-center rounded-l-md border border-gray-500/30 bg-white text-gray-700 hover:border-gray-500/70 focus:z-10 focus:outline-none focus:ring-0 dark:border-gray-500/70 dark:bg-gray-700 dark:text-gray-300 dark:hover:border-gray-500/30",onClick:handleDown,children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("span",{className:"sr-only",children:"비추천"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_heroicons_react_24_outline__WEBPACK_IMPORTED_MODULE_3__.Z,{className:(0,_libs_fn_string__WEBPACK_IMPORTED_MODULE_4__.z)(down?"text-red-500":"hover:text-red-500 group-hover:text-red-500","h-4 w-4")})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("span",{className:"flex h-[38px] w-[55px] items-center justify-center border border-x-0 border-gray-500/30 bg-white text-base font-medium text-gray-700 dark:border-gray-500/70 dark:bg-gray-700 dark:text-gray-300",children:voteCount}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("button",{type:"button",className:"group relative flex h-[38px] w-[35px] items-center justify-center rounded-r-md border border-gray-500/30 bg-white text-gray-700 hover:border-gray-500/70 focus:z-10 focus:outline-none focus:ring-0 dark:border-gray-500/70 dark:bg-gray-700 dark:text-gray-300 dark:hover:border-gray-500/30",onClick:handleUp,children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("span",{className:"sr-only",children:"추천"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_heroicons_react_24_outline__WEBPACK_IMPORTED_MODULE_5__.Z,{className:(0,_libs_fn_string__WEBPACK_IMPORTED_MODULE_4__.z)(up?"text-blue-500":"hover:text-blue-500 group-hover:text-blue-500","h-4 w-4")})]})]})}},39266:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{W4:function(){return useArticleDetailContext},ZP:function(){return ArticleDetailProvider}});var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(52322),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(2784),_hooks_use_refined_is_owner__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(33396);let ArticleDetailContext=(0,react__WEBPACK_IMPORTED_MODULE_1__.createContext)(void 0);function ArticleDetailProvider(param){let{article,children}=param,currentBoard=article.category.parent?article.category.parent.code:article.category.code,value=(0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(()=>({state:{article,isOwner:(0,_hooks_use_refined_is_owner__WEBPACK_IMPORTED_MODULE_2__.r)(article.displayAuthor.id),currentBoard}}),[article,currentBoard]);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(ArticleDetailContext.Provider,{value:value,children:children})}function useArticleDetailContext(){let context=(0,react__WEBPACK_IMPORTED_MODULE_1__.useContext)(ArticleDetailContext);if(void 0===context)throw Error("useArticleDetailContext must be used within a ArticleDetailProvider");return context}},875:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{H:function(){return TextEditor},R:function(){return extensions}});var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(52322),_remirror_react__WEBPACK_IMPORTED_MODULE_29__=__webpack_require__(16263);__webpack_require__(2784);var remirror_extensions__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(46669),remirror_extensions__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(24553),remirror_extensions__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(78390),remirror_extensions__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(62546),remirror_extensions__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(35846),remirror_extensions__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(83184),remirror_extensions__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(8987),remirror_extensions__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(76519),remirror_extensions__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(52486),remirror_extensions__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(50557),remirror_extensions__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__(46606),remirror_extensions__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__(81696),remirror_extensions__WEBPACK_IMPORTED_MODULE_23__=__webpack_require__(18868),remirror_extensions__WEBPACK_IMPORTED_MODULE_24__=__webpack_require__(79183),remirror_extensions__WEBPACK_IMPORTED_MODULE_25__=__webpack_require__(83740),remirror_extensions__WEBPACK_IMPORTED_MODULE_26__=__webpack_require__(58924),remirror_extensions__WEBPACK_IMPORTED_MODULE_27__=__webpack_require__(89515),remirror_extensions__WEBPACK_IMPORTED_MODULE_28__=__webpack_require__(97054);__webpack_require__(61603),__webpack_require__(70177),__webpack_require__(92947),__webpack_require__(47030),__webpack_require__(4219),__webpack_require__(34092);var _hooks_use_okky_comment_message__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(94746),_components_shared_editor_code_block_langs__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(47529),_components_shared_editor_image_uploader__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(48870);let placeholder=(0,_hooks_use_okky_comment_message__WEBPACK_IMPORTED_MODULE_10__.Z)(),extensions=()=>[new remirror_extensions__WEBPACK_IMPORTED_MODULE_11__.X({placeholder}),new remirror_extensions__WEBPACK_IMPORTED_MODULE_12__.e,new remirror_extensions__WEBPACK_IMPORTED_MODULE_13__.H,new remirror_extensions__WEBPACK_IMPORTED_MODULE_14__.f,new remirror_extensions__WEBPACK_IMPORTED_MODULE_15__.A,new remirror_extensions__WEBPACK_IMPORTED_MODULE_16__.V,new remirror_extensions__WEBPACK_IMPORTED_MODULE_17__.z,new remirror_extensions__WEBPACK_IMPORTED_MODULE_18__.l,new remirror_extensions__WEBPACK_IMPORTED_MODULE_19__.W({supportedLanguages:_components_shared_editor_code_block_langs__WEBPACK_IMPORTED_MODULE_8__.Z}),new remirror_extensions__WEBPACK_IMPORTED_MODULE_20__.V,new remirror_extensions__WEBPACK_IMPORTED_MODULE_21__.y5({autoLink:!0}),new remirror_extensions__WEBPACK_IMPORTED_MODULE_22__.Gc({enableResizing:!0,uploadHandler:_components_shared_editor_image_uploader__WEBPACK_IMPORTED_MODULE_9__.Z}),new remirror_extensions__WEBPACK_IMPORTED_MODULE_23__.vI,new remirror_extensions__WEBPACK_IMPORTED_MODULE_24__.UQ,new remirror_extensions__WEBPACK_IMPORTED_MODULE_24__._3,new remirror_extensions__WEBPACK_IMPORTED_MODULE_25__.a({enableResizing:!0}),new remirror_extensions__WEBPACK_IMPORTED_MODULE_26__.h,new remirror_extensions__WEBPACK_IMPORTED_MODULE_27__.U,new remirror_extensions__WEBPACK_IMPORTED_MODULE_28__.D({extraAttributes:{type:"user"},matchers:[{name:"at",char:"@",matchOffset:0}],appendText:" "})],TextEditor=()=>{let{getRootProps}=(0,_remirror_react__WEBPACK_IMPORTED_MODULE_29__.rj)();return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{...getRootProps(),className:"max-h-[300px] overflow-y-auto"})}},16781:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:function(){return ReplyEditor}});var jsx_runtime=__webpack_require__(52322),ExclamationCircleIcon=__webpack_require__(17745),yup=__webpack_require__(96240),remirror_react_core=__webpack_require__(16263),remirror_react_hooks=__webpack_require__(46376),react=__webpack_require__(2784),index_esm=__webpack_require__(32439),remirror_core_utils=__webpack_require__(85775),es=__webpack_require__(24511),clear_zero_space=__webpack_require__(11802),shared_alert=__webpack_require__(43707),floating_link_toolbar=__webpack_require__(2236),image_avatar=__webpack_require__(89746),remirror=__webpack_require__(875),toolbar=__webpack_require__(75081),remirror_react_components=__webpack_require__(59511),remirror_core_helpers=__webpack_require__(62120);function UserSuggestor(){let[users]=(0,react.useState)([]),{state,getMenuProps,getItemProps,indexIsHovered,indexIsSelected}=(0,remirror_react_hooks.HK)({items:users}),enabled=!!state;return(0,jsx_runtime.jsx)(remirror_react_components.jQ,{positioner:"cursor",enabled:enabled,placement:"bottom-start",children:(0,jsx_runtime.jsx)("div",{...getMenuProps(),className:"suggestions",children:enabled&&users.map((user,index)=>{let isHighlighted=indexIsSelected(index),isHovered=indexIsHovered(index);return(0,jsx_runtime.jsx)("div",{className:(0,remirror_core_helpers.cx)("suggestion",isHighlighted&&"highlighted",isHovered&&"hovered"),...getItemProps({item:user,index}),children:user.label},user.id)})})})}var without_email_verified=__webpack_require__(74812),without_session=__webpack_require__(65620),context=__webpack_require__(11712),submit_button=__webpack_require__(36046);let schema=es.Ry().shape({reply:es.Z_().min(1,"내용을 최소 1자 이상 입력해주세요.").max(204800,"내용은 최대 204,800자 까지 입력가능합니다.").transform((_,val)=>(0,clear_zero_space.$)(val)).required("내용을 입력해주세요.")}).required();function ReplyEditor(param){var ref;let{onSubmit,comment,reply,error,isEditMode=!1,onCancel}=param,{state:{needToEmailVerify,needToLogin,displayImage}}=(0,context.k)(),defaultContent=(null==reply?void 0:reply.displayContent)||comment.text,[submitting,setSubmitting]=(0,react.useState)(!1),[bodyType]=(0,react.useState)("HTML"),{reset,setValue,handleSubmit,formState:{errors,isDirty}}=(0,index_esm.cI)({resolver:(0,yup.X)(schema),defaultValues:{reply:isEditMode?defaultContent:void 0}}),{nickname,id}=(null==reply?void 0:reply.displayAuthor)||{},{manager,state,getContext}=(0,remirror_react_core.iF)({extensions:remirror.R,content:isEditMode?defaultContent:void 0!==reply?'<span type="user" class="remirror-mention-atom remirror-mention-atom-at" data-mention-atom-id="'.concat(id,'" data-mention-atom-name="at">').concat(nickname,"</span><br/>"):void 0,selection:"start",stringHandler:"html"}),handleReplySubmit=handleSubmit(async param=>{let{reply}=param;if(setSubmitting(!0),onSubmit){let result=await onSubmit({bodyType,reply});if(result){var ref;reset(),null===(ref=getContext())||void 0===ref||ref.clearContent()}setSubmitting(!1)}}),handleDocChange=(0,react.useCallback)(state=>{let reply=state.doc.content.size>2?(0,remirror_core_utils.Em)(state.doc):"";setValue("reply",reply,{shouldDirty:!0})},[setValue]);return needToLogin?(0,jsx_runtime.jsx)(without_session.Z,{}):needToEmailVerify?(0,jsx_runtime.jsx)(without_email_verified.Z,{}):(0,jsx_runtime.jsxs)("div",{className:"flex space-x-4",children:[(0,jsx_runtime.jsx)("div",{className:"shrink-0",children:(0,jsx_runtime.jsx)(image_avatar.Z,{src:displayImage,className:"h-10 w-10 rounded-full",alt:"프로필 사진"})}),(0,jsx_runtime.jsx)("div",{className:"min-w-0 flex-1",children:(0,jsx_runtime.jsxs)("form",{onSubmit:e=>e.preventDefault(),children:[(0,jsx_runtime.jsxs)("div",{className:"remirror-theme rounded-md border border-gray-500/30 text-gray-900 shadow-sm dark:border-gray-500/70 dark:text-gray-100",children:[(0,jsx_runtime.jsx)("label",{htmlFor:"reply",className:"sr-only",children:"Reply Editor"}),(0,jsx_runtime.jsxs)(remirror_react_core.O1,{classNames:["remirror-reply"],manager:manager,onChange(parameter){handleDocChange(parameter.state)},hooks:[()=>{let handleSubmitShortcut=(0,react.useCallback)(()=>(isDirty&&handleReplySubmit(),!0),[isDirty]);(0,remirror_react_hooks.og)("Mod-Enter",handleSubmitShortcut)}],initialContent:state,autoFocus:"end",children:[(0,jsx_runtime.jsx)(toolbar.Z,{}),(0,jsx_runtime.jsx)(remirror.H,{}),(0,jsx_runtime.jsx)(UserSuggestor,{}),(0,jsx_runtime.jsx)(floating_link_toolbar.Z,{})]}),errors.reply&&(0,jsx_runtime.jsxs)("p",{className:"group mt-1 inline-flex items-start space-x-2 text-sm",children:[(0,jsx_runtime.jsx)(ExclamationCircleIcon.Z,{className:"h-5 w-5 flex-shrink-0 text-red-500","aria-hidden":"true"}),(0,jsx_runtime.jsx)("span",{className:"text-red-500",children:null===(ref=errors.reply)||void 0===ref?void 0:ref.message})]})]}),error&&error.has&&(0,jsx_runtime.jsx)("div",{className:"my-4",children:(0,jsx_runtime.jsx)(shared_alert.WY,{title:"댓글 작성실패",children:(0,jsx_runtime.jsx)("div",{dangerouslySetInnerHTML:{__html:error.message}})})}),(0,jsx_runtime.jsxs)("div",{className:"mt-3 flex items-center justify-end gap-x-4",children:[(0,jsx_runtime.jsx)("button",{type:"button",className:"rounded-md border border-gray-500/30 bg-white px-3 py-2 text-sm font-medium shadow-sm hover:bg-gray-100 focus:outline-none dark:border-gray-500/70 dark:bg-gray-700 dark:hover:bg-gray-600",onClick:onCancel,children:"취소"}),(0,jsx_runtime.jsx)(submit_button.Z,{loading:submitting,loadingText:"저장중...",disabled:!isDirty,onClick:handleReplySubmit,children:"댓글 쓰기"})]})]})})]})}},75081:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{Z:function(){return Toolbar}});var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(52322),_heroicons_react_24_outline__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(5860),_remirror_react__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(16263),_remirror_react__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(59511),remirror__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(62120),_components_shared_editor_image_popover__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(46658),_components_shared_editor_link_popover__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(49894),_components_shared_editor_table_popover__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(65013),_components_shared_editor_video_popover__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(58932);function Divider(){return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"mx-2 inline-flex h-4 w-[1px] bg-gray-500/30 dark:bg-gray-500/70"})}function List(){let{active,chain}=(0,_remirror_react__WEBPACK_IMPORTED_MODULE_5__.rj)();return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("nav",{className:"relative z-0 inline-flex space-x-1",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("button",{className:(0,remirror__WEBPACK_IMPORTED_MODULE_6__.cx)(active.bulletList()?"bg-gray-200 dark:bg-gray-700":"hover:bg-gray-200 dark:hover:bg-gray-700","inline-flex items-center rounded-md p-2 text-sm font-medium"),type:"button",onClick:()=>chain.toggleBulletList().focus().run(),children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("span",{className:"sr-only",children:"toggle bullet list"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_remirror_react__WEBPACK_IMPORTED_MODULE_7__.JO,{name:"listUnordered"})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("button",{className:(0,remirror__WEBPACK_IMPORTED_MODULE_6__.cx)(active.orderedList()?"bg-gray-200 dark:bg-gray-700":"hover:bg-gray-200 dark:hover:bg-gray-700","inline-flex items-center rounded-md p-2 text-sm font-medium"),type:"button",onClick:()=>chain.toggleOrderedList().focus().run(),children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("span",{className:"sr-only",children:"toggle ordered list"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_remirror_react__WEBPACK_IMPORTED_MODULE_7__.JO,{name:"listOrdered"})]})]})}function Toolbar(){let{active,chain}=(0,_remirror_react__WEBPACK_IMPORTED_MODULE_5__.rj)({autoUpdate:!0});return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"relative z-10 block items-center rounded-t-md border-b border-gray-500/30 bg-gray-50 px-1 py-0.5 text-gray-900 dark:border-gray-500/70 dark:bg-gray-900/50 dark:text-gray-100 md:flex",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("nav",{className:"relative z-0 inline-flex space-x-1 rounded-md",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("button",{className:(0,remirror__WEBPACK_IMPORTED_MODULE_6__.cx)(active.bold()?"bg-gray-200 dark:bg-gray-700":"hover:bg-gray-200 dark:hover:bg-gray-700","inline-flex items-center rounded-md p-2 text-sm font-medium"),type:"button",onClick:()=>chain.toggleBold().focus().run(),children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("span",{className:"sr-only",children:"Bold"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_remirror_react__WEBPACK_IMPORTED_MODULE_7__.JO,{name:"bold"})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("button",{className:(0,remirror__WEBPACK_IMPORTED_MODULE_6__.cx)(active.italic()?"bg-gray-200 dark:bg-gray-700":"hover:bg-gray-200 dark:hover:bg-gray-700","inline-flex items-center rounded-md p-2 text-sm font-medium"),type:"button",onClick:()=>chain.toggleItalic().focus().run(),children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_remirror_react__WEBPACK_IMPORTED_MODULE_7__.JO,{name:"italic"})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("button",{className:(0,remirror__WEBPACK_IMPORTED_MODULE_6__.cx)(active.underline()?"bg-gray-200 dark:bg-gray-700":"hover:bg-gray-200 dark:hover:bg-gray-700","inline-flex items-center rounded-md p-2 text-sm font-medium"),type:"button",onClick:()=>chain.toggleUnderline().focus().run(),children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_remirror_react__WEBPACK_IMPORTED_MODULE_7__.JO,{name:"underline"})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("button",{className:(0,remirror__WEBPACK_IMPORTED_MODULE_6__.cx)(active.strike()?"bg-gray-200 dark:bg-gray-700":"hover:bg-gray-200 dark:hover:bg-gray-700","inline-flex items-center rounded-md p-2 text-sm font-medium"),type:"button",onClick:()=>chain.toggleStrike().focus().run(),children:[" ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_remirror_react__WEBPACK_IMPORTED_MODULE_7__.JO,{name:"strikethrough"})]})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(Divider,{}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(List,{}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(Divider,{}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("button",{className:(0,remirror__WEBPACK_IMPORTED_MODULE_6__.cx)(active.blockquote()?"bg-gray-200 dark:bg-gray-700":"hover:bg-gray-200 dark:hover:bg-gray-700","inline-flex items-center rounded-md p-2 text-sm font-medium"),type:"button",onClick:()=>chain.toggleBlockquote().focus().run(),children:[" ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_remirror_react__WEBPACK_IMPORTED_MODULE_7__.JO,{name:"doubleQuotesR"})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("button",{className:(0,remirror__WEBPACK_IMPORTED_MODULE_6__.cx)(active.code()?"bg-gray-200 dark:bg-gray-700":"hover:bg-gray-200 dark:hover:bg-gray-700","inline-flex items-center rounded-md p-2 text-sm font-medium"),type:"button",onClick:()=>chain.toggleCode().focus().run(),children:[" ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_remirror_react__WEBPACK_IMPORTED_MODULE_7__.JO,{name:"codeLine"})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("nav",{className:"relative z-0 inline-flex space-x-1 rounded-md",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("button",{className:(0,remirror__WEBPACK_IMPORTED_MODULE_6__.cx)(active.codeBlock()?"bg-gray-200 dark:bg-gray-700":"hover:bg-gray-200 dark:hover:bg-gray-700","inline-flex items-center rounded-md p-2 text-sm font-medium"),type:"button",onClick:()=>chain.toggleCodeBlock({}).focus().run(),children:[" ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_remirror_react__WEBPACK_IMPORTED_MODULE_7__.JO,{name:"codeView"})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components_shared_editor_link_popover__WEBPACK_IMPORTED_MODULE_2__.Z,{}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components_shared_editor_image_popover__WEBPACK_IMPORTED_MODULE_1__.Z,{}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components_shared_editor_video_popover__WEBPACK_IMPORTED_MODULE_4__.Z,{}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components_shared_editor_table_popover__WEBPACK_IMPORTED_MODULE_3__.Z,{onSet:(row,cell)=>chain.createTable({rowsCount:row,columnsCount:cell,withHeaderRow:!0}).focus().run()}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("button",{className:(0,remirror__WEBPACK_IMPORTED_MODULE_6__.cx)(active.codeBlock()?"bg-gray-200 dark:bg-gray-700":"hover:bg-gray-200 dark:hover:bg-gray-700","inline-flex items-center rounded-md p-2 text-sm font-medium"),type:"button",onClick:()=>chain.insertHorizontalRule().focus().run(),children:[" ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_heroicons_react_24_outline__WEBPACK_IMPORTED_MODULE_8__.Z,{className:"h-4 w-4"})]})]})]})}},74812:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{Z:function(){return EditorWithoutEmailVerified}});var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(52322),_heroicons_react_24_outline__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(59531),_heroicons_react_24_outline__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(1162),next_link__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(41664),next_link__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(next_link__WEBPACK_IMPORTED_MODULE_1__),_hooks_use_return_url__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(72502),_components_auth_context__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(11712),_components_shared_image_avatar__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(89746);function EditorWithoutEmailVerified(){let{state:{displayImage}}=(0,_components_auth_context__WEBPACK_IMPORTED_MODULE_3__.k)(),linkProps=(0,_hooks_use_return_url__WEBPACK_IMPORTED_MODULE_2__.Z)("/settings/account");return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"flex space-x-2 sm:space-x-4",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"shrink-0",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components_shared_image_avatar__WEBPACK_IMPORTED_MODULE_4__.Z,{src:displayImage,className:"h-10 w-10 rounded-full",alt:"프로필 사진"})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"relative flex-1",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("label",{htmlFor:"comment",className:"sr-only",children:"댓글을 쓰려면 이메일 인증이 필요합니다"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("textarea",{id:"comment",name:"comment",rows:2,readOnly:!0,className:"block w-full resize-none rounded-md border border-gray-500/30 bg-gray-50/50 text-base shadow-sm focus:border-gray-500 focus:outline-none focus:ring-0 dark:border-gray-500/70 dark:bg-gray-900/50",defaultValue:""}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("p",{className:"group absolute top-2.5 left-2 inline-flex items-start space-x-1 text-sm text-gray-500 hover:text-gray-900",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_heroicons_react_24_outline__WEBPACK_IMPORTED_MODULE_5__.Z,{className:"h-5 w-5 shrink-0 text-gray-400 group-hover:text-gray-500","aria-hidden":"true"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("span",{className:"text-sm text-gray-500",children:["댓글을 쓰려면"," ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(next_link__WEBPACK_IMPORTED_MODULE_1___default(),{...linkProps,className:"font-bold underline",children:"이메일 인증"}),"이 필요합니다."]})]})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("button",{type:"button",disabled:!0,className:"inline-flex items-center justify-center rounded-md border border-transparent bg-blue-500 px-3 py-2 text-sm font-medium text-white shadow-md hover:bg-blue-400 focus:outline-none focus:ring-offset-0 disabled:bg-blue-500 disabled:opacity-40 sm:hidden",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_heroicons_react_24_outline__WEBPACK_IMPORTED_MODULE_6__.Z,{className:"h-4 w-4"})})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"mt-1 hidden min-w-0 items-center justify-end sm:mt-3 sm:ml-14 sm:flex ",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("button",{type:"button",disabled:!0,className:"inline-flex items-center justify-center rounded-md border border-transparent bg-blue-500 px-8 py-2 text-sm font-medium text-white shadow-sm hover:bg-blue-400 focus:outline-none focus:ring-offset-0 disabled:bg-blue-500 disabled:opacity-40",children:"댓글 쓰기"})})]})}},65620:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{Z:function(){return EditorWithoutSession}});var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(52322),_heroicons_react_24_outline__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(59531),_heroicons_react_24_outline__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(1162),next_link__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(41664),next_link__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(next_link__WEBPACK_IMPORTED_MODULE_1__),_hooks_use_return_url__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(72502),_components_shared_image_avatar__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(89746);function EditorWithoutSession(){let linkProps=(0,_hooks_use_return_url__WEBPACK_IMPORTED_MODULE_2__.Z)("/login");return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"flex space-x-2 sm:space-x-4",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"shrink-0",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components_shared_image_avatar__WEBPACK_IMPORTED_MODULE_3__.Z,{src:"/icons/icon-profile.svg",className:"h-10 w-10 rounded-full",alt:"프로필 사진"})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"relative flex-1",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("label",{htmlFor:"comment",className:"sr-only",children:"댓글을 쓰려면 로그인이 필요합니다"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("textarea",{id:"comment",name:"comment",rows:2,readOnly:!0,className:"block w-full resize-none rounded-md border border-gray-500/30 bg-gray-50/50 text-base shadow-sm focus:border-gray-500 focus:outline-none focus:ring-0 dark:border-gray-500/70 dark:bg-gray-900/50",defaultValue:""}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("p",{className:"group absolute top-2.5 left-2 inline-flex items-start space-x-1 text-sm text-gray-500 hover:text-gray-900",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_heroicons_react_24_outline__WEBPACK_IMPORTED_MODULE_4__.Z,{className:"h-5 w-5 shrink-0 text-gray-400 group-hover:text-gray-500","aria-hidden":"true"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("span",{className:"text-sm text-gray-500",children:["댓글을 쓰려면"," ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(next_link__WEBPACK_IMPORTED_MODULE_1___default(),{...linkProps,className:"font-bold underline",children:"로그인"}),"이 필요합니다."]})]})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("button",{type:"button",disabled:!0,className:"inline-flex items-center justify-center rounded-md border border-transparent bg-blue-500 px-3 py-2 text-sm font-medium text-white shadow-md hover:bg-blue-400 focus:outline-none focus:ring-offset-0 disabled:bg-blue-500 disabled:opacity-40 sm:hidden",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_heroicons_react_24_outline__WEBPACK_IMPORTED_MODULE_5__.Z,{className:"h-4 w-4"})})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"mt-1 hidden min-w-0 items-center justify-end sm:mt-3 sm:ml-14 sm:flex ",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("button",{type:"button",disabled:!0,className:"inline-flex items-center justify-center rounded-md border border-transparent bg-blue-500 px-8 py-2 text-sm font-medium text-white shadow-sm hover:bg-blue-400 focus:outline-none focus:ring-offset-0 disabled:bg-blue-500 disabled:opacity-40",children:"댓글 쓰기"})})]})}},38293:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{Z:function(){return Comments}});var jsx_runtime=__webpack_require__(52322),dynamic=__webpack_require__(5152),dynamic_default=__webpack_require__.n(dynamic),react=__webpack_require__(2784),LockClosedIcon=__webpack_require__(15030),next_link=__webpack_require__(41664),link_default=__webpack_require__.n(next_link),comment_owner_menu=__webpack_require__(42749),ChevronDownIcon=__webpack_require__(80746),ChevronUpIcon=__webpack_require__(64701),concat=__webpack_require__(86922),use_if_authorized=__webpack_require__(50270);function CommentVoteMenu(param){let{voted,voteCount,onAssent,onDissent}=param,{ifAuthorizedUserCallback}=(0,use_if_authorized.Z)(),up=voted>0,down=voted<0,handleUp=(0,react.useCallback)(()=>{ifAuthorizedUserCallback(()=>onAssent(!up))},[onAssent,up,ifAuthorizedUserCallback]),handleDown=(0,react.useCallback)(()=>{ifAuthorizedUserCallback(()=>onDissent(!down))},[onDissent,down,ifAuthorizedUserCallback]);return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsxs)("button",{type:"button",className:"group relative flex h-[30px] w-[28px] items-center justify-center rounded-l-md border border-gray-500/30 bg-white text-gray-700 hover:border-gray-500/70 focus:z-10 focus:outline-none focus:ring-0 dark:border-gray-500/70 dark:bg-gray-700 dark:text-gray-300 dark:hover:border-gray-500/30",onClick:handleDown,children:[(0,jsx_runtime.jsx)("span",{className:"sr-only",children:"비추천"}),(0,jsx_runtime.jsx)(ChevronDownIcon.Z,{className:(0,concat.z)(down?"text-red-500":"hover:text-red-500 group-hover:text-red-500","h-3.5 w-3.5")})]}),(0,jsx_runtime.jsx)("span",{className:"flex h-[30px] w-[44px] items-center justify-center border border-x-0 border-gray-500/30 bg-white text-base font-medium text-gray-700 dark:border-gray-500/70 dark:bg-gray-700 dark:text-gray-300",children:voteCount}),(0,jsx_runtime.jsxs)("button",{type:"button",className:"group relative flex h-[30px] w-[28px] items-center justify-center rounded-r-md border border-gray-500/30 bg-white text-gray-700 hover:border-gray-500/70 focus:z-10 focus:outline-none focus:ring-0 dark:border-gray-500/70 dark:bg-gray-700 dark:text-gray-300 dark:hover:border-gray-500/30",onClick:handleUp,children:[(0,jsx_runtime.jsx)("span",{className:"sr-only",children:"추천"}),(0,jsx_runtime.jsx)(ChevronUpIcon.Z,{className:(0,concat.z)(up?"text-blue-500":"hover:text-blue-500 group-hover:text-blue-500","h-3.5 w-3.5")})]})]})}var disclosure=__webpack_require__(17377),esm_ChevronUpIcon=__webpack_require__(99299),editor_reply=__webpack_require__(16781),okky_web=__webpack_require__(26697),differenceInSeconds=__webpack_require__(16689),dist=__webpack_require__(36282),as=__webpack_require__(64612),date=__webpack_require__(61915),picture=__webpack_require__(22018),regex_link=__webpack_require__(26998);function useCommentsError(){let[error,setError]=(0,react.useState)(),[has,message,code]=(0,react.useMemo)(()=>{if(void 0===error)return[!1,"",void 0];let{code,message}=function(error){let errors=error.errors||[],message="S001"===error.code?errors[0].reason:error.message;return(0,as.as)({...error,message})}(error);return"S001"===code?[!0,message+'<br />\n            스팸 단어 확인은 <a href="mailto:info@okky.kr">info@okky.kr</a> 으로 문의해주세요.\n            <br />\n          * 악용될 우려가 있어 이메일로만 안내해 드리는 점 이해해주시기 바랍니다.',code]:[!0,message]},[error]);return{has,code,message,setError}}var context=__webpack_require__(11712);function refine(item){return{_raw:item,...item,displayCreatedAt:(0,date.no)(item.dateCreated),displayContent:(0,regex_link.q)(item.text),displayAuthor:{_raw:item.displayAuthor,...item.displayAuthor,displayImage:(0,picture.Z)(item.displayAuthor.pictureType,item.displayAuthor.picture),isWithdrawnUser:item.displayAuthor.withdraw,abbreviatedPoint:(0,dist.abbreviateNumber)(item.displayAuthor.activityPoint,1)},displayVoteCount:(0,dist.abbreviateNumber)(item.voteCount,1),hasChanges:(0,differenceInSeconds.Z)(new Date(item.lastUpdated),new Date(item.dateCreated))>0,isOwner:!1}}let curryComments=(indexOfComment,setComments)=>newComment=>{setComments(prev=>{let newComments=[...prev];return newComments.splice(indexOfComment,1,newComment),newComments})},curryReplies=(indexOfReply,replies)=>newReply=>(replies.splice(indexOfReply,1,newReply),replies);var browser_context=__webpack_require__(25273),bolt=__webpack_require__(42773),image_avatar=__webpack_require__(89746);let Viewer=dynamic_default()(()=>__webpack_require__.e(2635).then(__webpack_require__.bind(__webpack_require__,22635)),{loadableGenerated:{webpack:()=>[22635]},ssr:!1});function Reply(param){var ref;let{reply:replyFromProps,indexOfReply,comment,indexOfComment,setComments,onSubmit,onDelete,deleting}=param,{confirm}=(0,browser_context.G)(),{reply,assent,dissent,cancelAssent,cancelDissent,editReply,error}=function(replyFromProps,setComments,comment,indexOfComment,indexOfReply){let[fetching,setFetching]=(0,react.useState)(!1),[submitting,setSubmitting]=(0,react.useState)(!1),{setError,...error}=useCommentsError(),[reply,setReply]=(0,react.useState)(refine(replyFromProps)),{state:{avatar}}=(0,context.k)(),isOwner=(null==avatar?void 0:avatar.id)===reply.displayAuthor.id,setTargetedComment=curryComments(indexOfComment,setComments),getReplacedReplies=curryReplies(indexOfReply,comment.children),{voteCount,voted}=replyFromProps,vote=(0,react.useCallback)(props=>{setTargetedComment({...comment,children:getReplacedReplies({...replyFromProps,...props})})},[comment,replyFromProps,setTargetedComment,getReplacedReplies]),assent=(0,react.useCallback)(async()=>{setFetching(!0);let{ok}=await (0,okky_web.assentComment)(reply.id);return ok?(vote({voted:1,voteCount:voteCount+(-1===voted?2:1)}),setFetching(!1),!0):(setFetching(!1),!1)},[reply.id,voteCount,voted,vote]),cancelAssent=(0,react.useCallback)(async()=>{setFetching(!0);let{ok}=await (0,okky_web.cancelAssentForComment)(reply.id);return ok?(vote({voted:0,voteCount:voteCount-1}),setFetching(!1),!0):(setFetching(!1),!1)},[reply.id,voteCount,vote]),dissent=(0,react.useCallback)(async()=>{setFetching(!0);let{ok}=await (0,okky_web.dissentComment)(reply.id);return ok?(vote({voted:-1,voteCount:voteCount-(1===voted?2:1)}),setFetching(!1),!0):(setFetching(!1),!1)},[reply.id,voteCount,voted,vote]),cancelDissent=(0,react.useCallback)(async()=>{setFetching(!0);let{ok}=await (0,okky_web.cancelDissentForComment)(reply.id);return ok?(vote({voted:0,voteCount:voteCount+1}),setFetching(!1),!0):(setFetching(!1),!1)},[reply.id,voteCount,vote]),editReply=(0,react.useCallback)(async(parentId,replyFormData)=>{setSubmitting(!0);let{ok,result}=await (0,okky_web.updateChildComment)(parentId,reply.id,{body:{targetId:reply.id,note:{text:replyFormData.reply},textType:replyFormData.bodyType,voted:0}});if(!ok||!result)return setError((0,as.as)(result)),setSubmitting(!1),[];{setSubmitting(!1);let{text,lastUpdated}=result,editedReply={...replyFromProps,text,lastUpdated};return setTargetedComment({...comment,children:getReplacedReplies({...replyFromProps,text,lastUpdated})}),[editedReply]}},[reply,comment,replyFromProps,setError,setTargetedComment,getReplacedReplies]);return(0,react.useEffect)(()=>{setReply(refine(replyFromProps))},[replyFromProps]),{reply:{...reply,isOwner},assent,cancelAssent,dissent,cancelDissent,fetching,editReply,submitting,error}}(replyFromProps,setComments,comment,indexOfComment,indexOfReply),[isEditMode,setIsEditMode]=(0,react.useState)(!1),[isWritePanelOpen,setIsWritePanelOpen]=(0,react.useState)(!1),isSoftDeleted=replyFromProps.deleted,{ifAuthorizedUserCallback}=(0,use_if_authorized.Z)(),handleAssentClick=(0,react.useCallback)(upVote=>upVote?assent():cancelAssent(),[assent,cancelAssent]),handleDissentClick=(0,react.useCallback)(downVote=>downVote?dissent():cancelDissent(),[dissent,cancelDissent]),handleTrashClick=(0,react.useCallback)(async()=>{let answer=await confirm({title:"댓글 삭제",message:"댓글을 삭제하시겠습니까?"});answer&&onDelete(reply.id)},[onDelete,reply.id,confirm]),handleEditClick=(0,react.useCallback)(()=>{setIsEditMode(!0)},[]),handleReplyEdit=(0,react.useCallback)(async data=>{let[editedReply]=await editReply(reply.id,data);return!!editedReply&&(setIsEditMode(!1),!0)},[editReply,reply.id]),handleReplySubmit=(0,react.useCallback)(async data=>{let result=await onSubmit(reply.id,data);return!!result&&(setIsWritePanelOpen(prev=>!prev),!0)},[onSubmit,reply.id]),handleWriteClick=(0,react.useCallback)(()=>ifAuthorizedUserCallback(()=>setIsWritePanelOpen(prev=>!prev)),[ifAuthorizedUserCallback]),handleEditorCancel=(0,react.useCallback)(()=>{isEditMode?setIsEditMode(!1):setIsWritePanelOpen(!1)},[isEditMode]);return(0,jsx_runtime.jsx)("li",{className:"py-2.5",children:isEditMode?(0,jsx_runtime.jsx)(editor_reply.default,{isEditMode:!0,onCancel:handleEditorCancel,comment:comment,reply:reply,onSubmit:handleReplyEdit,error:error}):(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,jsx_runtime.jsx)("div",{className:"shrink-0",children:reply.displayAuthor.isWithdrawnUser?(0,jsx_runtime.jsx)(image_avatar.Z,{className:"h-7 w-7 rounded-full sm:h-10 sm:w-10",src:reply.displayAuthor.displayImage,alt:"프로필 사진"}):(0,jsx_runtime.jsx)(link_default(),{href:"/users/".concat(reply.displayAuthor.id),children:(0,jsx_runtime.jsx)(image_avatar.Z,{className:"h-7 w-7 rounded-full sm:h-10 sm:w-10",src:reply.displayAuthor.displayImage,alt:"프로필 사진"})})}),(0,jsx_runtime.jsxs)("div",{className:"flex flex-1 flex-col text-sm font-medium",children:[reply.displayAuthor.isWithdrawnUser?(0,jsx_runtime.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,jsx_runtime.jsx)("span",{className:"w-fit pl-0.5",children:reply.displayAuthor.nickname}),(0,jsx_runtime.jsx)(LockClosedIcon.Z,{className:"h-3 w-3"})]}):(0,jsx_runtime.jsx)(link_default(),{href:"/users/".concat(null===(ref=reply.displayAuthor)||void 0===ref?void 0:ref.id),className:"w-fit pl-0.5 text-gray-900 hover:text-blue-500 dark:text-gray-100 dark:hover:text-blue-200",children:reply.displayAuthor.nickname}),(0,jsx_runtime.jsxs)("div",{className:"flex items-center space-x-1 text-xs font-normal text-gray-700 dark:text-gray-300",children:[(0,jsx_runtime.jsxs)("span",{children:[(0,jsx_runtime.jsx)(bolt.Z,{className:"inline h-3 w-3"}),reply.displayAuthor.abbreviatedPoint]}),(0,jsx_runtime.jsx)("span",{children:"\xb7"}),(0,jsx_runtime.jsxs)("span",{children:[reply.displayCreatedAt," 전"]}),!isSoftDeleted&&reply.hasChanges&&(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("span",{children:"\xb7"}),(0,jsx_runtime.jsx)(link_default(),{href:"/comments/".concat(reply.id,"/changes"),className:"text-blue-500 hover:text-blue-300 dark:hover:text-blue-200",children:"수정됨"})]})]})]}),!isSoftDeleted&&(0,jsx_runtime.jsxs)("div",{className:"relative flex items-center space-x-3 sm:space-x-7",children:[(0,jsx_runtime.jsx)("div",{className:"flex",children:(0,jsx_runtime.jsx)(CommentVoteMenu,{voted:reply.voted,voteCount:reply.displayVoteCount,onAssent:handleAssentClick,onDissent:handleDissentClick})}),reply.isOwner&&(0,jsx_runtime.jsx)(comment_owner_menu.Z,{trashing:deleting,onTrash:handleTrashClick,onEdit:handleEditClick})]})]}),isSoftDeleted?(0,jsx_runtime.jsx)("div",{className:"my-1.5 flex-1 break-all rounded-md py-1.5 text-sm font-normal leading-relaxed text-gray-500 dark:text-gray-400",children:"해당 댓글은 작성자에 의해 삭제되었습니다."}):(0,jsx_runtime.jsx)("div",{className:"remirror-editor mb-2 flex-1 break-all text-sm font-normal leading-relaxed text-gray-700 dark:text-gray-300",children:(0,jsx_runtime.jsx)(Viewer,{content:reply.displayContent})}),!isSoftDeleted&&(0,jsx_runtime.jsx)("div",{children:(0,jsx_runtime.jsx)(disclosure.p,{children:()=>(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("div",{className:"flex space-x-4",children:(0,jsx_runtime.jsx)("button",{className:"text-xs font-normal text-gray-500 hover:text-blue-500 hover:no-underline focus:outline-none dark:text-gray-400 dark:hover:text-blue-200",onClick:handleWriteClick,children:isWritePanelOpen?"댓글 취소":"댓글 쓰기"})}),(0,jsx_runtime.jsx)("div",{children:(0,jsx_runtime.jsx)(disclosure.p,{children:(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:isWritePanelOpen&&(0,jsx_runtime.jsx)(disclosure.p.Panel,{static:!0,className:"text-sm",children:(0,jsx_runtime.jsx)("div",{className:"mt-3",children:(0,jsx_runtime.jsx)(editor_reply.default,{comment:comment,reply:reply,onCancel:handleEditorCancel,onSubmit:handleReplySubmit,error:error})})})})})})]})})})]})},reply.id)}function Skeleton(){return(0,jsx_runtime.jsx)("section",{children:(0,jsx_runtime.jsx)("div",{className:"bg-white shadow dark:bg-gray-800 sm:overflow-hidden sm:rounded-sm",children:(0,jsx_runtime.jsx)("div",{className:"px-4 sm:px-6",children:(0,jsx_runtime.jsx)("ul",{className:"animate-pulse divide-y divide-dashed divide-gray-500/30 dark:divide-gray-500/70",children:[0,1,2,3,4].map(i=>(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,jsx_runtime.jsx)("div",{className:"flex-shrink-0 py-4",children:(0,jsx_runtime.jsx)("div",{className:"h-10 w-10 rounded-full bg-gray-300 dark:bg-gray-700"})}),(0,jsx_runtime.jsxs)("div",{className:"flex flex-1 flex-col space-y-1.5 text-sm font-medium",children:[(0,jsx_runtime.jsx)("div",{className:"h-2.5 w-10 rounded-md bg-gray-300 pl-0.5 dark:bg-gray-700"}),(0,jsx_runtime.jsx)("div",{className:"h-2.5 w-5 rounded-md bg-gray-300 pl-0.5 dark:bg-gray-700"})]}),(0,jsx_runtime.jsx)("div",{className:"space-x-1 text-sm font-medium",children:(0,jsx_runtime.jsx)("div",{className:"h-3 w-3 rounded-md bg-gray-300 dark:bg-gray-700"})}),(0,jsx_runtime.jsx)("div",{className:"flex -space-x-1 rounded-md shadow-sm",children:(0,jsx_runtime.jsx)("div",{className:"h-3 w-8 rounded-md bg-gray-300 dark:bg-gray-700"})})]}),(0,jsx_runtime.jsx)("div",{className:"mb-4 h-2 w-60 rounded-md bg-gray-300 dark:bg-gray-700"})]},i))})})})})}let curryFn=(indexOfComment,setComments)=>newComment=>{setComments(prev=>{let newComments=[...prev];return newComments.splice(indexOfComment,1,newComment),newComments})};function use_virtual_reply_refine(item){return{_raw:item,...item,displayCreatedAt:(0,date.no)(item.dateCreated),displayContent:item.text,displayAuthor:{_raw:item.displayAuthor,...item.displayAuthor,displayImage:(0,picture.Z)(item.displayAuthor.pictureType,item.displayAuthor.picture),isWithdrawnUser:item.displayAuthor.withdraw,abbreviatedPoint:(0,dist.abbreviateNumber)(item.displayAuthor.activityPoint,1)},displayVoteCount:(0,dist.abbreviateNumber)(item.voteCount,1),hasChanges:(0,differenceInSeconds.Z)(new Date(item.lastUpdated),new Date(item.dateCreated))>0,isOwner:!1}}let use_virtual_reply_curryComments=(indexOfComment,setComments)=>newComment=>{setComments(prev=>{let newComments=[...prev];return newComments.splice(indexOfComment,1,newComment),newComments})},use_virtual_reply_curryReplies=replies=>newReply=>(replies.splice(-1,1,newReply),replies),virtual_reply_Viewer=dynamic_default()(()=>__webpack_require__.e(2635).then(__webpack_require__.bind(__webpack_require__,22635)),{loadableGenerated:{webpack:()=>[22635]},ssr:!1});function VirtualReply(param){var ref;let{comment,setComments,indexOfComment,reply:replyFromProps,setVirtualReply,onSubmit,onDelete,deleting}=param,{confirm}=(0,browser_context.G)(),{reply,assent,dissent,cancelAssent,cancelDissent,editReply,error}=function(replyFromProps,setVirtualReply,indexOfComment,setComments,comment){let[fetching,setFetching]=(0,react.useState)(!1),[submitting,setSubmitting]=(0,react.useState)(!1),[reply,setReply]=(0,react.useState)(use_virtual_reply_refine(replyFromProps)),{state:{avatar}}=(0,context.k)(),{setError,...error}=useCommentsError(),isOwner=(null==avatar?void 0:avatar.id)===reply.displayAuthor.id,{voteCount,voted}=replyFromProps,setTargetedComment=use_virtual_reply_curryComments(indexOfComment,setComments),getReplacedReplies=use_virtual_reply_curryReplies(comment.children),vote=(0,react.useCallback)(props=>{setTargetedComment({...comment,children:getReplacedReplies({...replyFromProps,...props})})},[comment,replyFromProps,setTargetedComment,getReplacedReplies]),assent=(0,react.useCallback)(async()=>{setFetching(!0);let{ok}=await (0,okky_web.assentComment)(reply.id);return ok?(setVirtualReply({...replyFromProps,voted:1,voteCount:voteCount+(-1===voted?2:1)}),vote({voted:1,voteCount:voteCount+(-1===voted?2:1)}),setFetching(!1),!0):(setFetching(!1),!1)},[reply.id,setVirtualReply,voteCount,voted,replyFromProps,vote]),cancelAssent=(0,react.useCallback)(async()=>{setFetching(!0);let{ok}=await (0,okky_web.cancelAssentForComment)(reply.id);return ok?(setVirtualReply({...replyFromProps,voted:0,voteCount:voteCount-1}),vote({voted:0,voteCount:voteCount-1}),setFetching(!1),!0):(setFetching(!1),!1)},[reply.id,setVirtualReply,voteCount,replyFromProps,vote]),dissent=(0,react.useCallback)(async()=>{setFetching(!0);let{ok}=await (0,okky_web.dissentComment)(reply.id);return ok?(setVirtualReply({...replyFromProps,voted:-1,voteCount:voteCount-(1===voted?2:1)}),vote({voted:-1,voteCount:voteCount-(1===voted?2:1)}),setFetching(!1),!0):(setFetching(!1),!1)},[reply.id,setVirtualReply,voteCount,voted,replyFromProps,vote]),cancelDissent=(0,react.useCallback)(async()=>{setFetching(!0);let{ok}=await (0,okky_web.cancelDissentForComment)(reply.id);return ok?(setVirtualReply({...replyFromProps,voted:0,voteCount:voteCount+1}),vote({voted:0,voteCount:voteCount+1}),setFetching(!1),!0):(setFetching(!1),!1)},[reply.id,setVirtualReply,voteCount,replyFromProps,vote]),editReply=(0,react.useCallback)(async(parentId,replyFormData)=>{setSubmitting(!0);let{ok,result}=await (0,okky_web.updateChildComment)(parentId,reply.id,{body:{targetId:reply.id,note:{text:replyFormData.reply},textType:replyFormData.bodyType,voted:0}});if(!ok||!result)return setError((0,as.as)(result)),setSubmitting(!1),[];{setSubmitting(!1);let{text,lastUpdated}=result,editedReply={...replyFromProps,text,lastUpdated};return setVirtualReply({...replyFromProps,text,lastUpdated}),setTargetedComment({...comment,children:getReplacedReplies({...replyFromProps,text,lastUpdated})}),[editedReply]}},[reply,setVirtualReply,replyFromProps,setError,comment,getReplacedReplies,setTargetedComment]);return(0,react.useEffect)(()=>{setReply(use_virtual_reply_refine(replyFromProps))},[replyFromProps]),{reply:{...reply,isOwner},assent,cancelAssent,dissent,cancelDissent,fetching,editReply,submitting,error}}(replyFromProps,setVirtualReply,indexOfComment,setComments,comment),[isEditMode,setIsEditMode]=(0,react.useState)(!1),[isWritePanelOpen,setIsWritePanelOpen]=(0,react.useState)(!1),isSoftDeleted=replyFromProps.deleted,{ifAuthorizedUserCallback}=(0,use_if_authorized.Z)(),handleAssentClick=(0,react.useCallback)(upVote=>upVote?assent():cancelAssent(),[assent,cancelAssent]),handleDissentClick=(0,react.useCallback)(downVote=>downVote?dissent():cancelDissent(),[dissent,cancelDissent]),handleTrashClick=(0,react.useCallback)(async()=>{let answer=await confirm({title:"댓글 삭제",message:"댓글을 삭제하시겠습니까?"});answer&&(onDelete(reply.id),setVirtualReply(void 0))},[onDelete,reply.id,confirm,setVirtualReply]),handleEditClick=(0,react.useCallback)(()=>{setIsEditMode(!0)},[]),handleReplyEdit=(0,react.useCallback)(async data=>{let[editedReply]=await editReply(reply.id,data);return!!editedReply&&(setIsEditMode(!1),!0)},[editReply,reply.id]),handleReplySubmit=(0,react.useCallback)(async data=>{let result=await onSubmit(reply.id,data);return!!result&&(setIsWritePanelOpen(prev=>!prev),!0)},[onSubmit,reply.id]),handleWriteClick=(0,react.useCallback)(()=>ifAuthorizedUserCallback(()=>setIsWritePanelOpen(prev=>!prev)),[ifAuthorizedUserCallback]),handleEditorCancel=(0,react.useCallback)(()=>{isEditMode?setIsEditMode(!1):setIsWritePanelOpen(!1)},[isEditMode]);return(0,jsx_runtime.jsx)("li",{className:"py-2.5",children:isEditMode?(0,jsx_runtime.jsx)(editor_reply.default,{isEditMode:!0,onCancel:handleEditorCancel,comment:comment,reply:reply,onSubmit:handleReplyEdit,error:error}):(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,jsx_runtime.jsx)("div",{className:"flex-shrink-0",children:reply.displayAuthor.isWithdrawnUser?(0,jsx_runtime.jsx)(image_avatar.Z,{className:"h-10 w-10 rounded-full",src:reply.displayAuthor.displayImage,alt:"프로필 사진"}):(0,jsx_runtime.jsx)(link_default(),{href:"/users/".concat(reply.displayAuthor.id),children:(0,jsx_runtime.jsx)(image_avatar.Z,{className:"h-10 w-10 rounded-full",src:reply.displayAuthor.displayImage,alt:"프로필 사진"})})}),(0,jsx_runtime.jsxs)("div",{className:"flex flex-1 flex-col text-sm font-medium",children:[reply.displayAuthor.isWithdrawnUser?(0,jsx_runtime.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,jsx_runtime.jsx)("span",{className:"w-fit pl-0.5",children:reply.displayAuthor.nickname}),(0,jsx_runtime.jsx)(LockClosedIcon.Z,{className:"h-3 w-3"})]}):(0,jsx_runtime.jsx)(link_default(),{href:"/users/".concat(null===(ref=reply.displayAuthor)||void 0===ref?void 0:ref.id),className:"w-fit pl-0.5 text-gray-900 hover:text-blue-500 dark:text-gray-100 dark:hover:text-blue-200",children:reply.displayAuthor.nickname}),(0,jsx_runtime.jsxs)("div",{className:"flex items-center space-x-1 text-xs font-normal text-gray-700 dark:text-gray-300",children:[(0,jsx_runtime.jsxs)("span",{children:[(0,jsx_runtime.jsx)(bolt.Z,{className:"inline h-3 w-3"}),reply.displayAuthor.abbreviatedPoint]}),(0,jsx_runtime.jsx)("span",{children:"\xb7"}),(0,jsx_runtime.jsxs)("span",{className:"",children:[reply.displayCreatedAt," 전"]}),!isSoftDeleted&&reply.hasChanges&&(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("span",{children:"\xb7"}),(0,jsx_runtime.jsx)(link_default(),{href:"/comments/".concat(reply.id,"/changes"),className:"text-blue-500 hover:text-blue-300 dark:hover:text-blue-200",children:"수정됨"})]})]})]}),!isSoftDeleted&&(0,jsx_runtime.jsxs)("div",{className:"relative flex items-center space-x-7",children:[(0,jsx_runtime.jsx)("div",{className:"flex",children:(0,jsx_runtime.jsx)(CommentVoteMenu,{voted:reply.voted,voteCount:reply.displayVoteCount,onAssent:handleAssentClick,onDissent:handleDissentClick})}),reply.isOwner&&(0,jsx_runtime.jsx)(comment_owner_menu.Z,{trashing:deleting,onTrash:handleTrashClick,onEdit:handleEditClick})]})]}),isSoftDeleted?(0,jsx_runtime.jsx)("div",{className:"mt-1.5 flex-1 break-all rounded-md py-1.5 text-sm leading-relaxed text-gray-500 dark:text-gray-400",children:"해당 댓글은 작성자에 의해 삭제되었습니다."}):(0,jsx_runtime.jsx)("div",{className:"remirror-editor flex-1 break-all text-sm leading-relaxed text-gray-700 dark:text-gray-300",children:(0,jsx_runtime.jsx)(virtual_reply_Viewer,{content:reply.displayContent})}),!isSoftDeleted&&(0,jsx_runtime.jsx)("div",{children:(0,jsx_runtime.jsx)(disclosure.p,{children:()=>(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("div",{className:"flex space-x-4",children:(0,jsx_runtime.jsx)("button",{className:"text-xs font-normal text-gray-500 hover:text-blue-500 hover:no-underline focus:outline-none dark:text-gray-400 dark:hover:text-blue-200",onClick:handleWriteClick,children:isWritePanelOpen?"댓글 취소":"댓글 쓰기"})}),(0,jsx_runtime.jsx)("div",{children:(0,jsx_runtime.jsx)(disclosure.p,{children:(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:isWritePanelOpen&&(0,jsx_runtime.jsx)(disclosure.p.Panel,{static:!0,className:"text-sm",children:(0,jsx_runtime.jsx)("div",{className:"mt-3",children:(0,jsx_runtime.jsx)(editor_reply.default,{onSubmit:handleReplySubmit,onCancel:handleEditorCancel,comment:comment,reply:reply,error:error})})})})})})]})})})]})},reply.id)}let ReplyEditor=dynamic_default()(()=>Promise.resolve().then(__webpack_require__.bind(__webpack_require__,16781)),{loadableGenerated:{webpack:()=>[16781]},ssr:!1});function Replies(param){let{comment,comment:{children:originalReplies,childrenCount:totalRepliesCount,id:commentId,deleted:isCommentDeleted},setComments,indexOfComment}=param,{replies,virtualReply,setVirtualReply,fetching,fetchMoreReplies,hasMoreReplies,hasReplies,leftMoreRepliesCount,postReply,deleteReply,deleting,error}=function(setComments,comment,originalReplies,indexOfComment){let{id:commentId,childrenCount:totalRepliesCount}=comment,[fetching,setFetching]=(0,react.useState)(!1),[deleting,setDeleting]=(0,react.useState)(!1),[virtualReply,setVirtualReply]=(0,react.useState)(),{setError,...error}=useCommentsError(),{state:{avatar}}=(0,context.k)(),[leftMoreRepliesCount,setLeftMoreRepliesCount]=(0,react.useState)(totalRepliesCount-5),hasMoreReplies=leftMoreRepliesCount>0,replies=hasMoreReplies?originalReplies.slice(0,5):originalReplies,setTargetedComment=curryFn(indexOfComment,setComments),fetchMoreReplies=(0,react.useCallback)(()=>{void 0!==virtualReply&&setVirtualReply(void 0),setLeftMoreRepliesCount(0)},[virtualReply]),postReply=(0,react.useCallback)(async(parentId,replyFormData)=>{setFetching(!0),setError(void 0);let{ok,result}=await (0,okky_web.saveChildrenComment)(parentId,{body:{targetId:parentId,note:{text:replyFormData.reply},textType:replyFormData.bodyType,voted:0}});if(!ok||!result)return setFetching(!1),setError((0,as.as)(result)),[void 0,Error("fail message")];{setFetching(!1);let newReply={...result,displayAuthor:avatar};return hasMoreReplies&&(setVirtualReply(newReply),setLeftMoreRepliesCount(prev=>prev+1)),setTargetedComment({...comment,children:[...comment.children,newReply],childrenCount:comment.childrenCount+1}),[newReply,void 0]}},[avatar,comment,hasMoreReplies,setTargetedComment,setError]),deleteReply=(0,react.useCallback)(async replyId=>{setDeleting(!0);let{ok,status}=await (0,okky_web.deleteChildComment)(commentId,replyId);if(ok){setDeleting(!1);let deleteReplyIndex=comment.children.findIndex(reply=>replyId===reply.id),deletedReply=comment.children[deleteReplyIndex];switch(status){case 200:comment.children.splice(deleteReplyIndex,1,{...deletedReply,deleted:!0}),setTargetedComment({...comment,children:comment.children,childrenCount:comment.childrenCount-1});break;case 204:comment.children.splice(deleteReplyIndex,1),setTargetedComment({...comment,children:comment.children,childrenCount:comment.childrenCount-1});break;default:return}}else{setDeleting(!1);return}},[commentId,comment,setTargetedComment]);return{setFetching,fetching,deleting,virtualReply,setVirtualReply,postReply,deleteReply,fetchMoreReplies,error,leftMoreRepliesCount,hasMoreReplies,hasReplies:totalRepliesCount>0,replies}}(setComments,comment,originalReplies,indexOfComment),[isWritePanelOpen,setIsWritePanelOpen]=(0,react.useState)(!1),[isReplyPanelOpen,setIsReplyPanelOpen]=(0,react.useState)(!0),{ifAuthorizedUserCallback}=(0,use_if_authorized.Z)(),handleReplySubmit=(0,react.useCallback)(async(parentId,data)=>{let[result]=await postReply(parentId,data);return!!result&&(setIsWritePanelOpen(!1),setIsReplyPanelOpen(!0),!0)},[postReply]),handleReplyDelete=(0,react.useCallback)(replyId=>{deleteReply(replyId)},[deleteReply]),handleWriteClick=(0,react.useCallback)(()=>ifAuthorizedUserCallback(()=>setIsWritePanelOpen(prev=>!prev)),[ifAuthorizedUserCallback]),handleEditorCancel=(0,react.useCallback)(()=>{setIsWritePanelOpen(!1)},[]);return(0,jsx_runtime.jsx)("div",{children:(0,jsx_runtime.jsx)(disclosure.p,{children:()=>(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsxs)("div",{className:"flex space-x-4",children:[hasReplies&&(0,jsx_runtime.jsxs)(disclosure.p.Button,{onClick(){setIsReplyPanelOpen(prev=>!prev)},className:"flex items-center justify-start gap-x-1 bg-white text-xs font-medium text-blue-500 hover:text-blue-300 hover:no-underline focus:outline-none dark:bg-gray-800",children:[(0,jsx_runtime.jsx)(esm_ChevronUpIcon.Z,{className:(0,concat.z)(isReplyPanelOpen?"":"rotate-180 transform","h-4 w-4")}),(0,jsx_runtime.jsx)("div",{className:"font-medium",children:isReplyPanelOpen?"댓글 모두 숨기기":"댓글 ".concat(totalRepliesCount,"개 보기")})]}),!isCommentDeleted&&(0,jsx_runtime.jsx)("button",{className:"text-xs font-normal text-gray-500 hover:text-blue-500 hover:no-underline focus:outline-none dark:text-gray-400 dark:hover:text-blue-200",onClick:handleWriteClick,children:isWritePanelOpen?"댓글 취소":"댓글 쓰기"})]}),(0,jsx_runtime.jsxs)("div",{className:"ml-2.5 border-l-2 pl-4",children:[(0,jsx_runtime.jsx)(disclosure.p,{children:(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:isWritePanelOpen&&(0,jsx_runtime.jsx)(disclosure.p.Panel,{static:!0,className:"mt-5 text-sm",children:(0,jsx_runtime.jsx)(ReplyEditor,{comment:comment,onCancel:handleEditorCancel,onSubmit:data=>handleReplySubmit(commentId,data),error:error})})})}),isReplyPanelOpen&&(0,jsx_runtime.jsxs)(disclosure.p.Panel,{as:"section",static:!0,className:"mt-5 text-sm",children:[(0,jsx_runtime.jsxs)("ul",{className:"divide-y divide-dashed divide-gray-500/30 dark:divide-gray-500/70",children:[replies.map((reply,index)=>(0,jsx_runtime.jsx)(Reply,{reply:reply,indexOfReply:index,comment:comment,indexOfComment:indexOfComment,setComments:setComments,onSubmit:handleReplySubmit,deleting:deleting,onDelete:handleReplyDelete},reply.id)),virtualReply&&(0,jsx_runtime.jsx)(VirtualReply,{reply:virtualReply,setVirtualReply:setVirtualReply,onSubmit:handleReplySubmit,deleting:deleting,onDelete:handleReplyDelete,comment:comment,setComments:setComments,indexOfComment:indexOfComment})]}),fetching&&(0,jsx_runtime.jsx)(Skeleton,{}),hasMoreReplies&&isReplyPanelOpen&&(0,jsx_runtime.jsxs)("div",{className:"mt-3 flex cursor-pointer gap-x-1 text-blue-500 hover:text-blue-300 hover:no-underline dark:hover:text-blue-200",children:[(0,jsx_runtime.jsx)(esm_ChevronUpIcon.Z,{className:"h-4 w-4 rotate-180"}),(0,jsx_runtime.jsx)("button",{onClick:fetchMoreReplies,className:"text-xs font-normal",children:"댓글 ".concat(leftMoreRepliesCount,"개 더보기")})]})]})]})]})})})}var router=__webpack_require__(11163);function use_comment_refine(item){return{_raw:item,...item,displayCreatedAt:(0,date.no)(item.dateCreated),displayContent:(0,regex_link.q)(item.text),displayAuthor:{_raw:item.displayAuthor,...item.displayAuthor,displayImage:(0,picture.Z)(item.displayAuthor.pictureType,item.displayAuthor.picture,96),isWithdrawnUser:item.displayAuthor.withdraw,abbreviatedPoint:(0,dist.abbreviateNumber)(item.displayAuthor.activityPoint,1)},displayVoteCount:(0,dist.abbreviateNumber)(item.voteCount,1),hasChanges:(0,differenceInSeconds.Z)(new Date(item.lastUpdated),new Date(item.dateCreated))>0,isOwner:!1,permanentUrlId:"note-".concat(item.id)}}let use_comment_curryFn=(indexOfComment,setComments)=>newComment=>{setComments(prev=>{let newComments=[...prev];return newComments.splice(indexOfComment,1,newComment),newComments})},CommentEditor=dynamic_default()(()=>__webpack_require__.e(5510).then(__webpack_require__.bind(__webpack_require__,25510)),{loadableGenerated:{webpack:()=>[25510]},ssr:!1}),comment_Viewer=dynamic_default()(()=>__webpack_require__.e(2635).then(__webpack_require__.bind(__webpack_require__,22635)),{loadableGenerated:{webpack:()=>[22635]},ssr:!1});function Comment(param){var ref;let{indexOfComment,comment:commentFromProps,setComments,onDelete,deleting}=param,[isEditMode,setIsEditMode]=(0,react.useState)(!1),{error,comment,assent,cancelAssent,dissent,cancelDissent,editComment}=function(commentFromProps,setComments,indexOfComment){let{query}=(0,router.useRouter)(),{id:articleId}=(0,as.N)(query),[submitting,setSubmitting]=(0,react.useState)(!1),[fetching,setFetching]=(0,react.useState)(!1),{setError,...error}=useCommentsError(),[comment,setComment]=(0,react.useState)(use_comment_refine(commentFromProps)),{state:{avatar}}=(0,context.k)(),isOwner=(null==avatar?void 0:avatar.id)===comment.displayAuthor.id,{voteCount,voted}=commentFromProps,setTargetedComment=use_comment_curryFn(indexOfComment,setComments),vote=(0,react.useCallback)(props=>{setTargetedComment({...commentFromProps,...props})},[setTargetedComment,commentFromProps]),assent=(0,react.useCallback)(async()=>{setFetching(!0);let{ok}=await (0,okky_web.assentComment)(comment.id);return ok?(vote({voted:1,voteCount:voteCount+(-1===voted?2:1)}),setFetching(!1),!0):(setFetching(!1),!1)},[comment.id,vote,voteCount,voted]),cancelAssent=(0,react.useCallback)(async()=>{setFetching(!0);let{ok}=await (0,okky_web.cancelAssentForComment)(comment.id);return ok?(vote({voted:0,voteCount:voteCount-1}),setFetching(!1),!0):(setFetching(!1),!1)},[comment.id,vote,voteCount]),dissent=(0,react.useCallback)(async()=>{setFetching(!0);let{ok}=await (0,okky_web.dissentComment)(comment.id);return ok?(vote({voted:-1,voteCount:voteCount-(1===voted?2:1)}),setFetching(!1),!0):(setFetching(!1),!1)},[comment.id,voted,vote,voteCount]),cancelDissent=(0,react.useCallback)(async()=>{setFetching(!0);let{ok}=await (0,okky_web.cancelDissentForComment)(comment.id);return ok?(vote({voted:0,voteCount:voteCount+1}),setFetching(!1),!0):(setFetching(!1),!1)},[comment.id,vote,voteCount]),editComment=(0,react.useCallback)(async commentFormData=>{setSubmitting(!0);let{ok,result}=await (0,okky_web.updateComment)(comment.id,{body:{targetId:articleId,note:{text:commentFormData.comment},textType:commentFormData.bodyType,voted:comment.voted}});if(!ok||!result)return setError((0,as.as)(result)),setSubmitting(!1),[];{let{text,lastUpdated}=result;return setSubmitting(!1),setTargetedComment({...commentFromProps,text,lastUpdated}),[comment]}},[comment,articleId,setError,setTargetedComment,commentFromProps]);return(0,react.useEffect)(()=>{setComment(use_comment_refine(commentFromProps))},[commentFromProps]),{error,fetching,submitting,comment:{...comment,isOwner},assent,dissent,cancelAssent,cancelDissent,editComment}}(commentFromProps,setComments,indexOfComment),{confirm}=(0,browser_context.G)(),isSoftDeleted=commentFromProps.deleted,handleAssentClick=(0,react.useCallback)(upVote=>upVote?assent():cancelAssent(),[assent,cancelAssent]),handleDissentClick=(0,react.useCallback)(downVote=>downVote?dissent():cancelDissent(),[dissent,cancelDissent]),handleEditClick=(0,react.useCallback)(()=>{setIsEditMode(!0)},[]),handleTrashClick=(0,react.useCallback)(async()=>{let answer=await confirm({title:"댓글 삭제",message:"댓글을 삭제하시겠습니까?"});answer&&onDelete(comment.id)},[onDelete,comment.id,confirm]),handleCommentSubmit=(0,react.useCallback)(async data=>{let[comment]=await editComment(data);return!!comment&&(setIsEditMode(!1),!0)},[editComment]),handleEditorCancel=(0,react.useCallback)(()=>{setIsEditMode(!1)},[]);return(0,jsx_runtime.jsx)("li",{id:comment.permanentUrlId,className:"py-6",children:isEditMode?(0,jsx_runtime.jsx)(CommentEditor,{comment:comment,onSubmit:handleCommentSubmit,error:error,onCancel:handleEditorCancel}):(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,jsx_runtime.jsx)("div",{className:"flex-shrink-0",children:comment.displayAuthor.isWithdrawnUser?(0,jsx_runtime.jsx)(image_avatar.Z,{className:"h-8 w-8 rounded-full sm:h-12 sm:w-12",src:comment.displayAuthor.displayImage,alt:"프로필 사진"}):(0,jsx_runtime.jsx)(link_default(),{href:"/users/".concat(comment.displayAuthor.id),children:(0,jsx_runtime.jsx)(image_avatar.Z,{className:"h-8 w-8 rounded-full sm:h-12 sm:w-12",src:comment.displayAuthor.displayImage,alt:"프로필 사진"})})}),(0,jsx_runtime.jsxs)("div",{className:"flex flex-1 flex-col text-sm font-medium",children:[comment.displayAuthor.isWithdrawnUser?(0,jsx_runtime.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,jsx_runtime.jsx)("span",{className:"w-fit pl-0.5",children:comment.displayAuthor.nickname}),(0,jsx_runtime.jsx)(LockClosedIcon.Z,{className:"h-3 w-3"})]}):(0,jsx_runtime.jsx)(link_default(),{href:"/users/".concat(null===(ref=comment.displayAuthor)||void 0===ref?void 0:ref.id),className:"w-fit pl-0.5 text-gray-900 hover:text-blue-500 dark:text-gray-100 dark:hover:text-blue-200",children:comment.displayAuthor.nickname}),(0,jsx_runtime.jsxs)("div",{className:"flex items-center space-x-1 text-xs font-normal text-gray-700 dark:text-gray-300",children:[(0,jsx_runtime.jsxs)("span",{children:[(0,jsx_runtime.jsx)(bolt.Z,{className:"inline h-3 w-3"}),comment.displayAuthor.abbreviatedPoint]}),(0,jsx_runtime.jsx)("span",{children:"\xb7"}),(0,jsx_runtime.jsxs)(link_default(),{href:"#".concat(comment.permanentUrlId),className:"text-gray-700 hover:text-blue-500 dark:text-gray-300 dark:hover:text-blue-200",children:[comment.displayCreatedAt,"전"]}),!isSoftDeleted&&comment.hasChanges&&(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("span",{children:"\xb7"}),(0,jsx_runtime.jsx)(link_default(),{href:"/comments/".concat(comment.id,"/changes"),className:"text-blue-500 hover:text-blue-300 dark:hover:text-blue-200",children:"수정됨"})]})]})]}),!isSoftDeleted&&(0,jsx_runtime.jsxs)("div",{className:"relative flex items-center space-x-3 sm:space-x-7",children:[(0,jsx_runtime.jsx)("div",{className:"flex",children:(0,jsx_runtime.jsx)(CommentVoteMenu,{voted:comment.voted,voteCount:comment.displayVoteCount,onAssent:handleAssentClick,onDissent:handleDissentClick})}),comment.isOwner&&(0,jsx_runtime.jsx)(comment_owner_menu.Z,{onEdit:handleEditClick,onTrash:handleTrashClick,trashing:deleting})]})]}),(0,jsx_runtime.jsx)("div",{className:"flex",children:isSoftDeleted?(0,jsx_runtime.jsx)("div",{className:"my-1.5 flex-1 break-all rounded-md py-1.5 text-sm leading-relaxed text-gray-500 dark:text-gray-400",children:"해당 댓글은 작성자에 의해 삭제되었습니다."}):(0,jsx_runtime.jsx)("div",{className:"remirror-editor mb-2 flex-1 break-all text-sm leading-relaxed text-gray-700 dark:text-gray-300",children:(0,jsx_runtime.jsx)(comment_Viewer,{content:comment.displayContent})})}),(0,jsx_runtime.jsx)(Replies,{comment:commentFromProps,setComments:setComments,indexOfComment:indexOfComment})]})},comment.id)}var article_context=__webpack_require__(39266),use_jump_scroll=__webpack_require__(64621);let comments_CommentEditor=dynamic_default()(()=>__webpack_require__.e(5510).then(__webpack_require__.bind(__webpack_require__,25510)),{loadableGenerated:{webpack:()=>[25510]},ssr:!1});function Comments(){let{error,comments,setComments,commentCount,removeComment,deleting,hasComments,postComment}=function(){let{query}=(0,router.useRouter)(),{id:articleId}=(0,as.N)(query),{state:{avatar}}=(0,context.k)(),[fetching,setFetching]=(0,react.useState)(!1),[deleting,setDeleting]=(0,react.useState)(!1),{setError,...error}=useCommentsError(),[comments,setComments]=(0,react.useState)([]),hasComments=comments.length>0,{state:{article}}=(0,article_context.W4)(),[commentCount,setCommentCount]=(0,react.useState)(article.noteCount),postComment=(0,react.useCallback)(async commentFormData=>{setFetching(!0),setError(void 0);let{ok,result}=await (0,okky_web.saveComment)({body:{targetId:articleId,note:{text:commentFormData.comment},textType:commentFormData.bodyType,voted:0}});if(!ok||!result)return setFetching(!1),setError((0,as.as)(result)),[void 0,Error("fail message")];{let newComment={...result,children:[],displayAuthor:avatar};return setComments(prev=>[...prev,newComment]),setCommentCount(prev=>prev+1),setFetching(!1),[newComment,void 0]}},[articleId,avatar,setError]),removeComment=(0,react.useCallback)(async id=>{setDeleting(!0);let{ok,status}=await (0,okky_web.deleteComment)(id);if(ok)switch(setDeleting(!1),status){case 200:setComments(prev=>prev.map(comment=>id===comment.id?{...comment,deleted:!0}:comment)),setCommentCount(prev=>prev-1);break;case 204:setComments(prev=>prev.filter(comment=>id!==comment.id)),setCommentCount(prev=>prev-1);break;default:return}else{setDeleting(!1);return}},[]);return(0,react.useEffect)(()=>{(async function(){let{result}=await (0,okky_web.getAllCommentList)({articleId});setComments((result||[]).reduce((accu,item)=>{let grandparentIndex=accu.findIndex(comment=>comment.id===item.grandparentId);if(grandparentIndex>=0){let grandparentComment=accu[grandparentIndex];return grandparentComment.children.push(item),accu.splice(grandparentIndex,1,grandparentComment),accu}{let newComment={...item,children:[]};return accu.push(newComment),accu}},[])),setCommentCount(article.noteCount)})()},[articleId,article.noteCount]),{error,fetching,deleting,comments,setComments,commentCount,hasComments,postComment,removeComment}}();(0,use_jump_scroll.Z)();let handleCommentSubmit=(0,react.useCallback)(async data=>{let[result]=await postComment(data);return!!result},[postComment]);return(0,jsx_runtime.jsxs)("section",{"aria-labelledby":"notes-title",children:[!hasComments&&(0,jsx_runtime.jsx)(comments_CommentEditor,{onSubmit:handleCommentSubmit,error:error}),(0,jsx_runtime.jsx)("div",{className:"my-5 border-t border-gray-500/30 dark:border-gray-500/70"}),hasComments&&(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("div",{className:"mb-6 sm:mb-8",children:(0,jsx_runtime.jsxs)("h2",{id:"notes-title",children:[commentCount,"개의 댓글"]})}),(0,jsx_runtime.jsx)("div",{className:"my-4 rounded-lg border border-gray-500/30 p-4 dark:border-gray-500/70 sm:my-10 sm:p-6",children:(0,jsx_runtime.jsx)(comments_CommentEditor,{onSubmit:handleCommentSubmit,error:error})}),(0,jsx_runtime.jsx)("div",{className:"my-8",children:(0,jsx_runtime.jsx)("ul",{className:"divide-y divide-gray-500/30 dark:divide-gray-500/70",children:comments.map((comment,index)=>(0,jsx_runtime.jsx)(Comment,{indexOfComment:index,comment:comment,setComments:setComments,onDelete:removeComment,deleting:deleting},comment.id))})})]})]})}},43707:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{Iy:function(){return InfoAlert},SU:function(){return GrayAlert},WY:function(){return WarningAlert},hW:function(){return ErrorAlert}});var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(52322),_heroicons_react_24_solid__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(21318),_heroicons_react_24_solid__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(8676);function ErrorAlert(param){let{title,children}=param;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"rounded-md border border-red-100 bg-blue-50 p-4 dark:border-red-700 dark:bg-red-700/50",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"flex",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"flex-shrink-0",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_heroicons_react_24_solid__WEBPACK_IMPORTED_MODULE_1__.Z,{className:"h-5 w-5 text-red-800 dark:text-red-200","aria-hidden":"true"})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"ml-3",children:[title&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("h3",{className:"text-sm font-medium text-red-800 dark:text-red-200",children:title}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"mt-2 text-sm text-red-700 dark:text-red-200",children:children})]})]})})}function WarningAlert(param){let{title,children}=param;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"rounded-md border border-yellow-100 bg-blue-50 p-4 dark:border-yellow-700 dark:bg-yellow-700/50",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"flex",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"flex-shrink-0",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_heroicons_react_24_solid__WEBPACK_IMPORTED_MODULE_1__.Z,{className:"h-5 w-5 text-yellow-800 dark:text-yellow-200","aria-hidden":"true"})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"ml-3",children:[title&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("h3",{className:"text-sm font-bold text-yellow-800 dark:text-yellow-200",children:title}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"mt-2 text-sm text-yellow-700 dark:text-yellow-200",children:children})]})]})})}function InfoAlert(param){let{title,children}=param;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"rounded-md border border-blue-100 bg-blue-50 p-4 dark:border-blue-700 dark:bg-blue-700/50",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"flex",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"flex-shrink-0",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_heroicons_react_24_solid__WEBPACK_IMPORTED_MODULE_2__.Z,{className:"h-5 w-5 text-blue-500","aria-hidden":"true"})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"ml-3",children:[title&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("h3",{className:"text-sm font-bold text-blue-800 dark:text-blue-200",children:title}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"mt-2 text-sm text-blue-700 dark:text-blue-200",children:children})]})]})})}function GrayAlert(param){let{title,children}=param;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"rounded-md border border-gray-100 bg-gray-50 p-4 dark:border-gray-700 dark:bg-gray-700/50",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"flex",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"flex-shrink-0",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_heroicons_react_24_solid__WEBPACK_IMPORTED_MODULE_2__.Z,{className:"h-5 w-5 text-blue-500","aria-hidden":"true"})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"ml-3",children:[title&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("h3",{className:"text-sm font-medium text-gray-800 dark:text-gray-200",children:title}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"mt-2",children:children})]})]})})}},36046:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{Z:function(){return SubmitButton}});var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(52322),_spinner__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(73947);function SubmitButton(param){let{loadingText="Processing...",children,loading=!1,disabled=!1,onClick}=param;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("button",{type:"button",className:"inline-flex items-center space-x-2 rounded-md bg-blue-500 px-8 py-2 text-sm font-semibold leading-6 text-white shadow-sm hover:bg-blue-600 disabled:bg-blue-500 disabled:opacity-40",disabled:loading||disabled,onClick:onClick,children:loading?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_spinner__WEBPACK_IMPORTED_MODULE_1__.Z,{}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("span",{children:loadingText})]}):children})}},94746:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{Z:function(){return useOKKYCommentMessage}});var _libs_number_rand__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(78720);let PLACEHOLDERS_FOR_COMMENT=["대화를 재미있게 이끌어가는 생각이 있으신가요?","커뮤니티를 성장시키는 의견을 공유해주세요.","생각의 차이를 인정하고 공감을 나눠주세요.","의견은 누구나 편안하게 남겨주세요.","우리 환영하는 분위기를 독려해요.","때로는 과감한 의견과 건설적인 비판을 수용해요.","서로 다른 경험과 관점을 존중해요."];function useOKKYCommentMessage(){return PLACEHOLDERS_FOR_COMMENT[(0,_libs_number_rand__WEBPACK_IMPORTED_MODULE_0__.Z)(0,PLACEHOLDERS_FOR_COMMENT.length-1)]}},11802:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{$:function(){return clearZeroSpace}});function clearZeroSpace(str){return str.replace(/[\u200B-\u200D\uFEFF]/g,"")}}}]);