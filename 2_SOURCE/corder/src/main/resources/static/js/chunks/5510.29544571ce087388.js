"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5510],{25510:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:function(){return CommentEditor}});var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(52322),_heroicons_react_24_outline__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(17745),_hookform_resolvers_yup__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(96240),_remirror_react__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(16263),_remirror_react__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(46376),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(2784),react_hook_form__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(32439),remirror__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(85775),yup__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(24511),_libs_string_clear_zero_space__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(11802),_components_shared_alert__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(43707),_components_shared_editor_floating_link_toolbar__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(2236),_components_shared_image_avatar__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(89746),_remirror__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(875),_toolbar__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(75081),_without_email_verified__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(74812),_without_session__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(65620),_auth_context__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(11712),_shared_submit_button__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(36046);let schema=yup__WEBPACK_IMPORTED_MODULE_2__.Ry().shape({comment:yup__WEBPACK_IMPORTED_MODULE_2__.Z_().min(1,"내용을 최소 1자 이상 입력해주세요.").max(204800,"내용은 최대 204,800자까지 입력할 수 있습니다.").transform((_,val)=>(0,_libs_string_clear_zero_space__WEBPACK_IMPORTED_MODULE_12__.$)(val)).required("내용을 입력해주세요.")}).required();function CommentEditor(param){var ref;let{onSubmit,comment={},error,onCancel}=param,{state:{needToEmailVerify,needToLogin,displayImage}}=(0,_auth_context__WEBPACK_IMPORTED_MODULE_10__.k)(),[submitting,setSubmitting]=(0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(!1),[bodyType]=(0,react__WEBPACK_IMPORTED_MODULE_1__.useState)("HTML"),{reset,setValue,handleSubmit,formState:{errors,isDirty}}=(0,react_hook_form__WEBPACK_IMPORTED_MODULE_13__.cI)({resolver:(0,_hookform_resolvers_yup__WEBPACK_IMPORTED_MODULE_14__.X)(schema),defaultValues:{comment:comment.displayContent}}),{manager,state,getContext}=(0,_remirror_react__WEBPACK_IMPORTED_MODULE_15__.iF)({extensions:_remirror__WEBPACK_IMPORTED_MODULE_6__.R,content:comment.displayContent,selection:"start",stringHandler:"html"}),handleCommentSubmit=handleSubmit(async param=>{let{comment}=param;setSubmitting(!0);let result=await onSubmit({bodyType,comment});if(result){var ref;reset(),null===(ref=getContext())||void 0===ref||ref.clearContent()}setSubmitting(!1)}),handleDocChange=(0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(state=>{let comment=state.doc.content.size>2?(0,remirror__WEBPACK_IMPORTED_MODULE_16__.Em)(state.doc):"";setValue("comment",comment,{shouldDirty:!0})},[setValue]);return needToLogin?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_without_session__WEBPACK_IMPORTED_MODULE_9__.Z,{}):needToEmailVerify?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_without_email_verified__WEBPACK_IMPORTED_MODULE_8__.Z,{}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"flex gap-x-2 sm:gap-x-4",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"shrink-0",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components_shared_image_avatar__WEBPACK_IMPORTED_MODULE_5__.Z,{src:displayImage,className:"h-6 w-6 rounded-full sm:h-10 sm:w-10",alt:"프로필 사진"})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"min-w-0 flex-1",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("form",{onSubmit:e=>e.preventDefault(),children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"remirror-theme rounded-md border border-gray-500/30 shadow-sm dark:border-gray-500/70",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("label",{htmlFor:"comment",className:"sr-only",children:"editor"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(_remirror_react__WEBPACK_IMPORTED_MODULE_15__.O1,{classNames:["remirror-comment"],manager:manager,onChange(parameter){handleDocChange(parameter.state)},hooks:[()=>{let handleSubmitShortcut=(0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(()=>(isDirty&&handleCommentSubmit(),!0),[isDirty]);(0,_remirror_react__WEBPACK_IMPORTED_MODULE_17__.og)("Mod-Enter",handleSubmitShortcut)}],initialContent:state,children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_toolbar__WEBPACK_IMPORTED_MODULE_7__.Z,{}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_remirror__WEBPACK_IMPORTED_MODULE_6__.H,{}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components_shared_editor_floating_link_toolbar__WEBPACK_IMPORTED_MODULE_4__.Z,{})]})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"mt-3 flex items-center justify-end gap-x-4",children:[void 0!==onCancel&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("button",{type:"button",className:"rounded-md border border-gray-500/30 bg-white px-4 py-2 text-sm font-medium leading-5 shadow-sm hover:bg-gray-100 focus:outline-none dark:border-gray-500/70 dark:bg-gray-700 dark:hover:bg-gray-600",onClick:onCancel,children:"취소"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_shared_submit_button__WEBPACK_IMPORTED_MODULE_11__.Z,{loading:submitting,loadingText:"저장중...",disabled:!isDirty,onClick:handleCommentSubmit,children:"댓글 쓰기"}),errors.comment&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("p",{className:"group mt-1 inline-flex items-start space-x-2 text-sm",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_heroicons_react_24_outline__WEBPACK_IMPORTED_MODULE_18__.Z,{className:"h-5 w-5 flex-shrink-0 text-red-500","aria-hidden":"true"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("span",{className:"text-red-500",children:null===(ref=errors.comment)||void 0===ref?void 0:ref.message})]})]}),error.has&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"my-4",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components_shared_alert__WEBPACK_IMPORTED_MODULE_3__.WY,{title:"댓글 작성실패",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{dangerouslySetInnerHTML:{__html:error.message}})})})]})})]})}}}]);