"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5775],{9436:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{By:function(){return __INTERNAL_REMIRROR_IDENTIFIER_KEY__},Eg:function(){return SELECTED_NODE_CLASS_NAME},RC:function(){return ManagerPhase},Vp:function(){return NULL_CHARACTER},Z9:function(){return LEAF_NODE_REPLACING_CHARACTER},eX:function(){return ExtensionTag},lk:function(){return RemirrorIdentifier},mA:function(){return ErrorConstant},vO:function(){return NamedShortcut},xV:function(){return ExtensionPriority},zr:function(){return STATE_OVERRIDE}});var RemirrorIdentifier2,ExtensionPriority2,ManagerPhase2,NamedShortcut2,ErrorConstant2,SELECTED_NODE_CLASS_NAME="ProseMirror-selectednode",LEAF_NODE_REPLACING_CHARACTER="￼",NULL_CHARACTER="\0",STATE_OVERRIDE="__state_override__",ExtensionTag={LastNodeCompatible:"lastNodeCompatible",FormattingMark:"formattingMark",FormattingNode:"formattingNode",NodeCursor:"nodeCursor",FontStyle:"fontStyle",Link:"link",Color:"color",Alignment:"alignment",Indentation:"indentation",Behavior:"behavior",Code:"code",InlineNode:"inline",ListContainerNode:"listContainer",ListItemNode:"listItemNode",Block:"block",BlockNode:"block",TextBlock:"textBlock",ExcludeInputRules:"excludeFromInputRules",PreventExits:"preventsExits",Media:"media"},__INTERNAL_REMIRROR_IDENTIFIER_KEY__=Symbol.for("__remirror__"),RemirrorIdentifier=((RemirrorIdentifier2=RemirrorIdentifier||{}).PlainExtension="RemirrorPlainExtension",RemirrorIdentifier2.NodeExtension="RemirrorNodeExtension",RemirrorIdentifier2.MarkExtension="RemirrorMarkExtension",RemirrorIdentifier2.PlainExtensionConstructor="RemirrorPlainExtensionConstructor",RemirrorIdentifier2.NodeExtensionConstructor="RemirrorNodeExtensionConstructor",RemirrorIdentifier2.MarkExtensionConstructor="RemirrorMarkExtensionConstructor",RemirrorIdentifier2.Manager="RemirrorManager",RemirrorIdentifier2.Preset="RemirrorPreset",RemirrorIdentifier2.PresetConstructor="RemirrorPresetConstructor",RemirrorIdentifier2),ExtensionPriority=((ExtensionPriority2=ExtensionPriority||{})[ExtensionPriority2.Critical=1e6]="Critical",ExtensionPriority2[ExtensionPriority2.Highest=1e5]="Highest",ExtensionPriority2[ExtensionPriority2.High=1e4]="High",ExtensionPriority2[ExtensionPriority2.Medium=1e3]="Medium",ExtensionPriority2[ExtensionPriority2.Default=100]="Default",ExtensionPriority2[ExtensionPriority2.Low=10]="Low",ExtensionPriority2[ExtensionPriority2.Lowest=0]="Lowest",ExtensionPriority2),ManagerPhase=((ManagerPhase2=ManagerPhase||{})[ManagerPhase2.None=0]="None",ManagerPhase2[ManagerPhase2.Create=1]="Create",ManagerPhase2[ManagerPhase2.EditorView=2]="EditorView",ManagerPhase2[ManagerPhase2.Runtime=3]="Runtime",ManagerPhase2[ManagerPhase2.Destroy=4]="Destroy",ManagerPhase2),NamedShortcut=((NamedShortcut2=NamedShortcut||{}).Undo="_|undo|_",NamedShortcut2.Redo="_|redo|_",NamedShortcut2.Bold="_|bold|_",NamedShortcut2.Italic="_|italic|_",NamedShortcut2.Underline="_|underline|_",NamedShortcut2.Strike="_|strike|_",NamedShortcut2.Code="_|code|_",NamedShortcut2.Paragraph="_|paragraph|_",NamedShortcut2.H1="_|h1|_",NamedShortcut2.H2="_|h2|_",NamedShortcut2.H3="_|h3|_",NamedShortcut2.H4="_|h4|_",NamedShortcut2.H5="_|h5|_",NamedShortcut2.H6="_|h6|_",NamedShortcut2.TaskList="_|task|_",NamedShortcut2.BulletList="_|bullet|_",NamedShortcut2.OrderedList="_|number|_",NamedShortcut2.Quote="_|quote|_",NamedShortcut2.Divider="_|divider|_",NamedShortcut2.Codeblock="_|codeblock|_",NamedShortcut2.ClearFormatting="_|clear|_",NamedShortcut2.Superscript="_|sup|_",NamedShortcut2.Subscript="_|sub|_",NamedShortcut2.LeftAlignment="_|left-align|_",NamedShortcut2.CenterAlignment="_|center-align|_",NamedShortcut2.RightAlignment="_|right-align|_",NamedShortcut2.JustifyAlignment="_|justify-align|_",NamedShortcut2.InsertLink="_|link|_",NamedShortcut2.Find="_|find|_",NamedShortcut2.FindBackwards="_|find-backwards|_",NamedShortcut2.FindReplace="_|find-replace|_",NamedShortcut2.AddFootnote="_|footnote|_",NamedShortcut2.AddComment="_|comment|_",NamedShortcut2.ContextMenu="_|context-menu|_",NamedShortcut2.IncreaseFontSize="_|inc-font-size|_",NamedShortcut2.DecreaseFontSize="_|dec-font-size|_",NamedShortcut2.IncreaseIndent="_|indent|_",NamedShortcut2.DecreaseIndent="_|dedent|_",NamedShortcut2.Shortcuts="_|shortcuts|_",NamedShortcut2.Copy="_|copy|_",NamedShortcut2.Cut="_|cut|_",NamedShortcut2.Paste="_|paste|_",NamedShortcut2.PastePlain="_|paste-plain|_",NamedShortcut2.SelectAll="_|select-all|_",NamedShortcut2.Format="_|format|_",NamedShortcut2),ErrorConstant=((ErrorConstant2=ErrorConstant||{}).PROD="RMR0000",ErrorConstant2.UNKNOWN="RMR0001",ErrorConstant2.INVALID_COMMAND_ARGUMENTS="RMR0002",ErrorConstant2.CUSTOM="RMR0003",ErrorConstant2.CORE_HELPERS="RMR0004",ErrorConstant2.MUTATION="RMR0005",ErrorConstant2.INTERNAL="RMR0006",ErrorConstant2.MISSING_REQUIRED_EXTENSION="RMR0007",ErrorConstant2.MANAGER_PHASE_ERROR="RMR0008",ErrorConstant2.INVALID_GET_EXTENSION="RMR0010",ErrorConstant2.INVALID_MANAGER_ARGUMENTS="RMR0011",ErrorConstant2.SCHEMA="RMR0012",ErrorConstant2.HELPERS_CALLED_IN_OUTER_SCOPE="RMR0013",ErrorConstant2.INVALID_MANAGER_EXTENSION="RMR0014",ErrorConstant2.DUPLICATE_COMMAND_NAMES="RMR0016",ErrorConstant2.DUPLICATE_HELPER_NAMES="RMR0017",ErrorConstant2.NON_CHAINABLE_COMMAND="RMR0018",ErrorConstant2.INVALID_EXTENSION="RMR0019",ErrorConstant2.INVALID_CONTENT="RMR0021",ErrorConstant2.INVALID_NAME="RMR0050",ErrorConstant2.EXTENSION="RMR0100",ErrorConstant2.EXTENSION_SPEC="RMR0101",ErrorConstant2.EXTENSION_EXTRA_ATTRIBUTES="RMR0102",ErrorConstant2.INVALID_SET_EXTENSION_OPTIONS="RMR0103",ErrorConstant2.REACT_PROVIDER_CONTEXT="RMR0200",ErrorConstant2.REACT_GET_ROOT_PROPS="RMR0201",ErrorConstant2.REACT_EDITOR_VIEW="RMR0202",ErrorConstant2.REACT_CONTROLLED="RMR0203",ErrorConstant2.REACT_NODE_VIEW="RMR0204",ErrorConstant2.REACT_GET_CONTEXT="RMR0205",ErrorConstant2.REACT_COMPONENTS="RMR0206",ErrorConstant2.REACT_HOOKS="RMR0207",ErrorConstant2.I18N_CONTEXT="RMR0300",ErrorConstant2)},62120:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{RF:function(){return Cast},hu:function(){return assert},fp:function(){return assertGet},kC:function(){return capitalize},uZ:function(){return clamp},cx:function(){return remirror_core_helpers_cx},RH:function(){return deepMerge},bH:function(){return defaultImport},qh:function(){return entries},JD:function(){return findMatches},VF:function(){return function flattenArray(array){let flattened=[];for(let item of array){let itemsToInsert=isArray(item)?flattenArray(item):[item];flattened.push(...itemsToInsert)}return flattened}},vV:function(){return freeze},r2:function(){return getLazyArray},q9:function(){return includes},kG:function(){return invariant},kJ:function(){return isArray},jn:function(){return isBoolean},yD:function(){return isEmptyArray},Qr:function(){return isEmptyObject},Xy:function(){return isEqual},mf:function(){return isFunction},V9:function(){return isInstanceOf},Of:function(){return isNonEmptyArray},le:function(){return isNullOrUndefined},hj:function(){return isNumber},Kn:function(){return isObject},PO:function(){return isPlainObject},Kj:function(){return isRegExp},HD:function(){return isString},o8:function(){return isUndefined},XP:function(){return keys},Z$:function(){return last},ZT:function(){return noop},Ry:function(){return object},Yc:function(){return omitUndefined},w6:function(){return range},DY:function(){return sort},qn:function(){return take},BB:function(){return remirror_core_helpers_toString},Nb:function(){return uniqueArray},uw:function(){return uniqueBy},EL:function(){return uniqueId},zN:function(){return unset},VO:function(){return values},uh:function(){return within}});var make_error=__webpack_require__(85598),remirror_core_constants=__webpack_require__(9436),esm_cx=function(){let result=Array.prototype.slice.call(arguments).filter(Boolean).join(" ");return result},cjs=__webpack_require__(39714),cjs_default=__webpack_require__.n(cjs),fast_deep_equal=__webpack_require__(69378),fast_deep_equal_default=__webpack_require__.n(fast_deep_equal),object_omit=__webpack_require__(13e3),object_omit_default=__webpack_require__.n(object_omit);__webpack_require__(86883);var __defProp=Object.defineProperty,__defNormalProp=(obj,key,value)=>key in obj?__defProp(obj,key,{enumerable:!0,configurable:!0,writable:!0,value}):obj[key]=value,__publicField=(obj,key,value)=>(__defNormalProp(obj,"symbol"!=typeof key?key+"":key,value),value);function Cast(value){return value}function assertGet(value,key,message){let prop=value[key];return assert(!isUndefined(prop),message),prop}function assert(testValue,message){if(!testValue)throw new AssertionError(message)}var AssertionError=class extends make_error.BaseError{constructor(){super(...arguments),__publicField(this,"name","AssertionError")}};function entries(value){return Object.entries(value)}function keys(value){return Object.keys(value)}function values(value){return Object.values(value)}function includes(array,item,fromIndex){return array.includes(item,fromIndex)}function object(value){return Object.assign(Object.create(null),value)}function remirror_core_helpers_toString(value){return Object.prototype.toString.call(value)}function getObjectType(value){let objectName=remirror_core_helpers_toString(value).slice(8,-1);return objectName}function isOfType(type,predicate){return value=>typeof value===type&&(!predicate||predicate(value))}function isObjectOfType(type){return value=>getObjectType(value)===type}var isUndefined=isOfType("undefined"),isString=isOfType("string"),isNumber=isOfType("number",value=>!Number.isNaN(value)),isFunction=isOfType("function");function isBoolean(value){return!0===value||!1===value}function isPlainObject(value){if("Object"!==getObjectType(value))return!1;let prototype=Object.getPrototypeOf(value);return null===prototype||prototype===Object.getPrototypeOf({})}function isNullOrUndefined(value){return null===value||isUndefined(value)}function isObject(value){return!isNullOrUndefined(value)&&(isFunction(value)||isOfType("object")(value))}function isInstanceOf(Constructor){return value=>isObject(value)&&value instanceof Constructor}isOfType("symbol");var isRegExp=isObjectOfType("RegExp");function isEmptyObject(value){return isObject(value)&&!isObjectOfType("Map")(value)&&!isObjectOfType("Set")(value)&&0===Object.keys(value).length}isObjectOfType("Date"),isObjectOfType("Error");var isArray=Array.isArray;function isEmptyArray(value){return isArray(value)&&0===value.length}function isNonEmptyArray(value){return isArray(value)&&value.length>0}function capitalize(string){return string.charAt(0).toUpperCase()+string.slice(1)}function findMatches(text,regexp,runWhile=match=>!!match){let match;regexp.lastIndex=0;let results=[],flags=regexp.flags;flags.includes("g")||(regexp=RegExp(regexp.source,`g${flags}`));do(match=regexp.exec(text))&&results.push(match);while(runWhile(match));return regexp.lastIndex=0,results}function n(){let time=Date.now(),last2=n.last||time;return n.last=time>last2?time:last2+1}function uniqueId(prefix=""){return`${prefix}${n().toString(36)}`}function take(array,number){return number=Math.max(Math.min(0,number),number),array.slice(0,number)}function omitUndefined(object2){return object_omit_default()(object2,value=>!isUndefined(value))}n.last=0;var isEqual=fast_deep_equal_default();function uniqueArray(array,fromStart=!1){let array_=fromStart?[...array].reverse():array,set2=new Set(array_);return fromStart?[...set2].reverse():[...set2]}function noop(){}function deepMerge(...objects){return cjs_default().all(objects,{isMergeableObject:isPlainObject})}function clamp({min,max,value}){return value<min?min:value>max?max:value}function last(array){return array[array.length-1]}function sort(array,compareFn){return[...array].map((value,index)=>({value,index})).sort((a,z)=>compareFn(a.value,z.value)||a.index-z.index).map(({value})=>value)}function unset(path,target){let clonedObject=function(value){if(!isPlainObject(value))throw Error("An invalid value was passed into this clone utility. Expected a plain object");return{...value}}(target),value=clonedObject;for(let[index,key]of path.entries()){var value1;let shouldDelete=index>=path.length-1,item=value[key];if(shouldDelete){if(isArray(value)){let indexKey=Number.parseInt(key.toString(),10);isNumber(indexKey)&&value.splice(indexKey,1)}else Reflect.deleteProperty(value,key);break}if(null==(value1=item)||/^[bns]/.test(typeof value1))break;item=isArray(item)?[...item]:{...item},value[key]=item,value=item}return clonedObject}function uniqueBy(array,getValue,fromStart=!1){let unique=[],found=new Set,getter=isFunction(getValue)?getValue:item=>(function(root,path,defaultValue){try{if(isString(path)&&path in root)return root[path];isArray(path)&&(path=`['${path.join("']['")}']`);let obj=root;return path.replace(/\[\s*(["'])(.*?)\1\s*]|^\s*(\w+)\s*(?=\.|\[|$)|\.\s*(\w*)\s*(?=\.|\[|$)|\[\s*(-?\d+)\s*]/g,(_,__,quotedProp,firstLevel,namedProp,index)=>(obj=obj[quotedProp||firstLevel||namedProp||index],"")),void 0===obj?defaultValue:obj}catch{return defaultValue}})(item,getValue),list=fromStart?[...array].reverse():array;for(let item of list){let value=getter(item);found.has(value)||(found.add(value),unique.push(item))}return fromStart?unique.reverse():unique}function range(start,end){let startValue=isArray(start)?start[0]:start;return isNumber(end)?startValue<=end?Array.from({length:end+1-startValue},(_,index)=>index+startValue):Array.from({length:startValue+1-end},(_,index)=>-1*index+startValue):Array.from({length:Math.abs(startValue)},(_,index)=>(startValue<0?-1:1)*index)}function within(value,...rest){let numbers=rest.filter(isNumber);return value>=Math.min(...numbers)&&value<=Math.max(...numbers)}function getLazyArray(value){return isFunction(value)?value():value}function remirror_core_helpers_cx(...classes){return uniqueArray(esm_cx(...classes).split(" ")).join(" ")}var ERROR_INFORMATION_URL="https://remirror.io/docs/errors",errorMessageMap={[remirror_core_constants.mA.UNKNOWN]:"An error occurred but we're not quite sure why. \uD83E\uDDD0",[remirror_core_constants.mA.INVALID_COMMAND_ARGUMENTS]:"The arguments passed to the command method were invalid.",[remirror_core_constants.mA.CUSTOM]:"This is a custom error, possibly thrown by an external library.",[remirror_core_constants.mA.CORE_HELPERS]:"An error occurred in a function called from the `@remirror/core-helpers` library.",[remirror_core_constants.mA.MUTATION]:"Mutation of immutable value detected.",[remirror_core_constants.mA.INTERNAL]:"This is an error which should not occur and is internal to the remirror codebase.",[remirror_core_constants.mA.MISSING_REQUIRED_EXTENSION]:"Your editor is missing a required extension.",[remirror_core_constants.mA.MANAGER_PHASE_ERROR]:"This occurs when accessing a method or property before it is available.",[remirror_core_constants.mA.INVALID_GET_EXTENSION]:"The user requested an invalid extension from the getExtensions method. Please check the `createExtensions` return method is returning an extension with the defined constructor.",[remirror_core_constants.mA.INVALID_MANAGER_ARGUMENTS]:"Invalid value(s) passed into `Manager` constructor. Only `Presets` and `Extensions` are supported.",[remirror_core_constants.mA.SCHEMA]:"There is a problem with the schema or you are trying to access a node / mark that doesn't exists.",[remirror_core_constants.mA.HELPERS_CALLED_IN_OUTER_SCOPE]:"The `helpers` method which is passed into the ``create*` method should only be called within returned method since it relies on an active view (not present in the outer scope).",[remirror_core_constants.mA.INVALID_MANAGER_EXTENSION]:"You requested an invalid extension from the manager.",[remirror_core_constants.mA.DUPLICATE_COMMAND_NAMES]:"Command method names must be unique within the editor.",[remirror_core_constants.mA.DUPLICATE_HELPER_NAMES]:"Helper method names must be unique within the editor.",[remirror_core_constants.mA.NON_CHAINABLE_COMMAND]:"Attempted to chain a non chainable command.",[remirror_core_constants.mA.INVALID_EXTENSION]:"The provided extension is invalid.",[remirror_core_constants.mA.INVALID_CONTENT]:"The content provided to the editor is not supported.",[remirror_core_constants.mA.INVALID_NAME]:"An invalid name was used for the extension.",[remirror_core_constants.mA.EXTENSION]:"An error occurred within an extension. More details should be made available.",[remirror_core_constants.mA.EXTENSION_SPEC]:"The spec was defined without calling the `defaults`, `parse` or `dom` methods.",[remirror_core_constants.mA.EXTENSION_EXTRA_ATTRIBUTES]:"Extra attributes must either be a string or an object.",[remirror_core_constants.mA.INVALID_SET_EXTENSION_OPTIONS]:"A call to `extension.setOptions` was made with invalid keys.",[remirror_core_constants.mA.REACT_PROVIDER_CONTEXT]:"`useRemirrorContext` was called outside of the `remirror` context. It can only be used within an active remirror context created by the `<Remirror />`.",[remirror_core_constants.mA.REACT_GET_ROOT_PROPS]:"`getRootProps` has been attached to the DOM more than once. It should only be attached to the dom once per editor.",[remirror_core_constants.mA.REACT_EDITOR_VIEW]:"A problem occurred adding the editor view to the dom.",[remirror_core_constants.mA.REACT_CONTROLLED]:"There is a problem with your controlled editor setup.",[remirror_core_constants.mA.REACT_NODE_VIEW]:"Something went wrong with your custom ReactNodeView Component.",[remirror_core_constants.mA.REACT_GET_CONTEXT]:"You attempted to call `getContext` provided by the `useRemirror` prop during the first render of the editor. This is not possible and should only be after the editor first mounts.",[remirror_core_constants.mA.REACT_COMPONENTS]:"An error occurred within a remirror component.",[remirror_core_constants.mA.REACT_HOOKS]:"An error occurred within a remirror hook.",[remirror_core_constants.mA.I18N_CONTEXT]:"You called `useI18n()` outside of an `I18nProvider` context."},RemirrorError=class extends make_error.BaseError{constructor({code,message,disableLogging=!1}={}){let errorCode=isString(code)&&includes(values(remirror_core_constants.mA),code)?code:remirror_core_constants.mA.CUSTOM;super(function(code,extraMessage){let message=errorMessageMap[code],prefix=message?`${message}

`:"",customMessage=extraMessage?`${extraMessage}

`:"";return`${prefix}${customMessage}For more information visit ${ERROR_INFORMATION_URL}#${code.toLowerCase()}`}(errorCode,message)),__publicField(this,"errorCode"),__publicField(this,"url"),this.errorCode=errorCode,this.url=`${ERROR_INFORMATION_URL}#${errorCode.toLowerCase()}`,disableLogging||console.error(this.message)}static create(options={}){return new RemirrorError(options)}};function invariant(condition,options){if(!condition)throw RemirrorError.create(options)}function defaultImport(mod){var _a;if("object"!=typeof mod||null===mod)return mod;let defaultVal=Symbol.toStringTag in mod&&"Module"===mod[Symbol.toStringTag]&&null!=(_a=mod.default)?_a:mod;return defaultVal&&"object"==typeof mod&&"__esModule"in defaultVal&&defaultVal.__esModule&&void 0!==defaultVal.default?defaultVal.default:defaultVal}function freeze(target,options={}){return target}},85775:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{Q2:function(){return chainKeyBindingCommands},PZ:function(){return composeTransactionSteps},V1:function(){return containsAttributes},EP:function(){return function createDocumentNode(props){let{content,schema,document:document2,stringHandler,onError,attempts=0}=props;if((0,remirror_core_helpers.kG)(onError&&attempts<=3||0===attempts,{code:remirror_core_constants.mA.INVALID_CONTENT,message:"The invalid content has been called recursively more than ${MAX_ATTEMPTS} times. The content is invalid and the error handler has not been able to recover properly."}),(0,remirror_core_helpers.HD)(content))return(0,remirror_core_helpers.kG)(stringHandler,{code:remirror_core_constants.mA.INVALID_CONTENT,message:`The string '${content}' was added to the editor, but no \`stringHandler\` was added. Please provide a valid string handler which transforms your content to a \`ProsemirrorNode\` to prevent this error.`}),stringHandler({document:document2,content,schema});if(isEditorState(content))return content.doc;if(isProsemirrorNode(content))return content;try{return schema.nodeFromJSON(content)}catch(error){let details=function({json,schema,...extra}){let validMarks=new Set((0,remirror_core_helpers.XP)(schema.marks)),validNodes=new Set((0,remirror_core_helpers.XP)(schema.nodes)),invalidContent=function checkForInvalidContent(props){let{json,validMarks,validNodes,path=[]}=props,valid={validMarks,validNodes},invalidNodes=[],{type,marks,content}=json,{invalidParentMark=!1,invalidParentNode=!1}=props;if(marks){let invalidMarks=[];for(let[index,mark]of marks.entries()){let name=(0,remirror_core_helpers.HD)(mark)?mark:mark.type;validMarks.has(name)||(invalidMarks.unshift({name,path:[...path,"marks",`${index}`],type:"mark",invalidParentMark,invalidParentNode}),invalidParentMark=!0)}invalidNodes.push(...invalidMarks)}if(validNodes.has(type)||(invalidNodes.push({name:type,type:"node",path,invalidParentMark,invalidParentNode}),invalidParentNode=!0),content){let invalidContent=[];for(let[index1,value]of content.entries())invalidContent.unshift(...checkForInvalidContent({...valid,json:value,path:[...path,"content",`${index1}`],invalidParentMark,invalidParentNode}));invalidNodes.unshift(...invalidContent)}return invalidNodes}({json,path:[],validNodes,validMarks});return{json,invalidContent,transformers,...extra}}({schema,error,json:content}),transformedContent=null==onError?void 0:onError(details);return(0,remirror_core_helpers.kG)(transformedContent,{code:remirror_core_constants.mA.INVALID_CONTENT,message:`An error occurred when processing the content. Please provide an \`onError\` handler to process the invalid content: ${JSON.stringify(details.invalidContent,null,2)}`}),createDocumentNode({...props,content:transformedContent,attempts:attempts+1})}}},NZ:function(){return environment},as:function(){return findChildrenByNode},hK:function(){return findNodeAtPosition},JB:function(){return findNodeAtSelection},Kk:function(){return findParentNode},Tr:function(){return findParentNodeOfType},a1:function(){return findSelectedNodeOfType},EM:function(){return getActiveNode},qh:function(){return getChangedNodes},QC:function(){return getChangedRanges},Lp:function(){return getCursor},JN:function(){return getDefaultBlockNode},Me:function(){return getDocument},IH:function(){return getMarkRange},x4:function(){return getMarkRanges},FI:function(){return getMatchString},jo:function(){return getNodeType},JM:function(){return getSelectedWord},Jv:function(){return getShortcutSymbols},C2:function(){return getStyle},b0:function(){return getTextSelection},yZ:function(){return hasTransactionChanged},OC:function(){return htmlToProsemirrorNode},d7:function(){return isAllSelection},xN:function(){return isDefaultBlockNode},$q:function(){return isDefaultDocNode},mV:function(){return isDomNode},jd:function(){return isElementDomNode},mp:function(){return isEmptyBlockNode},OA:function(){return isEndOfTextBlock},pI:function(){return isIdentifierOfType},yw:function(){return isMarkActive},Ig:function(){return isNodeActive},$9:function(){return isNodeOfType},EG:function(){return isNodeSelection},mt:function(){return isProsemirrorFragment},K_:function(){return isProsemirrorMark},PH:function(){return isProsemirrorNode},gf:function(){return isRemirrorType},G6:function(){return isSafari},Ab:function(){return isSelectionEmpty},GK:function(){return isStartOfDoc},sg:function(){return isStartOfTextBlock},hT:function(){return isTextSelection},X3:function(){return joinStyles},Cf:function(){return markInputRule},d3:function(){return mergeDOMRects},bk:function(){return mergeProsemirrorKeyBindings},x2:function(){return nodeInputRule},Kh:function(){return omitExtraAttributes},Em:function(){return prosemirrorNodeToHtml},P9:function(){return removeMark},aS:function(){return removeNodeAtPosition},IY:function(){return replaceNodeAtPosition},lp:function(){return replaceText},uJ:function(){return setBlockType},yL:function(){return setStyle},zU:function(){return toggleBlockItem},bm:function(){return toggleWrap},dy:function(){return updateMark},ym:function(){return wrapIn}});var remirror_core_constants=__webpack_require__(9436),remirror_core_helpers=__webpack_require__(62120),dist=__webpack_require__(39451),prosemirror_transform_dist=__webpack_require__(21692),uppercasePattern=/[A-Z]/g,msPattern=/^ms-/,cache={};function toHyphenLower(match){return"-"+match.toLowerCase()}var hyphenate_style_name=function(name){if(cache.hasOwnProperty(name))return cache[name];var hName=name.replace(uppercasePattern,toHyphenLower);return cache[name]=msPattern.test(hName)?"-"+hName:hName};function getDomDocument(){return"undefined"!=typeof document?document:null}var object_omit=__webpack_require__(13e3),object_omit_default=__webpack_require__.n(object_omit),prosemirror_model_dist=__webpack_require__(57981);__webpack_require__(81553);var remirror_messages=__webpack_require__(35708),prosemirror_inputrules_dist=__webpack_require__(85734),prosemirror_suggest=__webpack_require__(75430),process=__webpack_require__(83454),environment={get isBrowser(){return!!("undefined"!=typeof window&&void 0!==window.document&&window.navigator&&window.navigator.userAgent)},get isJSDOM(){return environment.isBrowser&&window.navigator.userAgent.includes("jsdom")},get isNode(){return void 0!==process&&null!=process.versions&&null!=process.versions.node},get isIos(){return environment.isBrowser&&/iPod|iPhone|iPad/.test(navigator.platform)},get isMac(){return environment.isBrowser&&/Mac|iPod|iPhone|iPad/.test(navigator.platform)},get isApple(){return environment.isNode?"darwin"===process.platform:!!environment.isBrowser&&/Mac|iPod|iPhone|iPad/.test(window.navigator.platform)},get isDevelopment(){return!1},get isTest(){return!1},get isProduction(){return!0}};function getStyle(element,property){var _a,_b;let view=maybeGetWindowFromDocument(null==element?void 0:element.ownerDocument);return null!=(_b=null==(_a=null==view?void 0:view.getComputedStyle(element))?void 0:_a.getPropertyValue(property))?_b:""}function setStyle(target,styles){return Object.assign(target.style,styles)}function isDomNode(domNode){return(0,remirror_core_helpers.Kn)(domNode)&&(0,remirror_core_helpers.hj)(domNode.nodeType)&&(0,remirror_core_helpers.HD)(domNode.nodeName)}function isElementDomNode(domNode){return isDomNode(domNode)&&1===domNode.nodeType}function mergeDOMRects(rect1,rect2){let left=Math.min(rect1.left,rect2.left),right=Math.max(rect1.right,rect2.right),top=Math.min(rect1.top,rect2.top),bottom=Math.max(rect1.bottom,rect2.bottom);return new DOMRect(left,top,right-left,bottom-top)}function isNodeOfType(props){let{types,node}=props;if(!node)return!1;let matches=type=>type===node.type||type===node.type.name;return(0,remirror_core_helpers.kJ)(types)?types.some(matches):matches(types)}function composeTransactionSteps(transactions,oldState){let{tr}=oldState;return transactions.forEach(transaction=>{transaction.steps.forEach(step=>{tr.step(step)})}),tr}function removeNodeAtPosition({pos,tr}){let node=tr.doc.nodeAt(pos);return node&&tr.delete(pos,pos+node.nodeSize),tr}function replaceNodeAtPosition({pos,tr,content}){let node=tr.doc.nodeAt(pos);return node&&tr.replaceWith(pos,pos+node.nodeSize,content),tr}function findParentNode(props){let{predicate,selection}=props,$pos=isEditorState(selection)?selection.selection.$from:isSelection(selection)?selection.$from:selection;for(let depth=$pos.depth;depth>0;depth--){let node=$pos.node(depth),pos=depth>0?$pos.before(depth):0,start=$pos.start(depth),end=pos+node.nodeSize;if(predicate(node,pos))return{pos,depth,node,start,end}}}function findNodeAtPosition($pos){let{depth}=$pos,pos=depth>0?$pos.before(depth):0,node=$pos.node(depth),start=$pos.start(depth),end=pos+node.nodeSize;return{pos,start,node,end,depth}}function findNodeAtSelection(selection){let parentNode=findParentNode({predicate:()=>!0,selection});return(0,remirror_core_helpers.kG)(parentNode,{message:"No parent node found for the selection provided."}),parentNode}function findParentNodeOfType(props){let{types,selection}=props;return findParentNode({predicate:node=>isNodeOfType({types,node}),selection})}function findSelectedNodeOfType(props){let{types,selection}=props;if(isNodeSelection(selection)&&isNodeOfType({types,node:selection.node}))return{pos:selection.$from.pos,depth:selection.$from.depth,start:selection.$from.start(),end:selection.$from.pos+selection.node.nodeSize,node:selection.node}}function isSelectionEmpty(value){return isSelection(value)?value.empty:value.selection.empty}function hasTransactionChanged(tr){return tr.docChanged||tr.selectionSet}function isNodeActive(props){return!!getActiveNode(props)}function getActiveNode(props){var _a;let{state,type,attrs}=props,{selection,doc}=state,nodeType=(0,remirror_core_helpers.HD)(type)?doc.type.schema.nodes[type]:type;(0,remirror_core_helpers.kG)(nodeType,{code:remirror_core_constants.mA.SCHEMA,message:`No node exists for ${type}`});let active=null!=(_a=findSelectedNodeOfType({selection,types:type}))?_a:findParentNode({predicate:node=>node.type===nodeType,selection});return!attrs||(0,remirror_core_helpers.Qr)(attrs)||!active?active:active.node.hasMarkup(nodeType,{...active.node.attrs,...attrs})?active:void 0}function chainKeyBindingCommands(...commands){return props=>{if(!(0,remirror_core_helpers.Of)(commands))return!1;let[command,...rest]=commands,calledNext=!1,createNext=(...nextCommands)=>()=>{if(!(0,remirror_core_helpers.Of)(nextCommands))return!1;calledNext=!0;let[,...nextRest]=nextCommands;return chainKeyBindingCommands(...nextCommands)({...props,next:createNext(...nextRest)})},next=createNext(...rest),exitEarly=command({...props,next});return calledNext||exitEarly?exitEarly:next()}}function mergeProsemirrorKeyBindings(extensionKeymaps){return function(extensionKeymaps,mapper){var _a;let previousCommandsMap=new Map,mappedCommands=(0,remirror_core_helpers.Ry)();for(let extensionKeymap of extensionKeymaps)for(let[key,newCommand]of(0,remirror_core_helpers.qh)(extensionKeymap)){let previousCommands=null!=(_a=previousCommandsMap.get(key))?_a:[],commands=[...previousCommands,newCommand],command=chainKeyBindingCommands(...commands);previousCommandsMap.set(key,commands),mappedCommands[key]=mapper(command)}return mappedCommands}(extensionKeymaps,command=>(state,dispatch,view)=>command({state,dispatch,view,tr:state.tr,next:()=>!1}))}function containsAttributes(nodeOrMark,attrs){var _a;let currentAttrs=null!=(_a=nodeOrMark.attrs)?_a:{};return Object.entries(attrs).every(([name,value])=>currentAttrs[name]===value)}function isRemirrorType(value){return(0,remirror_core_helpers.Kn)(value)}function isIdentifierOfType(value,type){return(0,remirror_core_helpers.kJ)(type)?(0,remirror_core_helpers.q9)(type,value[remirror_core_constants.By]):type===value[remirror_core_constants.By]}function getNodeType(type,schema){return(0,remirror_core_helpers.HD)(type)?(0,remirror_core_helpers.fp)(schema.nodes,type):type}function isMarkType(value){return(0,remirror_core_helpers.Kn)(value)&&value instanceof prosemirror_model_dist.ZU}function isProsemirrorNode(value){return(0,remirror_core_helpers.Kn)(value)&&value instanceof prosemirror_model_dist.NB}function isProsemirrorFragment(value){return(0,remirror_core_helpers.Kn)(value)&&value instanceof prosemirror_model_dist.HY}function isProsemirrorMark(value){return(0,remirror_core_helpers.Kn)(value)&&value instanceof prosemirror_model_dist.vc}function isEditorState(value){return(0,remirror_core_helpers.Kn)(value)&&value instanceof dist.yy}function isTextSelection(value){return(0,remirror_core_helpers.Kn)(value)&&value instanceof dist.Bs}function isAllSelection(value){return(0,remirror_core_helpers.Kn)(value)&&value instanceof dist.C1}function isSelection(value){return(0,remirror_core_helpers.Kn)(value)&&value instanceof dist.Y1}function rangeHasMark(props){var schema;let{trState,from,to,type,attrs={}}=props,{doc}=trState,markType=(schema=doc.type.schema,(0,remirror_core_helpers.HD)(type)?(0,remirror_core_helpers.fp)(schema.marks,type):type);if(0===Object.keys(attrs).length)return doc.rangeHasMark(from,to,markType);let found=!1;return to>from&&doc.nodesBetween(from,to,node=>{var _a;if(found)return!1;let marks=null!=(_a=node.marks)?_a:[];return!(found=marks.some(mark=>mark.type===markType&&containsAttributes(mark,attrs)))}),found}function isNodeSelection(value){return(0,remirror_core_helpers.Kn)(value)&&value instanceof dist.qv}function isMarkActive(props){let{trState,type,attrs={},from,to}=props,{selection,doc,storedMarks}=trState,markType=(0,remirror_core_helpers.HD)(type)?doc.type.schema.marks[type]:type;if((0,remirror_core_helpers.kG)(markType,{code:remirror_core_constants.mA.SCHEMA,message:`Mark type: ${type} does not exist on the current schema.`}),from&&to)try{return Math.max(from,to)<doc.nodeSize&&rangeHasMark({...props,from,to})}catch{return!1}if(selection.empty){let marks=null!=storedMarks?storedMarks:selection.$from.marks();return marks.some(mark=>mark.type===type&&containsAttributes(mark,null!=attrs?attrs:{}))}return rangeHasMark({...props,from:selection.from,to:selection.to})}function isDefaultDocNode(doc,options={}){var _a,_b;let defaultDoc=null!=(_b=null==(_a=doc.type.schema.nodes.doc)?void 0:_a.createAndFill())?_b:void 0;if(!defaultDoc)return!1;let{ignoreAttributes,ignoreDocAttributes}=options;return ignoreAttributes?function prosemirrorNodeEquals(node,other){if(node===other)return!0;let identicalMarkup=node.type===other.type&&prosemirror_model_dist.vc.sameSet(node.marks,other.marks);return identicalMarkup&&function(){if(node.content===other.content)return!0;if(node.content.size!==other.content.size)return!1;let nodeChildren=[],otherChildren=[];for(let[index,nodeChild]of(node.content.forEach(node2=>nodeChildren.push(node2)),other.content.forEach(node2=>otherChildren.push(node2)),nodeChildren.entries())){let otherChild=otherChildren[index];if(!otherChild||!prosemirrorNodeEquals(nodeChild,otherChild))return!1}return!0}()}(defaultDoc,doc):ignoreDocAttributes?defaultDoc.content.eq(doc.content):defaultDoc.eq(doc)}function getDefaultBlockNode(schema){for(let type of Object.values(schema.nodes))if("doc"!==type.name&&(type.isBlock||type.isTextblock))return type;(0,remirror_core_helpers.kG)(!1,{code:remirror_core_constants.mA.SCHEMA,message:"No default block node found for the provided schema."})}function isDefaultBlockNode(node){return node.type===getDefaultBlockNode(node.type.schema)}function isEmptyBlockNode(node){return!!node&&node.type.isBlock&&!node.textContent&&!node.childCount}function getMarkRange($pos,type,$end){let start=$pos.parent.childAfter($pos.parentOffset);if(!start.node)return;let typeName=(0,remirror_core_helpers.HD)(type)?type:type.name,mark=start.node.marks.find(({type:markType})=>markType.name===typeName),startIndex=$pos.index(),startPos=$pos.start()+start.offset,endIndex=startIndex+1,endPos=startPos+start.node.nodeSize;if(!mark)return $end&&endPos<$end.pos?getMarkRange($pos.doc.resolve(endPos+1),type,$end):void 0;for(;startIndex>0&&mark.isInSet($pos.parent.child(startIndex-1).marks);)startIndex-=1,startPos-=$pos.parent.child(startIndex).nodeSize;for(;endIndex<$pos.parent.childCount&&mark.isInSet($pos.parent.child(endIndex).marks);)endPos+=$pos.parent.child(endIndex).nodeSize,endIndex+=1;let text=$pos.doc.textBetween(startPos,endPos,remirror_core_constants.Z9,"\n\n");return{from:startPos,to:endPos,text,mark}}function getMarkRanges(selection,type){let markRanges=[],{$from,$to}=selection,$pos=$from;for(;;){let range=getMarkRange($pos,type,$to);if(!range)return markRanges;if(markRanges.push(range),range.to<$to.pos){$pos=$from.doc.resolve(range.to+1);continue}return markRanges}}function isValidStep(step,StepTypes){return 0===StepTypes.length||StepTypes.some(Constructor=>step instanceof Constructor)}function getChangedRanges(tr,StepTypes=[]){let ranges=[],{steps,mapping}=tr,inverseMapping=mapping.invert();steps.forEach((step,i)=>{if(!isValidStep(step,StepTypes))return;let rawRanges=[],stepMap=step.getMap(),mappingSlice=mapping.slice(i);if(0===stepMap.ranges.length&&isValidStep(step,[prosemirror_transform_dist.WJ,prosemirror_transform_dist.FC,prosemirror_transform_dist.Pu,prosemirror_transform_dist.xu])){let{from,to}=step;rawRanges.push({from,to})}else stepMap.forEach((from,to)=>{rawRanges.push({from,to})});rawRanges.forEach(range=>{let from=mappingSlice.map(range.from,-1),to=mappingSlice.map(range.to);ranges.push({from,to,prevFrom:inverseMapping.map(from,-1),prevTo:inverseMapping.map(to)})})});let sortedRanges=(0,remirror_core_helpers.DY)(ranges,(a,z)=>a.from-z.from);return function(ranges){let uniqueRanges=(0,remirror_core_helpers.uw)(ranges,({from,to,prevFrom,prevTo})=>`${from}_${to}_${prevFrom}_${prevTo}`);return uniqueRanges.filter((range,i,arr)=>!arr.some((otherRange,j)=>i!==j&&range.prevFrom>=otherRange.prevFrom&&range.prevTo<=otherRange.prevTo&&range.from>=otherRange.from&&range.to<=otherRange.to))}(sortedRanges)}function getSelectedWord(state){return function(state,exclude){if(!isTextSelection(state.selection))return;let{from,to}=state.selection,getChar=(start,end)=>{var _a,_b;return null!=(_b=null==(_a=dist.Bs.between(state.doc.resolve(start),state.doc.resolve(end)).content().content.firstChild)?void 0:_a.textContent)?_b:""};for(let char=getChar(from-1,from);char&&!exclude.test(char);char=getChar(--from-1,from));for(let char1=getChar(to,to+1);char1&&!exclude.test(char1);char1=getChar(++to,to+1));if(from===to)return;let text=state.doc.textBetween(from,to,remirror_core_constants.Z9,"\n\n");return{from,to,text}}(state,/\W/)}function getMatchString(match,index=0){let value=(0,remirror_core_helpers.kJ)(match)?match[index]:match;return(0,remirror_core_helpers.hu)((0,remirror_core_helpers.HD)(value),`No match string found for match ${match}`),null!=value?value:""}function getCursor(selection){return isTextSelection(selection)?selection.$cursor:void 0}function getTextSelection(selection,doc){var value;let pos;let max=doc.nodeSize-2,clampToDocument=value=>(0,remirror_core_helpers.uZ)({min:0,max,value});if(isSelection(selection))return selection;if("all"===selection)return new dist.C1(doc);if(pos="start"===selection?0:"end"===selection?max:(0,remirror_core_helpers.Kn)(selection)&&selection instanceof prosemirror_model_dist.ZQ?selection.pos:selection,(0,remirror_core_helpers.hj)(pos))return pos=clampToDocument(pos),dist.Bs.near(doc.resolve(pos));if(value=pos,(0,remirror_core_helpers.Kn)(value)&&(0,remirror_core_helpers.hj)(value.anchor)&&(0,remirror_core_helpers.hj)(value.head)){let anchor2=clampToDocument(pos.anchor),head2=clampToDocument(pos.head);return dist.Bs.between(doc.resolve(anchor2),doc.resolve(head2))}let anchor=clampToDocument(pos.from),head=clampToDocument(pos.to);return dist.Bs.between(doc.resolve(anchor),doc.resolve(head))}function getDocument(){let document2=getDomDocument();if(document2)return document2;throw Error("Unable to retrieve the document from the global scope. \nIt seems that you are running Remirror in a non-browser environment. Remirror need browser APIs to work. \nIf you are using Jest (or other testing frameworks), make sure that you are using the JSDOM environment (https://jestjs.io/docs/29.0/configuration#testenvironment-string). \nIf you are using Next.js (or other server-side rendering frameworks), please use dynamic import with `ssr: false` to load the editor component without rendering it on the server (https://nextjs.org/docs/advanced-features/dynamic-import#with-no-ssr). \nIf you are using Node.js, you can install JSDOM and Remirror will try to use it automatically, or you can create a fake document and pass it to Remirror")}function maybeGetWindowFromDocument(document2){var _a,_b,_c;return null!=(_c=null!=(_a=null==document2?void 0:document2.defaultView)?_a:"undefined"!=typeof window?window:void 0)?_c:null==(_b=getDomDocument())?void 0:_b.defaultView}function prosemirrorNodeToHtml(node,document2=getDocument()){let element=document2.createElement("div");return element.append(function(node,document2=getDocument()){var schema;let fragment=(schema=node.type.schema,isProsemirrorNode(node)&&(schema?node.type===schema.nodes.doc:"doc"===node.type.name))?node.content:prosemirror_model_dist.HY.from(node);return prosemirror_model_dist.PW.fromSchema(node.type.schema).serializeFragment(fragment,{document:document2})}(node,document2)),element.innerHTML}function htmlToProsemirrorNode(props){let{content,schema,document:document2,fragment=!1,...parseOptions}=props,element=function(html,document2){let parser=new(function(document2){var _a;let view=null!=(_a=maybeGetWindowFromDocument(document2))?_a:getDocument().defaultView;if(view)return view;throw Error("Unable to retrieve the window from the global scope")}(document2)).DOMParser;return parser.parseFromString(`<body>${html}</body>`,"text/html").body}(content,document2),parser=prosemirror_model_dist.aw.fromSchema(schema);return fragment?parser.parseSlice(element,{...defaultParseOptions,...parseOptions}).content:parser.parse(element,{...defaultParseOptions,...parseOptions})}var defaultParseOptions={preserveWhitespace:!1};function omitExtraAttributes(attrs,extra){let extraAttributeNames=(0,remirror_core_helpers.XP)(extra.defaults());return object_omit_default()({...attrs},extraAttributeNames)}function joinStyles(styleObject,initialStyles){let start="";initialStyles&&(start=`${initialStyles.trim()}`);let end=function(style){var css="";for(var property in style){var value=style[property];("string"==typeof value||"number"==typeof value)&&(css&&(css+=";"),css+=hyphenate_style_name(property)+":"+value)}return css}(styleObject);if(!end)return start;let separator=(start.endsWith(";")," ");return`${start}${separator}${end}`}var transformers={remove(json,invalidContent){let newJSON=json;for(let block of invalidContent)block.invalidParentNode||(newJSON=(0,remirror_core_helpers.zN)(block.path,newJSON));return newJSON}};function isEndOfTextBlock(selection){return!!(isTextSelection(selection)&&selection.$cursor&&selection.$cursor.parentOffset>=selection.$cursor.parent.content.size)}function isStartOfTextBlock(selection){return!!(isTextSelection(selection)&&selection.$cursor&&selection.$cursor.parentOffset<=0)}function isStartOfDoc(selection){let selectionAtStart=dist.Y1.atStart(selection.$anchor.doc);return!!(isStartOfTextBlock(selection)&&selectionAtStart.anchor===selection.anchor)}function updateMark(props){return({dispatch,tr})=>{let{type,attrs=(0,remirror_core_helpers.Ry)(),appendText,range}=props,selection=range?dist.Bs.between(tr.doc.resolve(range.from),tr.doc.resolve(range.to)):tr.selection,{$from,from,to}=selection,applicable=0===$from.depth&&tr.doc.type.allowsMarkType(type);return tr.doc.nodesBetween(from,to,node=>{if(applicable)return!1;node.inlineContent&&node.type.allowsMarkType(type)&&(applicable=!0)}),!!applicable&&(null==dispatch||dispatch(tr.addMark(from,to,type.create(attrs))&&appendText?tr.insertText(appendText):tr),!0)}}function wrapIn(type,attrs={},selection){return function(props){let{tr,dispatch,state}=props,nodeType=(0,remirror_core_helpers.HD)(type)?(0,remirror_core_helpers.fp)(state.schema.nodes,type):type,{from,to}=getTextSelection(null!=selection?selection:tr.selection,tr.doc),$from=tr.doc.resolve(from),$to=tr.doc.resolve(to),blockRange=$from.blockRange($to),wrapping=blockRange&&(0,prosemirror_transform_dist.nd)(blockRange,nodeType,attrs);return!!wrapping&&!!blockRange&&(null==dispatch||dispatch(tr.wrap(blockRange,wrapping).scrollIntoView()),!0)}}function toggleWrap(nodeType,attrs={},selection){return props=>{let{tr,state}=props,type=(0,remirror_core_helpers.HD)(nodeType)?(0,remirror_core_helpers.fp)(state.schema.nodes,nodeType):nodeType,activeNode=getActiveNode({state:tr,type,attrs});return activeNode?function({tr,dispatch}){let{$from,$to}=tr.selection,range=$from.blockRange($to),target=range&&(0,prosemirror_transform_dist.k9)(range);return!!(0,remirror_core_helpers.hj)(target)&&!!range&&(null==dispatch||dispatch(tr.lift(range,target).scrollIntoView()),!0)}(props):wrapIn(nodeType,attrs,selection)(props)}}function setBlockType(nodeType,attrs,selection,preserveAttrs=!0){return function(props){let activeAttrs;let{tr,dispatch,state}=props,type=(0,remirror_core_helpers.HD)(nodeType)?(0,remirror_core_helpers.fp)(state.schema.nodes,nodeType):nodeType,{from,to}=getTextSelection(null!=selection?selection:tr.selection,tr.doc),applicable=!1;return tr.doc.nodesBetween(from,to,(node,pos)=>{if(applicable)return!1;if(!node.isTextblock||node.hasMarkup(type,attrs))return;if(node.type===type){applicable=!0,activeAttrs=node.attrs;return}let $pos=tr.doc.resolve(pos),index=$pos.index();(applicable=$pos.parent.canReplaceWith(index,index+1,type))&&(activeAttrs=$pos.parent.attrs)}),!!applicable&&(null==dispatch||dispatch(tr.setBlockType(from,to,type,{...preserveAttrs?activeAttrs:{},...attrs}).scrollIntoView()),!0)}}function toggleBlockItem(toggleProps){return props=>{var _a;let{tr,state}=props,{type,attrs,preserveAttrs=!0}=toggleProps,activeNode=getActiveNode({state:tr,type,attrs}),toggleType=null!=(_a=toggleProps.toggleType)?_a:getDefaultBlockNode(state.schema);if(activeNode)return setBlockType(toggleType,{...preserveAttrs?activeNode.node.attrs:{},...attrs})(props);let toggleNode=getActiveNode({state:tr,type:toggleType,attrs});return setBlockType(type,{...preserveAttrs?null==toggleNode?void 0:toggleNode.node.attrs:{},...attrs})(props)}}function isChrome(minVersion=0){let parsedAgent=navigator.userAgent.match(/Chrom(e|ium)\/(\d+)\./);return!!parsedAgent&&Number.parseInt((0,remirror_core_helpers.fp)(parsedAgent,2),10)>=minVersion}function isSafari(minVersion=0){let isMac=navigator.userAgent.match(/Mac/),parsedAgent=navigator.userAgent.match(/Safari\/(\d+)\./);return!!isMac&&!isChrome()&&!!parsedAgent&&Number.parseInt((0,remirror_core_helpers.fp)(parsedAgent,1),10)>=minVersion}function replaceText(props){let{attrs={},appendText="",content="",keepSelection=!1,range}=props;return({state,tr,dispatch})=>{var _a,_b,_c,_d;let schema=state.schema,selection=getTextSelection(null!=(_b=null!=(_a=props.selection)?_a:range)?_b:tr.selection,tr.doc),index=selection.$from.index(),{from,to,$from}=selection,type=(0,remirror_core_helpers.HD)(props.type)?null!=(_c=schema.nodes[props.type])?_c:schema.marks[props.type]:props.type;if((0,remirror_core_helpers.kG)(!(0,remirror_core_helpers.HD)(props.type)||type,{code:remirror_core_constants.mA.SCHEMA,message:`Schema contains no marks or nodes with name ${type}`}),(0,remirror_core_helpers.Kn)(type)&&type instanceof prosemirror_model_dist.Jq){if(!$from.parent.canReplaceWith(index,index,type))return!1;tr.replaceWith(from,to,type.create(attrs,content?schema.text(content):void 0))}else(0,remirror_core_helpers.kG)(content,{message:"`replaceText` cannot be called without content when using a mark type"}),tr.replaceWith(from,to,schema.text(content,isMarkType(type)?[type.create(attrs)]:void 0));return appendText&&tr.insertText(appendText),keepSelection&&function(selection,tr){let{head,empty,anchor}=selection;for(let step of tr.steps){let map=step.getMap();head=map.map(head)}empty?tr.setSelection(dist.Bs.near(tr.doc.resolve(head))):tr.setSelection(dist.Bs.between(tr.doc.resolve(anchor),tr.doc.resolve(head)))}(state.selection,tr),dispatch&&(isChrome(60)&&(null==(_d=document.getSelection())||_d.empty()),dispatch(tr)),!0}}function removeMark(props){return({dispatch,tr,state})=>{var _a,_b;let{type,expand=!0,range}=props,selection=getTextSelection(null!=(_b=null!=(_a=props.selection)?_a:range)?_b:tr.selection,tr.doc),{from,to,$from,$to}=selection,markType=(0,remirror_core_helpers.HD)(type)?state.schema.marks[type]:type;null!==markType&&(0,remirror_core_helpers.kG)(markType,{code:remirror_core_constants.mA.SCHEMA,message:`Mark type: ${type} does not exist on the current schema.`});let rangeMark=null!=markType?markType:function getFirstMark($pos,$end){let start=$pos.parent.childAfter($pos.parentOffset);if(!start.node)return;let{marks,nodeSize}=start.node;if(marks[0])return marks[0].type;let startPos=$pos.start()+start.offset;return getFirstMark($pos.doc.resolve(startPos+nodeSize+1),$end)}($from);if(!rangeMark)return!1;let markRange=getMarkRange($from,rangeMark,$to);return expand&&markRange&&(from=Math.max(0,Math.min(from,markRange.from)),to=Math.min(Math.max(to,markRange.to),tr.doc.nodeSize-2)),null==dispatch||dispatch(tr.removeMark(from,(0,remirror_core_helpers.hj)(to)?to:from,isMarkType(markType)?markType:void 0)),!0}}function getShortcutSymbols(shortcut){let symbols=[];for(let key of shortcut.split("-")){if(function(key){let allowedKeys=["command","cmd","meta"];return environment.isMac&&allowedKeys.push("mod"),allowedKeys.includes(key)}(key=key.toLowerCase())){symbols.push({type:"modifier",symbol:"⌘",key:"command",i18n:remirror_messages.LS.COMMAND_KEY});continue}if(function(key){let allowedKeys=["control","ctrl"];return environment.isMac||allowedKeys.push("mod"),allowedKeys.includes(key)}(key)){symbols.push({type:"modifier",symbol:"⌃",key:"control",i18n:remirror_messages.LS.CONTROL_KEY});continue}switch(key){case"shift":symbols.push({type:"modifier",symbol:"⇧",key,i18n:remirror_messages.LS.SHIFT_KEY});continue;case"alt":symbols.push({type:"modifier",symbol:"⌥",key,i18n:remirror_messages.LS.ALT_KEY});continue;case"\n":case"\r":case"enter":symbols.push({type:"named",symbol:"↵",key,i18n:remirror_messages.LS.ENTER_KEY});continue;case"backspace":symbols.push({type:"named",symbol:"⌫",key,i18n:remirror_messages.LS.BACKSPACE_KEY});continue;case"delete":symbols.push({type:"named",symbol:"⌦",key,i18n:remirror_messages.LS.DELETE_KEY});continue;case"escape":symbols.push({type:"named",symbol:"␛",key,i18n:remirror_messages.LS.ESCAPE_KEY});continue;case"tab":symbols.push({type:"named",symbol:"⇥",key,i18n:remirror_messages.LS.TAB_KEY});continue;case"capslock":symbols.push({type:"named",symbol:"⇪",key,i18n:remirror_messages.LS.CAPS_LOCK_KEY});continue;case"space":symbols.push({type:"named",symbol:"␣",key,i18n:remirror_messages.LS.SPACE_KEY});continue;case"pageup":symbols.push({type:"named",symbol:"⤒",key,i18n:remirror_messages.LS.PAGE_UP_KEY});continue;case"pagedown":symbols.push({type:"named",symbol:"⤓",key,i18n:remirror_messages.LS.PAGE_DOWN_KEY});continue;case"home":symbols.push({type:"named",key,i18n:remirror_messages.LS.HOME_KEY});continue;case"end":symbols.push({type:"named",key,i18n:remirror_messages.LS.END_KEY});continue;case"arrowleft":symbols.push({type:"named",symbol:"←",key,i18n:remirror_messages.LS.ARROW_LEFT_KEY});continue;case"arrowright":symbols.push({type:"named",symbol:"→",key,i18n:remirror_messages.LS.ARROW_RIGHT_KEY});continue;case"arrowup":symbols.push({type:"named",symbol:"→",key,i18n:remirror_messages.LS.ARROW_UP_KEY});continue;case"arrowdown":symbols.push({type:"named",symbol:"↓",key,i18n:remirror_messages.LS.ARROW_DOWN_KEY});continue;default:symbols.push({type:"char",key});continue}}return symbols}function findChildren(props){let{node,predicate,descend=!0,action}=props;(0,remirror_core_helpers.kG)(isProsemirrorNode(node),{code:remirror_core_constants.mA.INTERNAL,message:'Invalid "node" parameter passed to "findChildren".'}),(0,remirror_core_helpers.kG)((0,remirror_core_helpers.mf)(predicate),{code:remirror_core_constants.mA.INTERNAL,message:'Invalid "predicate" parameter passed to "findChildren".'});let result=[];return node.descendants((child,pos)=>{let nodeWithPosition={node:child,pos},isMatch=predicate(nodeWithPosition);return isMatch&&(result.push(nodeWithPosition),null==action||action(nodeWithPosition)),descend}),result}function findNodeByPredicate({predicate}){return props=>findChildren({...props,predicate})}function findChildrenByNode(props){let{type,...rest}=props;return findChildren({...rest,predicate:child=>child.node.type===type})}function getChangedNodes(tr,options={}){let{descend=!1,predicate,StepTypes}=options,nodeRange=function(tr,StepTypes){let nodeRanges=[],ranges=getChangedRanges(tr,StepTypes);for(let range of ranges)try{let $from=tr.doc.resolve(range.from),$to=tr.doc.resolve(range.to),nodeRange=$from.blockRange($to);nodeRange&&nodeRanges.push(nodeRange)}catch{}return nodeRanges}(tr,StepTypes),nodes=[];for(let range of nodeRange){let{start,end}=range;tr.doc.nodesBetween(start,end,(node,pos)=>{var _a;let shouldAdd=null==(_a=null==predicate?void 0:predicate(node,pos,range))||_a;return shouldAdd&&nodes.push({node,pos}),descend})}return nodes}function markInputRule(props){let markType;let{regexp,type,getAttributes,ignoreWhitespace=!1,beforeDispatch,updateCaptured,shouldSkip,invalidMarks}=props,rule=new prosemirror_inputrules_dist.VK(regexp,(state,match,start,end)=>{var _a;let{tr,schema}=state;markType||(markType=(0,remirror_core_helpers.HD)(type)?schema.marks[type]:type,(0,remirror_core_helpers.kG)(markType,{code:remirror_core_constants.mA.SCHEMA,message:`Mark type: ${type} does not exist on the current schema.`}));let captureGroup=match[1],fullMatch=match[0],details=gatherDetails({captureGroup,fullMatch,end,start,rule,state,ignoreWhitespace,invalidMarks,shouldSkip,updateCaptured});if(!details)return null;({start,end,captureGroup,fullMatch}=details);let attributes=(0,remirror_core_helpers.mf)(getAttributes)?getAttributes(match):getAttributes,markEnd=end,initialStoredMarks=[];if(captureGroup){let startSpaces=fullMatch.search(/\S/),textStart=start+fullMatch.indexOf(captureGroup),textEnd=textStart+captureGroup.length;initialStoredMarks=null!=(_a=tr.storedMarks)?_a:[],textEnd<end&&tr.delete(textEnd,end),textStart>start&&tr.delete(start+startSpaces,textStart),markEnd=start+startSpaces+captureGroup.length}return tr.addMark(start,markEnd,markType.create(attributes)),tr.setStoredMarks(initialStoredMarks),null==beforeDispatch||beforeDispatch({tr,match,start,end}),tr});return rule}function nodeInputRule(props){let{regexp,type,getAttributes,beforeDispatch,shouldSkip,ignoreWhitespace=!1,updateCaptured,invalidMarks}=props,rule=new prosemirror_inputrules_dist.VK(regexp,(state,match,start,end)=>{let attributes=(0,remirror_core_helpers.mf)(getAttributes)?getAttributes(match):getAttributes,{tr,schema}=state,nodeType=(0,remirror_core_helpers.HD)(type)?schema.nodes[type]:type,captureGroup=match[1],fullMatch=match[0],details=gatherDetails({captureGroup,fullMatch,end,start,rule,state,ignoreWhitespace,invalidMarks,shouldSkip,updateCaptured});if(!details)return null;({start,end,captureGroup,fullMatch}=details),(0,remirror_core_helpers.kG)(nodeType,{code:remirror_core_constants.mA.SCHEMA,message:`No node exists for ${type} in the schema.`});let content=nodeType.createAndFill(attributes);return content&&(tr.replaceRangeWith(nodeType.isBlock?tr.doc.resolve(start).before():start,end,content),null==beforeDispatch||beforeDispatch({tr,match:[fullMatch,null!=captureGroup?captureGroup:""],start,end})),tr});return rule}function gatherDetails({captureGroup,fullMatch,end,start,rule,ignoreWhitespace,shouldSkip,updateCaptured,state,invalidMarks}){var _a,_b,_c,_d,_e,_f;if(null==fullMatch)return null;let details=null!=(_a=null==updateCaptured?void 0:updateCaptured({captureGroup,fullMatch,start,end}))?_a:{};captureGroup=null!=(_b=details.captureGroup)?_b:captureGroup,fullMatch=null!=(_c=details.fullMatch)?_c:fullMatch,start=null!=(_d=details.start)?_d:start,end=null!=(_e=details.end)?_e:end;let $from=state.doc.resolve(start),$to=state.doc.resolve(end);return invalidMarks&&(0,prosemirror_suggest.j4)({$from,$to},invalidMarks)||rule.invalidMarks&&(0,prosemirror_suggest.j4)({$from,$to},rule.invalidMarks)||ignoreWhitespace&&(null==captureGroup?void 0:captureGroup.trim())===""||(null==shouldSkip?void 0:shouldSkip({state,captureGroup,fullMatch,start,end,ruleType:"mark"}))||(null==(_f=rule.shouldSkip)?void 0:_f.call(rule,{state,captureGroup,fullMatch,start,end,ruleType:"mark"}))?null:{captureGroup,end,fullMatch,start}}findNodeByPredicate({predicate:child=>child.node.isText}),findNodeByPredicate({predicate:child=>child.node.isInline}),findNodeByPredicate({predicate:child=>child.node.isBlock})},35708:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{J:function(){return extensionCodeBlockMessages},LS:function(){return coreUtilsMessages},Mo:function(){return extensionStrikeMessages},Q5:function(){return extensionColumnsMessages},TU:function(){return extensionBlockquoteMessages},Vb:function(){return coreMessages},XK:function(){return extensionTablesMessages},XW:function(){return extensionHistoryMessages},bA:function(){return extensionUnderlineMessages},bk:function(){return extensionHeadingMessages},iR:function(){return extensionParagraphMessages},ir:function(){return extensionHorizontalRuleMessages},it:function(){return extensionListMessages},jz:function(){return extensionCodeMessages},ov:function(){return extensionBoldMessages},ri:function(){return reactComponentsMessages},wr:function(){return extensionItalicMessages}});var coreMessages=Object.freeze({__proto__:null,COPY_LABEL:{id:"extension.command.copy.label",comment:"Label for copy command.",message:"Copy"},COPY_DESCRIPTION:{id:"extension.command.copy.description",comment:"Description for copy command.",message:"Copy the selected text"},CUT_LABEL:{id:"extension.command.cut.label",comment:"Label for cut command.",message:"Cut"},CUT_DESCRIPTION:{id:"extension.command.cut.description",comment:"Description for cut command.",message:"Cut the selected text"},PASTE_LABEL:{id:"extension.command.paste.label",comment:"Label for paste command.",message:"Paste"},PASTE_DESCRIPTION:{id:"extension.command.paste.description",comment:"Description for paste command.",message:"Paste content into the editor"},SELECT_ALL_LABEL:{id:"extension.command.select-all.label",comment:"Label for select all command.",message:"Select all"},SELECT_ALL_DESCRIPTION:{id:"extension.command.select-all.description",comment:"Description for select all command.",message:"Select all content within the editor"}}),coreUtilsMessages=Object.freeze({__proto__:null,ESCAPE_KEY:{id:"keyboard.shortcut.escape",comment:"Label for escape key in shortcuts.",message:"Enter"},COMMAND_KEY:{id:"keyboard.shortcut.command",comment:"Label for command key in shortcuts.",message:"Command"},CONTROL_KEY:{id:"keyboard.shortcut.control",comment:"Label for control key in shortcuts.",message:"Control"},ENTER_KEY:{id:"keyboard.shortcut.enter",comment:"Label for enter key in shortcuts.",message:"Enter"},SHIFT_KEY:{id:"keyboard.shortcut.shift",comment:"Label for shift key in shortcuts.",message:"Shift"},ALT_KEY:{id:"keyboard.shortcut.alt",comment:"Label for alt key in shortcuts.",message:"Alt"},CAPS_LOCK_KEY:{id:"keyboard.shortcut.capsLock",comment:"Label for caps lock key in shortcuts.",message:"Caps Lock"},BACKSPACE_KEY:{id:"keyboard.shortcut.backspace",comment:"Label for backspace key in shortcuts.",message:"Backspace"},TAB_KEY:{id:"keyboard.shortcut.tab",comment:"Label for tab key in shortcuts.",message:"Tab"},SPACE_KEY:{id:"keyboard.shortcut.space",comment:"Label for space key in shortcuts.",message:"Space"},DELETE_KEY:{id:"keyboard.shortcut.delete",comment:"Label for delete key in shortcuts.",message:"Delete"},PAGE_UP_KEY:{id:"keyboard.shortcut.pageUp",comment:"Label for page up key in shortcuts.",message:"Page Up"},PAGE_DOWN_KEY:{id:"keyboard.shortcut.pageDown",comment:"Label for page down key in shortcuts.",message:"Page Down"},HOME_KEY:{id:"keyboard.shortcut.home",comment:"Label for home key in shortcuts.",message:"Home"},END_KEY:{id:"keyboard.shortcut.end",comment:"Label for end key in shortcuts.",message:"End"},ARROW_LEFT_KEY:{id:"keyboard.shortcut.arrowLeft",comment:"Label for arrow left key in shortcuts.",message:"Arrow Left"},ARROW_RIGHT_KEY:{id:"keyboard.shortcut.arrowRight",comment:"Label for arrow right key in shortcuts.",message:"Arrow Right"},ARROW_UP_KEY:{id:"keyboard.shortcut.arrowUp",comment:"Label for arrow up key in shortcuts.",message:"Arrow Up"},ARROW_DOWN_KEY:{id:"keyboard.shortcut.arrowDown",comment:"Label for arrowDown key in shortcuts.",message:"Arrow Down"}}),extensionBlockquoteMessages=Object.freeze({__proto__:null,LABEL:{id:"extension.command.toggle-blockquote.label",comment:"Label for blockquote formatting command.",message:"Blockquote"},DESCRIPTION:{id:"extension.command.toggle-blockquote.description",comment:"Description for blockquote formatting command.",message:"Add blockquote formatting to the selected text"}}),extensionBoldMessages=Object.freeze({__proto__:null,LABEL:{id:"extension.command.toggle-bold.label",comment:"Label for bold formatting command.",message:"Bold"},DESCRIPTION:{id:"extension.command.toggle-bold.description",comment:"Description for bold formatting command.",message:"Add bold formatting to the selected text"}}),extensionCodeBlockMessages=Object.freeze({__proto__:null,LABEL:{id:"extension.command.toggle-code-block.label",comment:"Label for the code block command.",message:"Codeblock"},DESCRIPTION:{id:"extension.command.toggle-code-block.description",comment:"Description for the code block command.",message:"Add a code block"}}),extensionCodeMessages=Object.freeze({__proto__:null,LABEL:{id:"extension.command.toggle-code.label",comment:"Label for the inline code formatting.",message:"Code"},DESCRIPTION:{id:"extension.command.toggle-code.description",comment:"Description for the inline code formatting command.",message:"Add inline code formatting to the selected text"}}),extensionColumnsMessages=Object.freeze({__proto__:null,LABEL:{id:"extension.command.toggle-columns.label",comment:"Label for columns command with support for number of columns counts.",message:"{count, select, 2 {Two Column Block}\n3 {Three Column Block}\n4 {Four Column Block}\nother {Multi Column Block}}"},DESCRIPTION:{id:"extension.command.toggle-columns.description",comment:"Description of the columns command with support for number of columns counts.",message:"{count, select, 2 {Split the block into two columns}\n3 {Split the current block into three columns}\n4 {Split the current block into four columns}\nother {Split the current block into multiple columns}}"}}),extensionHeadingMessages=Object.freeze({__proto__:null,LABEL:{id:"extension.command.toggle-heading.label",comment:"Label for heading command with support for levels.",message:"{level, select, 1 {Heading 1}\n2 {Heading 2}\n3 {Heading 3}\n4 {Heading 4}\n5 {Heading 5}\n6 {Heading 6}\nother {Heading}}"}}),extensionHistoryMessages=Object.freeze({__proto__:null,UNDO_LABEL:{id:"extension.command.undo.label",comment:"Label for undo.",message:"Undo"},UNDO_DESCRIPTION:{id:"extension.command.undo.description",comment:"Description for undo.",message:"Undo the most recent action"},REDO_LABEL:{id:"extension.command.redo.label",comment:"Label for redo.",message:"Redo"},REDO_DESCRIPTION:{id:"extension.command.redo.description",comment:"Description for redo.",message:"Redo the most recent action"}}),extensionHorizontalRuleMessages=Object.freeze({__proto__:null,LABEL:{id:"extension.command.insert-horizontal-rule.label",comment:"Label for inserting a horizontal rule (divider) command.",message:"Divider"},DESCRIPTION:{id:"extension.command.insert-horizontal-rule.description",comment:"Description for inserting a horizontal rule (divider) command.",message:"Separate content with a diving horizontal line"}}),extensionItalicMessages=Object.freeze({__proto__:null,LABEL:{id:"extension.command.toggle-italic.label",comment:"Label for italic formatting command.",message:"Italic"},DESCRIPTION:{id:"extension.command.toggle-italic.description",comment:"Description for italic formatting command.",message:"Italicize the selected text"}}),extensionListMessages=Object.freeze({__proto__:null,ORDERED_LIST_LABEL:{id:"extension.command.toggle-ordered-list.label",comment:"Label for inserting an ordered list into the editor.",message:"Ordered list"},BULLET_LIST_LABEL:{id:"extension.command.toggle-bullet-list.description",comment:"Description for inserting a bullet list into the editor.",message:"Bulleted list"},TASK_LIST_LABEL:{id:"extension.command.toggle-task-list.description",comment:"Description for inserting a task list into the editor.",message:"Tasked list"}}),extensionParagraphMessages=Object.freeze({__proto__:null,INSERT_LABEL:{id:"extension.command.insert-paragraph.label",comment:"Label for inserting a paragraph.",message:"Insert Paragraph"},INSERT_DESCRIPTION:{id:"extension.command.insert-paragraph.description",comment:"Description for inserting a paragraph.",message:"Insert a new paragraph"},CONVERT_LABEL:{id:"extension.command.convert-paragraph.label",comment:"Label for converting the current node into a paragraph.",message:"Convert Paragraph"},CONVERT_DESCRIPTION:{id:"extension.command.convert-paragraph.description",comment:"Description for converting a paragraph.",message:"Convert current block into a paragraph block."}}),extensionStrikeMessages=Object.freeze({__proto__:null,LABEL:{id:"extension.command.toggle-strike.label",comment:"Label for strike formatting command.",message:"Strikethrough"},DESCRIPTION:{id:"extension.command.toggle-strike.description",comment:"Description for strike formatting command.",message:"Strikethrough the selected text"}}),extensionTablesMessages=Object.freeze({__proto__:null,CREATE_COMMAND_LABEL:{id:"extension.command.create-table.label",comment:"Label for creating a table",message:"Create table"},CREATE_COMMAND_DESCRIPTION:{id:"extension.command.create-table.description",comment:"Description for creating a table",message:"Create a table with set number of rows and columns."},COLUMN_COUNT:{id:"extension.table.column_count",comment:"The number of columns",message:"{count, plural, one {# column} other {# columns}}"},ROW_COUNT:{id:"extension.table.row_count",comment:"The number of rows",message:"{count, plural, one {# row} other {# rows}}"}}),extensionUnderlineMessages=Object.freeze({__proto__:null,LABEL:{id:"extension.command.toggle-underline.label",comment:"Label for underline formatting command.",message:"Underline"},DESCRIPTION:{id:"extension.command.toggle-underline.description",comment:"Description for underline formatting command.",message:"Underline the selected text"}}),reactComponentsMessages=Object.freeze({__proto__:null,NO_ITEMS_AVAILABLE:{id:"react-components.mention-atom-component.zero-items",comment:"Shown when no popup items are available",message:"No items available"}})},39714:function(module){var isMergeableObject=function(value){var stringValue;return!!value&&"object"==typeof value&&"[object RegExp]"!==(stringValue=Object.prototype.toString.call(value))&&"[object Date]"!==stringValue&&value.$$typeof!==REACT_ELEMENT_TYPE},REACT_ELEMENT_TYPE="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function cloneUnlessOtherwiseSpecified(value,options){return!1!==options.clone&&options.isMergeableObject(value)?deepmerge(Array.isArray(value)?[]:{},value,options):value}function defaultArrayMerge(target,source,options){return target.concat(source).map(function(element){return cloneUnlessOtherwiseSpecified(element,options)})}function getKeys(target){return Object.keys(target).concat(Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(target).filter(function(symbol){return Object.propertyIsEnumerable.call(target,symbol)}):[])}function propertyIsOnObject(object,property){try{return property in object}catch(_){return!1}}function deepmerge(target,source,options){(options=options||{}).arrayMerge=options.arrayMerge||defaultArrayMerge,options.isMergeableObject=options.isMergeableObject||isMergeableObject,options.cloneUnlessOtherwiseSpecified=cloneUnlessOtherwiseSpecified;var options1,destination,sourceIsArray=Array.isArray(source);return sourceIsArray!==Array.isArray(target)?cloneUnlessOtherwiseSpecified(source,options):sourceIsArray?options.arrayMerge(target,source,options):(destination={},(options1=options).isMergeableObject(target)&&getKeys(target).forEach(function(key){destination[key]=cloneUnlessOtherwiseSpecified(target[key],options1)}),getKeys(source).forEach(function(key){(!propertyIsOnObject(target,key)||Object.hasOwnProperty.call(target,key)&&Object.propertyIsEnumerable.call(target,key))&&(propertyIsOnObject(target,key)&&options1.isMergeableObject(source[key])?destination[key]=(function(key,options){if(!options.customMerge)return deepmerge;var customMerge=options.customMerge(key);return"function"==typeof customMerge?customMerge:deepmerge})(key,options1)(target[key],source[key],options1):destination[key]=cloneUnlessOtherwiseSpecified(source[key],options1))}),destination)}deepmerge.all=function(array,options){if(!Array.isArray(array))throw Error("first argument should be an array");return array.reduce(function(prev,next){return deepmerge(prev,next,options)},{})},module.exports=deepmerge},69378:function(module){module.exports=function equal(a,b){if(a===b)return!0;if(a&&b&&"object"==typeof a&&"object"==typeof b){if(a.constructor!==b.constructor)return!1;if(Array.isArray(a)){if((length=a.length)!=b.length)return!1;for(i=length;0!=i--;)if(!equal(a[i],b[i]))return!1;return!0}if(a.constructor===RegExp)return a.source===b.source&&a.flags===b.flags;if(a.valueOf!==Object.prototype.valueOf)return a.valueOf()===b.valueOf();if(a.toString!==Object.prototype.toString)return a.toString()===b.toString();if((length=(keys=Object.keys(a)).length)!==Object.keys(b).length)return!1;for(i=length;0!=i--;)if(!Object.prototype.hasOwnProperty.call(b,keys[i]))return!1;for(i=length;0!=i--;){var length,i,keys,key=keys[i];if(!equal(a[key],b[key]))return!1}return!0}return a!=a&&b!=b}},22777:function(module,__unused_webpack_exports,__webpack_require__){/*!
 * is-extendable <https://github.com/jonschlinkert/is-extendable>
 *
 * Copyright (c) 2015-2017, Jon Schlinkert.
 * Released under the MIT License.
 */ var isPlainObject=__webpack_require__(49983);module.exports=function(val){return isPlainObject(val)||"function"==typeof val||Array.isArray(val)}},49983:function(module,__unused_webpack_exports,__webpack_require__){/*!
 * is-plain-object <https://github.com/jonschlinkert/is-plain-object>
 *
 * Copyright (c) 2014-2017, Jon Schlinkert.
 * Released under the MIT License.
 */ var isObject=__webpack_require__(98558);function isObjectObject(o){return!0===isObject(o)&&"[object Object]"===Object.prototype.toString.call(o)}module.exports=function(o){var ctor,prot;return!1!==isObjectObject(o)&&"function"==typeof(ctor=o.constructor)&&!1!==isObjectObject(prot=ctor.prototype)&&!1!==prot.hasOwnProperty("isPrototypeOf")}},98558:function(module){/*!
 * isobject <https://github.com/jonschlinkert/isobject>
 *
 * Copyright (c) 2014-2017, Jon Schlinkert.
 * Released under the MIT License.
 */ module.exports=function(val){return null!=val&&"object"==typeof val&&!1===Array.isArray(val)}},85598:function(module,exports){var construct="undefined"!=typeof Reflect?Reflect.construct:void 0,defineProperty=Object.defineProperty,captureStackTrace=Error.captureStackTrace;function BaseError(message){void 0!==message&&defineProperty(this,"message",{configurable:!0,value:message,writable:!0});var cname=this.constructor.name;void 0!==cname&&cname!==this.name&&defineProperty(this,"name",{configurable:!0,value:cname,writable:!0}),captureStackTrace(this,this.constructor)}void 0===captureStackTrace&&(captureStackTrace=function(error){var container=Error();defineProperty(error,"stack",{configurable:!0,get:function(){var stack=container.stack;return defineProperty(this,"stack",{configurable:!0,value:stack,writable:!0}),stack},set:function(stack){defineProperty(error,"stack",{configurable:!0,value:stack,writable:!0})}})}),BaseError.prototype=Object.create(Error.prototype,{constructor:{configurable:!0,value:BaseError,writable:!0}});var setFunctionName=function(){function setFunctionName(fn,name){return defineProperty(fn,"name",{configurable:!0,value:name})}try{var f=function(){};if(setFunctionName(f,"foo"),"foo"===f.name)return setFunctionName}catch(_){}}();(module.exports=function(constructor,super_){if(null==super_||super_===Error)super_=BaseError;else if("function"!=typeof super_)throw TypeError("super_ should be a function");if("string"==typeof constructor)name=constructor,constructor=void 0!==construct?function(){return construct(super_,arguments,this.constructor)}:function(){super_.apply(this,arguments)},void 0!==setFunctionName&&(setFunctionName(constructor,name),name=void 0);else if("function"!=typeof constructor)throw TypeError("constructor should be either a string or a function");constructor.super_=constructor.super=super_;var name,properties={constructor:{configurable:!0,value:constructor,writable:!0}};return void 0!==name&&(properties.name={configurable:!0,value:name,writable:!0}),constructor.prototype=Object.create(super_.prototype,properties),constructor}).BaseError=BaseError},13e3:function(module,__unused_webpack_exports,__webpack_require__){/*!
 * object.omit <https://github.com/jonschlinkert/object.omit>
 *
 * Copyright (c) 2014-2017, Jon Schlinkert.
 * Released under the MIT License.
 */ var isObject=__webpack_require__(22777);module.exports=function(obj,props,fn){if(!isObject(obj))return{};"function"==typeof props&&(fn=props,props=[]),"string"==typeof props&&(props=[props]);for(var isFunction="function"==typeof fn,keys=Object.keys(obj),res={},i=0;i<keys.length;i++){var key=keys[i],val=obj[key];(!props||-1===props.indexOf(key)&&(!isFunction||fn(val,key,obj)))&&(res[key]=val)}return res}},86883:function(module,__unused_webpack_exports,__webpack_require__){/*!
 * object.pick <https://github.com/jonschlinkert/object.pick>
 *
 * Copyright (c) 2014-2015 Jon Schlinkert, contributors.
 * Licensed under the MIT License
 */ var isObject=__webpack_require__(98558);module.exports=function(obj,keys){if(!isObject(obj)&&"function"!=typeof obj)return{};var res={};if("string"==typeof keys)return keys in obj&&(res[keys]=obj[keys]),res;for(var len=keys.length,idx=-1;++idx<len;){var key=keys[idx];key in obj&&(res[key]=obj[key])}return res}},81553:function(module){function parse(str,opts){if("string"!=typeof str)return[str];var res=[str];"string"==typeof opts||Array.isArray(opts)?opts={brackets:opts}:opts||(opts={});var brackets=opts.brackets?Array.isArray(opts.brackets)?opts.brackets:[opts.brackets]:["{}","[]","()"],escape=opts.escape||"___",flat=!!opts.flat;brackets.forEach(function(bracket){var pRE=RegExp(["\\",bracket[0],"[^\\",bracket[0],"\\",bracket[1],"]*\\",bracket[1]].join("")),ids=[];function replaceToken(token,idx,str){var refId=res.push(token.slice(bracket[0].length,-bracket[1].length))-1;return ids.push(refId),escape+refId+escape}res.forEach(function(str,i){for(var prevStr,a=0;str!=prevStr;)if(prevStr=str,str=str.replace(pRE,replaceToken),a++>1e4)throw Error("References have circular dependency. Please, check them.");res[i]=str}),ids=ids.reverse(),res=res.map(function(str){return ids.forEach(function(id){str=str.replace(RegExp("(\\"+escape+id+"\\"+escape+")","g"),bracket[0]+"$1"+bracket[1])}),str})});var re=RegExp("\\"+escape+"([0-9]+)\\"+escape);return flat?res:function nest(str,refs,escape){for(var match,res=[],a=0;match=re.exec(str);){if(a++>1e4)throw Error("Circular references in parenthesis");res.push(str.slice(0,match.index)),res.push(nest(refs[match[1]],refs)),str=str.slice(match.index+match[0].length)}return res.push(str),res}(res[0],res)}function stringify(arg,opts){if(opts&&opts.flat){var prevStr,escape=opts&&opts.escape||"___",str=arg[0];if(!str)return"";for(var re=RegExp("\\"+escape+"([0-9]+)\\"+escape),a=0;str!=prevStr;){if(a++>1e4)throw Error("Circular references in "+arg);prevStr=str,str=str.replace(re,replaceRef)}return str}return arg.reduce(function f(prev,curr){return Array.isArray(curr)&&(curr=curr.reduce(f,"")),prev+curr},"");function replaceRef(match,idx){if(null==arg[idx])throw Error("Reference "+idx+"is undefined");return arg[idx]}}function parenthesis(arg,opts){return Array.isArray(arg)?stringify(arg,opts):parse(arg,opts)}parenthesis.parse=parse,parenthesis.stringify=stringify,module.exports=parenthesis},85734:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{Hw:function(){return inputRules},S0:function(){return wrappingInputRule},VK:function(){return InputRule},dU:function(){return undoInputRule},zK:function(){return textblockTypeInputRule}});var prosemirror_state__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(39451),prosemirror_transform__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(21692);class InputRule{constructor(match,handler){this.match=match,this.match=match,this.handler="string"==typeof handler?function(state,match,start,end){let insert=handler;if(match[1]){let offset=match[0].lastIndexOf(match[1]);insert+=match[0].slice(offset+match[1].length);let cutOff=(start+=offset)-end;cutOff>0&&(insert=match[0].slice(offset-cutOff,offset)+insert,start=end)}return state.tr.insertText(insert,start,end)}:handler}}function inputRules({rules}){let plugin=new prosemirror_state__WEBPACK_IMPORTED_MODULE_0__.Sy({state:{init:()=>null,apply(tr,prev){return tr.getMeta(this)||(tr.selectionSet||tr.docChanged?null:prev)}},props:{handleTextInput:(view,from,to,text)=>run(view,from,to,text,rules,plugin),handleDOMEvents:{compositionend(view){setTimeout(()=>{let{$cursor}=view.state.selection;$cursor&&run(view,$cursor.pos,$cursor.pos,"",rules,plugin)})}}},isInputRules:!0});return plugin}function run(view,from,to,text,rules,plugin){if(view.composing)return!1;let state=view.state,$from=state.doc.resolve(from);if($from.parent.type.spec.code)return!1;let textBefore=$from.parent.textBetween(Math.max(0,$from.parentOffset-500),$from.parentOffset,null,"￼")+text;for(let i=0;i<rules.length;i++){let match=rules[i].match.exec(textBefore),tr=match&&rules[i].handler(state,match,from-(match[0].length-text.length),to);if(tr)return view.dispatch(tr.setMeta(plugin,{transform:tr,from,to,text})),!0}return!1}let undoInputRule=(state,dispatch)=>{let plugins=state.plugins;for(let i=0;i<plugins.length;i++){let plugin=plugins[i],undoable;if(plugin.spec.isInputRules&&(undoable=plugin.getState(state))){if(dispatch){let tr=state.tr,toUndo=undoable.transform;for(let j=toUndo.steps.length-1;j>=0;j--)tr.step(toUndo.steps[j].invert(toUndo.docs[j]));if(undoable.text){let marks=tr.doc.resolve(undoable.from).marks();tr.replaceWith(undoable.from,undoable.to,state.schema.text(undoable.text,marks))}else tr.delete(undoable.from,undoable.to);dispatch(tr)}return!0}}return!1};function wrappingInputRule(regexp,nodeType,getAttrs=null,joinPredicate){return new InputRule(regexp,(state,match,start,end)=>{let attrs=getAttrs instanceof Function?getAttrs(match):getAttrs,tr=state.tr.delete(start,end),range=tr.doc.resolve(start).blockRange(),wrapping=range&&(0,prosemirror_transform__WEBPACK_IMPORTED_MODULE_1__.nd)(range,nodeType,attrs);if(!wrapping)return null;tr.wrap(range,wrapping);let before=tr.doc.resolve(start-1).nodeBefore;return before&&before.type==nodeType&&(0,prosemirror_transform__WEBPACK_IMPORTED_MODULE_1__.Mn)(tr.doc,start-1)&&(!joinPredicate||joinPredicate(match,before))&&tr.join(start-1),tr})}function textblockTypeInputRule(regexp,nodeType,getAttrs=null){return new InputRule(regexp,(state,match,start,end)=>{let $start=state.doc.resolve(start),attrs=getAttrs instanceof Function?getAttrs(match):getAttrs;return $start.node(-1).canReplaceWith($start.index(-1),$start.indexAfter(-1),nodeType)?state.tr.delete(start,end).setBlockType(start,start,nodeType,attrs):null})}new InputRule(/--$/,"—"),new InputRule(/\.\.\.$/,"…"),new InputRule(/(?:^|[\s\{\[\(\<'"\u2018\u201C])(")$/,"“"),new InputRule(/"$/,"”"),new InputRule(/(?:^|[\s\{\[\(\<'"\u2018\u201C])(')$/,"‘"),new InputRule(/'$/,"’")},57981:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){function OrderedMap(content){this.content=content}__webpack_require__.d(__webpack_exports__,{aw:function(){return DOMParser},PW:function(){return DOMSerializer},HY:function(){return Fragment},vc:function(){return Mark},ZU:function(){return MarkType},NB:function(){return Node},Ts:function(){return NodeRange},Jq:function(){return NodeType},e4:function(){return ReplaceError},ZQ:function(){return ResolvedPos},V_:function(){return Schema},p2:function(){return Slice}}),OrderedMap.prototype={constructor:OrderedMap,find:function(key){for(var i=0;i<this.content.length;i+=2)if(this.content[i]===key)return i;return -1},get:function(key){var found=this.find(key);return -1==found?void 0:this.content[found+1]},update:function(key,value,newKey){var self1=newKey&&newKey!=key?this.remove(newKey):this,found=self1.find(key),content=self1.content.slice();return -1==found?content.push(newKey||key,value):(content[found+1]=value,newKey&&(content[found]=newKey)),new OrderedMap(content)},remove:function(key){var found=this.find(key);if(-1==found)return this;var content=this.content.slice();return content.splice(found,2),new OrderedMap(content)},addToStart:function(key,value){return new OrderedMap([key,value].concat(this.remove(key).content))},addToEnd:function(key,value){var content=this.remove(key).content.slice();return content.push(key,value),new OrderedMap(content)},addBefore:function(place,key,value){var without=this.remove(key),content=without.content.slice(),found=without.find(place);return content.splice(-1==found?content.length:found,0,key,value),new OrderedMap(content)},forEach:function(f){for(var i=0;i<this.content.length;i+=2)f(this.content[i],this.content[i+1])},prepend:function(map){return(map=OrderedMap.from(map)).size?new OrderedMap(map.content.concat(this.subtract(map).content)):this},append:function(map){return(map=OrderedMap.from(map)).size?new OrderedMap(this.subtract(map).content.concat(map.content)):this},subtract:function(map){var result=this;map=OrderedMap.from(map);for(var i=0;i<map.content.length;i+=2)result=result.remove(map.content[i]);return result},toObject:function(){var result={};return this.forEach(function(key,value){result[key]=value}),result},get size(){return this.content.length>>1}},OrderedMap.from=function(value){if(value instanceof OrderedMap)return value;var content=[];if(value)for(var prop in value)content.push(prop,value[prop]);return new OrderedMap(content)};class Fragment{constructor(content,size){if(this.content=content,this.size=size||0,null==size)for(let i=0;i<content.length;i++)this.size+=content[i].nodeSize}nodesBetween(from,to,f,nodeStart=0,parent){for(let i=0,pos=0;pos<to;i++){let child=this.content[i],end=pos+child.nodeSize;if(end>from&&!1!==f(child,nodeStart+pos,parent||null,i)&&child.content.size){let start=pos+1;child.nodesBetween(Math.max(0,from-start),Math.min(child.content.size,to-start),f,nodeStart+start)}pos=end}}descendants(f){this.nodesBetween(0,this.size,f)}textBetween(from,to,blockSeparator,leafText){let text="",separated=!0;return this.nodesBetween(from,to,(node,pos)=>{node.isText?(text+=node.text.slice(Math.max(from,pos)-pos,to-pos),separated=!blockSeparator):node.isLeaf?(leafText?text+="function"==typeof leafText?leafText(node):leafText:node.type.spec.leafText&&(text+=node.type.spec.leafText(node)),separated=!blockSeparator):!separated&&node.isBlock&&(text+=blockSeparator,separated=!0)},0),text}append(other){if(!other.size)return this;if(!this.size)return other;let last=this.lastChild,first=other.firstChild,content=this.content.slice(),i=0;for(last.isText&&last.sameMarkup(first)&&(content[content.length-1]=last.withText(last.text+first.text),i=1);i<other.content.length;i++)content.push(other.content[i]);return new Fragment(content,this.size+other.size)}cut(from,to=this.size){if(0==from&&to==this.size)return this;let result=[],size=0;if(to>from)for(let i=0,pos=0;pos<to;i++){let child=this.content[i],end=pos+child.nodeSize;end>from&&((pos<from||end>to)&&(child=child.isText?child.cut(Math.max(0,from-pos),Math.min(child.text.length,to-pos)):child.cut(Math.max(0,from-pos-1),Math.min(child.content.size,to-pos-1))),result.push(child),size+=child.nodeSize),pos=end}return new Fragment(result,size)}cutByIndex(from,to){return from==to?Fragment.empty:0==from&&to==this.content.length?this:new Fragment(this.content.slice(from,to))}replaceChild(index,node){let current=this.content[index];if(current==node)return this;let copy=this.content.slice(),size=this.size+node.nodeSize-current.nodeSize;return copy[index]=node,new Fragment(copy,size)}addToStart(node){return new Fragment([node].concat(this.content),this.size+node.nodeSize)}addToEnd(node){return new Fragment(this.content.concat(node),this.size+node.nodeSize)}eq(other){if(this.content.length!=other.content.length)return!1;for(let i=0;i<this.content.length;i++)if(!this.content[i].eq(other.content[i]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(index){let found=this.content[index];if(!found)throw RangeError("Index "+index+" out of range for "+this);return found}maybeChild(index){return this.content[index]||null}forEach(f){for(let i=0,p=0;i<this.content.length;i++){let child=this.content[i];f(child,p,i),p+=child.nodeSize}}findDiffStart(other,pos=0){return function findDiffStart(a,b,pos){for(let i=0;;i++){if(i==a.childCount||i==b.childCount)return a.childCount==b.childCount?null:pos;let childA=a.child(i),childB=b.child(i);if(childA==childB){pos+=childA.nodeSize;continue}if(!childA.sameMarkup(childB))return pos;if(childA.isText&&childA.text!=childB.text){for(let j=0;childA.text[j]==childB.text[j];j++)pos++;return pos}if(childA.content.size||childB.content.size){let inner=findDiffStart(childA.content,childB.content,pos+1);if(null!=inner)return inner}pos+=childA.nodeSize}}(this,other,pos)}findDiffEnd(other,pos=this.size,otherPos=other.size){return function findDiffEnd(a,b,posA,posB){for(let iA=a.childCount,iB=b.childCount;;){if(0==iA||0==iB)return iA==iB?null:{a:posA,b:posB};let childA=a.child(--iA),childB=b.child(--iB),size=childA.nodeSize;if(childA==childB){posA-=size,posB-=size;continue}if(!childA.sameMarkup(childB))return{a:posA,b:posB};if(childA.isText&&childA.text!=childB.text){let same=0,minSize=Math.min(childA.text.length,childB.text.length);for(;same<minSize&&childA.text[childA.text.length-same-1]==childB.text[childB.text.length-same-1];)same++,posA--,posB--;return{a:posA,b:posB}}if(childA.content.size||childB.content.size){let inner=findDiffEnd(childA.content,childB.content,posA-1,posB-1);if(inner)return inner}posA-=size,posB-=size}}(this,other,pos,otherPos)}findIndex(pos,round=-1){if(0==pos)return retIndex(0,pos);if(pos==this.size)return retIndex(this.content.length,pos);if(pos>this.size||pos<0)throw RangeError(`Position ${pos} outside of fragment (${this})`);for(let i=0,curPos=0;;i++){let end=curPos+this.child(i).nodeSize;if(end>=pos){if(end==pos||round>0)return retIndex(i+1,end);return retIndex(i,curPos)}curPos=end}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(n=>n.toJSON()):null}static fromJSON(schema,value){if(!value)return Fragment.empty;if(!Array.isArray(value))throw RangeError("Invalid input for Fragment.fromJSON");return new Fragment(value.map(schema.nodeFromJSON))}static fromArray(array){if(!array.length)return Fragment.empty;let joined,size=0;for(let i=0;i<array.length;i++){let node=array[i];size+=node.nodeSize,i&&node.isText&&array[i-1].sameMarkup(node)?(joined||(joined=array.slice(0,i)),joined[joined.length-1]=node.withText(joined[joined.length-1].text+node.text)):joined&&joined.push(node)}return new Fragment(joined||array,size)}static from(nodes){if(!nodes)return Fragment.empty;if(nodes instanceof Fragment)return nodes;if(Array.isArray(nodes))return this.fromArray(nodes);if(nodes.attrs)return new Fragment([nodes],nodes.nodeSize);throw RangeError("Can not convert "+nodes+" to a Fragment"+(nodes.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}Fragment.empty=new Fragment([],0);let found={index:0,offset:0};function retIndex(index,offset){return found.index=index,found.offset=offset,found}function compareDeep(a,b){if(a===b)return!0;if(!(a&&"object"==typeof a)||!(b&&"object"==typeof b))return!1;let array=Array.isArray(a);if(Array.isArray(b)!=array)return!1;if(array){if(a.length!=b.length)return!1;for(let i=0;i<a.length;i++)if(!compareDeep(a[i],b[i]))return!1}else{for(let p in a)if(!(p in b)||!compareDeep(a[p],b[p]))return!1;for(let p1 in b)if(!(p1 in a))return!1}return!0}class Mark{constructor(type,attrs){this.type=type,this.attrs=attrs}addToSet(set){let copy,placed=!1;for(let i=0;i<set.length;i++){let other=set[i];if(this.eq(other))return set;if(this.type.excludes(other.type))copy||(copy=set.slice(0,i));else{if(other.type.excludes(this.type))return set;!placed&&other.type.rank>this.type.rank&&(copy||(copy=set.slice(0,i)),copy.push(this),placed=!0),copy&&copy.push(other)}}return copy||(copy=set.slice()),placed||copy.push(this),copy}removeFromSet(set){for(let i=0;i<set.length;i++)if(this.eq(set[i]))return set.slice(0,i).concat(set.slice(i+1));return set}isInSet(set){for(let i=0;i<set.length;i++)if(this.eq(set[i]))return!0;return!1}eq(other){return this==other||this.type==other.type&&compareDeep(this.attrs,other.attrs)}toJSON(){let obj={type:this.type.name};for(let _ in this.attrs){obj.attrs=this.attrs;break}return obj}static fromJSON(schema,json){if(!json)throw RangeError("Invalid input for Mark.fromJSON");let type=schema.marks[json.type];if(!type)throw RangeError(`There is no mark type ${json.type} in this schema`);return type.create(json.attrs)}static sameSet(a,b){if(a==b)return!0;if(a.length!=b.length)return!1;for(let i=0;i<a.length;i++)if(!a[i].eq(b[i]))return!1;return!0}static setFrom(marks){if(!marks||Array.isArray(marks)&&0==marks.length)return Mark.none;if(marks instanceof Mark)return[marks];let copy=marks.slice();return copy.sort((a,b)=>a.type.rank-b.type.rank),copy}}Mark.none=[];class ReplaceError extends Error{}class Slice{constructor(content,openStart,openEnd){this.content=content,this.openStart=openStart,this.openEnd=openEnd}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(pos,fragment){let content=function insertInto(content,dist,insert,parent){let{index,offset}=content.findIndex(dist),child=content.maybeChild(index);if(offset==dist||child.isText)return parent&&!parent.canReplace(index,index,insert)?null:content.cut(0,dist).append(insert).append(content.cut(dist));let inner=insertInto(child.content,dist-offset-1,insert);return inner&&content.replaceChild(index,child.copy(inner))}(this.content,pos+this.openStart,fragment);return content&&new Slice(content,this.openStart,this.openEnd)}removeBetween(from,to){return new Slice(function removeRange(content,from,to){let{index,offset}=content.findIndex(from),child=content.maybeChild(index),{index:indexTo,offset:offsetTo}=content.findIndex(to);if(offset==from||child.isText){if(offsetTo!=to&&!content.child(indexTo).isText)throw RangeError("Removing non-flat range");return content.cut(0,from).append(content.cut(to))}if(index!=indexTo)throw RangeError("Removing non-flat range");return content.replaceChild(index,child.copy(removeRange(child.content,from-offset-1,to-offset-1)))}(this.content,from+this.openStart,to+this.openStart),this.openStart,this.openEnd)}eq(other){return this.content.eq(other.content)&&this.openStart==other.openStart&&this.openEnd==other.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let json={content:this.content.toJSON()};return this.openStart>0&&(json.openStart=this.openStart),this.openEnd>0&&(json.openEnd=this.openEnd),json}static fromJSON(schema,json){if(!json)return Slice.empty;let openStart=json.openStart||0,openEnd=json.openEnd||0;if("number"!=typeof openStart||"number"!=typeof openEnd)throw RangeError("Invalid input for Slice.fromJSON");return new Slice(Fragment.fromJSON(schema,json.content),openStart,openEnd)}static maxOpen(fragment,openIsolating=!0){let openStart=0,openEnd=0;for(let n=fragment.firstChild;n&&!n.isLeaf&&(openIsolating||!n.type.spec.isolating);n=n.firstChild)openStart++;for(let n1=fragment.lastChild;n1&&!n1.isLeaf&&(openIsolating||!n1.type.spec.isolating);n1=n1.lastChild)openEnd++;return new Slice(fragment,openStart,openEnd)}}function checkJoin(main,sub){if(!sub.type.compatibleContent(main.type))throw new ReplaceError("Cannot join "+sub.type.name+" onto "+main.type.name)}function joinable($before,$after,depth){let node=$before.node(depth);return checkJoin(node,$after.node(depth)),node}function addNode(child,target){let last=target.length-1;last>=0&&child.isText&&child.sameMarkup(target[last])?target[last]=child.withText(target[last].text+child.text):target.push(child)}function addRange($start,$end,depth,target){let node=($end||$start).node(depth),startIndex=0,endIndex=$end?$end.index(depth):node.childCount;$start&&(startIndex=$start.index(depth),$start.depth>depth?startIndex++:$start.textOffset&&(addNode($start.nodeAfter,target),startIndex++));for(let i=startIndex;i<endIndex;i++)addNode(node.child(i),target);$end&&$end.depth==depth&&$end.textOffset&&addNode($end.nodeBefore,target)}function dist_close(node,content){return node.type.checkContent(content),node.copy(content)}function replaceTwoWay($from,$to,depth){let content=[];return addRange(null,$from,depth,content),$from.depth>depth&&addNode(dist_close(joinable($from,$to,depth+1),replaceTwoWay($from,$to,depth+1)),content),addRange($to,null,depth,content),new Fragment(content)}Slice.empty=new Slice(Fragment.empty,0,0);class ResolvedPos{constructor(pos,path,parentOffset){this.pos=pos,this.path=path,this.parentOffset=parentOffset,this.depth=path.length/3-1}resolveDepth(val){return null==val?this.depth:val<0?this.depth+val:val}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(depth){return this.path[3*this.resolveDepth(depth)]}index(depth){return this.path[3*this.resolveDepth(depth)+1]}indexAfter(depth){return depth=this.resolveDepth(depth),this.index(depth)+(depth!=this.depth||this.textOffset?1:0)}start(depth){return 0==(depth=this.resolveDepth(depth))?0:this.path[3*depth-1]+1}end(depth){return depth=this.resolveDepth(depth),this.start(depth)+this.node(depth).content.size}before(depth){if(!(depth=this.resolveDepth(depth)))throw RangeError("There is no position before the top-level node");return depth==this.depth+1?this.pos:this.path[3*depth-1]}after(depth){if(!(depth=this.resolveDepth(depth)))throw RangeError("There is no position after the top-level node");return depth==this.depth+1?this.pos:this.path[3*depth-1]+this.path[3*depth].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let parent=this.parent,index=this.index(this.depth);if(index==parent.childCount)return null;let dOff=this.pos-this.path[this.path.length-1],child=parent.child(index);return dOff?parent.child(index).cut(dOff):child}get nodeBefore(){let index=this.index(this.depth),dOff=this.pos-this.path[this.path.length-1];return dOff?this.parent.child(index).cut(0,dOff):0==index?null:this.parent.child(index-1)}posAtIndex(index,depth){depth=this.resolveDepth(depth);let node=this.path[3*depth],pos=0==depth?0:this.path[3*depth-1]+1;for(let i=0;i<index;i++)pos+=node.child(i).nodeSize;return pos}marks(){let parent=this.parent,index=this.index();if(0==parent.content.size)return Mark.none;if(this.textOffset)return parent.child(index).marks;let main=parent.maybeChild(index-1),other=parent.maybeChild(index);if(!main){let tmp=main;main=other,other=tmp}let marks=main.marks;for(var i=0;i<marks.length;i++)!1!==marks[i].type.spec.inclusive||other&&marks[i].isInSet(other.marks)||(marks=marks[i--].removeFromSet(marks));return marks}marksAcross($end){let after=this.parent.maybeChild(this.index());if(!after||!after.isInline)return null;let marks=after.marks,next=$end.parent.maybeChild($end.index());for(var i=0;i<marks.length;i++)!1!==marks[i].type.spec.inclusive||next&&marks[i].isInSet(next.marks)||(marks=marks[i--].removeFromSet(marks));return marks}sharedDepth(pos){for(let depth=this.depth;depth>0;depth--)if(this.start(depth)<=pos&&this.end(depth)>=pos)return depth;return 0}blockRange(other=this,pred){if(other.pos<this.pos)return other.blockRange(this);for(let d=this.depth-(this.parent.inlineContent||this.pos==other.pos?1:0);d>=0;d--)if(other.pos<=this.end(d)&&(!pred||pred(this.node(d))))return new NodeRange(this,other,d);return null}sameParent(other){return this.pos-this.parentOffset==other.pos-other.parentOffset}max(other){return other.pos>this.pos?other:this}min(other){return other.pos<this.pos?other:this}toString(){let str="";for(let i=1;i<=this.depth;i++)str+=(str?"/":"")+this.node(i).type.name+"_"+this.index(i-1);return str+":"+this.parentOffset}static resolve(doc,pos){if(!(pos>=0&&pos<=doc.content.size))throw RangeError("Position "+pos+" out of range");let path=[],start=0,parentOffset=pos;for(let node=doc;;){let{index,offset}=node.content.findIndex(parentOffset),rem=parentOffset-offset;if(path.push(node,index,start+offset),!rem||(node=node.child(index)).isText)break;parentOffset=rem-1,start+=offset+1}return new ResolvedPos(pos,path,parentOffset)}static resolveCached(doc,pos){for(let i=0;i<resolveCache.length;i++){let cached=resolveCache[i];if(cached.pos==pos&&cached.doc==doc)return cached}let result=resolveCache[resolveCachePos]=ResolvedPos.resolve(doc,pos);return resolveCachePos=(resolveCachePos+1)%resolveCacheSize,result}}let resolveCache=[],resolveCachePos=0,resolveCacheSize=12;class NodeRange{constructor($from,$to,depth){this.$from=$from,this.$to=$to,this.depth=depth}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}let emptyAttrs=Object.create(null);class Node{constructor(type,attrs,content,marks=Mark.none){this.type=type,this.attrs=attrs,this.marks=marks,this.content=content||Fragment.empty}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(index){return this.content.child(index)}maybeChild(index){return this.content.maybeChild(index)}forEach(f){this.content.forEach(f)}nodesBetween(from,to,f,startPos=0){this.content.nodesBetween(from,to,f,startPos,this)}descendants(f){this.nodesBetween(0,this.content.size,f)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(from,to,blockSeparator,leafText){return this.content.textBetween(from,to,blockSeparator,leafText)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(other){return this==other||this.sameMarkup(other)&&this.content.eq(other.content)}sameMarkup(other){return this.hasMarkup(other.type,other.attrs,other.marks)}hasMarkup(type,attrs,marks){return this.type==type&&compareDeep(this.attrs,attrs||type.defaultAttrs||emptyAttrs)&&Mark.sameSet(this.marks,marks||Mark.none)}copy(content=null){return content==this.content?this:new Node(this.type,this.attrs,content,this.marks)}mark(marks){return marks==this.marks?this:new Node(this.type,this.attrs,this.content,marks)}cut(from,to=this.content.size){return 0==from&&to==this.content.size?this:this.copy(this.content.cut(from,to))}slice(from,to=this.content.size,includeParents=!1){if(from==to)return Slice.empty;let $from=this.resolve(from),$to=this.resolve(to),depth=includeParents?0:$from.sharedDepth(to),start=$from.start(depth),content=$from.node(depth).content.cut($from.pos-start,$to.pos-start);return new Slice(content,$from.depth-depth,$to.depth-depth)}replace(from,to,slice){return function($from,$to,slice){if(slice.openStart>$from.depth)throw new ReplaceError("Inserted content deeper than insertion position");if($from.depth-slice.openStart!=$to.depth-slice.openEnd)throw new ReplaceError("Inconsistent open depths");return function replaceOuter($from,$to,slice,depth){let index=$from.index(depth),node=$from.node(depth);if(index==$to.index(depth)&&depth<$from.depth-slice.openStart){let inner=replaceOuter($from,$to,slice,depth+1);return node.copy(node.content.replaceChild(index,inner))}if(!slice.content.size)return dist_close(node,replaceTwoWay($from,$to,depth));if(slice.openStart||slice.openEnd||$from.depth!=depth||$to.depth!=depth){let{start,end}=function(slice,$along){let extra=$along.depth-slice.openStart,node=$along.node(extra).copy(slice.content);for(let i=extra-1;i>=0;i--)node=$along.node(i).copy(Fragment.from(node));return{start:node.resolveNoCache(slice.openStart+extra),end:node.resolveNoCache(node.content.size-slice.openEnd-extra)}}(slice,$from);return dist_close(node,function replaceThreeWay($from,$start,$end,$to,depth){let openStart=$from.depth>depth&&joinable($from,$start,depth+1),openEnd=$to.depth>depth&&joinable($end,$to,depth+1),content=[];return addRange(null,$from,depth,content),openStart&&openEnd&&$start.index(depth)==$end.index(depth)?(checkJoin(openStart,openEnd),addNode(dist_close(openStart,replaceThreeWay($from,$start,$end,$to,depth+1)),content)):(openStart&&addNode(dist_close(openStart,replaceTwoWay($from,$start,depth+1)),content),addRange($start,$end,depth,content),openEnd&&addNode(dist_close(openEnd,replaceTwoWay($end,$to,depth+1)),content)),addRange($to,null,depth,content),new Fragment(content)}($from,start,end,$to,depth))}{let parent=$from.parent,content=parent.content;return dist_close(parent,content.cut(0,$from.parentOffset).append(slice.content).append(content.cut($to.parentOffset)))}}($from,$to,slice,0)}(this.resolve(from),this.resolve(to),slice)}nodeAt(pos){for(let node=this;;){let{index,offset}=node.content.findIndex(pos);if(!(node=node.maybeChild(index)))return null;if(offset==pos||node.isText)return node;pos-=offset+1}}childAfter(pos){let{index,offset}=this.content.findIndex(pos);return{node:this.content.maybeChild(index),index,offset}}childBefore(pos){if(0==pos)return{node:null,index:0,offset:0};let{index,offset}=this.content.findIndex(pos);if(offset<pos)return{node:this.content.child(index),index,offset};let node=this.content.child(index-1);return{node,index:index-1,offset:offset-node.nodeSize}}resolve(pos){return ResolvedPos.resolveCached(this,pos)}resolveNoCache(pos){return ResolvedPos.resolve(this,pos)}rangeHasMark(from,to,type){let found=!1;return to>from&&this.nodesBetween(from,to,node=>(type.isInSet(node.marks)&&(found=!0),!found)),found}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let name=this.type.name;return this.content.size&&(name+="("+this.content.toStringInner()+")"),wrapMarks(this.marks,name)}contentMatchAt(index){let match=this.type.contentMatch.matchFragment(this.content,0,index);if(!match)throw Error("Called contentMatchAt on a node with invalid content");return match}canReplace(from,to,replacement=Fragment.empty,start=0,end=replacement.childCount){let one=this.contentMatchAt(from).matchFragment(replacement,start,end),two=one&&one.matchFragment(this.content,to);if(!two||!two.validEnd)return!1;for(let i=start;i<end;i++)if(!this.type.allowsMarks(replacement.child(i).marks))return!1;return!0}canReplaceWith(from,to,type,marks){if(marks&&!this.type.allowsMarks(marks))return!1;let start=this.contentMatchAt(from).matchType(type),end=start&&start.matchFragment(this.content,to);return!!end&&end.validEnd}canAppend(other){return other.content.size?this.canReplace(this.childCount,this.childCount,other.content):this.type.compatibleContent(other.type)}check(){this.type.checkContent(this.content);let copy=Mark.none;for(let i=0;i<this.marks.length;i++)copy=this.marks[i].addToSet(copy);if(!Mark.sameSet(copy,this.marks))throw RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(m=>m.type.name)}`);this.content.forEach(node=>node.check())}toJSON(){let obj={type:this.type.name};for(let _ in this.attrs){obj.attrs=this.attrs;break}return this.content.size&&(obj.content=this.content.toJSON()),this.marks.length&&(obj.marks=this.marks.map(n=>n.toJSON())),obj}static fromJSON(schema,json){if(!json)throw RangeError("Invalid input for Node.fromJSON");let marks=null;if(json.marks){if(!Array.isArray(json.marks))throw RangeError("Invalid mark data for Node.fromJSON");marks=json.marks.map(schema.markFromJSON)}if("text"==json.type){if("string"!=typeof json.text)throw RangeError("Invalid text node in JSON");return schema.text(json.text,marks)}let content=Fragment.fromJSON(schema,json.content);return schema.nodeType(json.type).create(json.attrs,content,marks)}}Node.prototype.text=void 0;class TextNode extends Node{constructor(type,attrs,content,marks){if(super(type,attrs,null,marks),!content)throw RangeError("Empty text nodes are not allowed");this.text=content}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):wrapMarks(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(from,to){return this.text.slice(from,to)}get nodeSize(){return this.text.length}mark(marks){return marks==this.marks?this:new TextNode(this.type,this.attrs,this.text,marks)}withText(text){return text==this.text?this:new TextNode(this.type,this.attrs,text,this.marks)}cut(from=0,to=this.text.length){return 0==from&&to==this.text.length?this:this.withText(this.text.slice(from,to))}eq(other){return this.sameMarkup(other)&&this.text==other.text}toJSON(){let base=super.toJSON();return base.text=this.text,base}}function wrapMarks(marks,str){for(let i=marks.length-1;i>=0;i--)str=marks[i].type.name+"("+str+")";return str}class ContentMatch{constructor(validEnd){this.validEnd=validEnd,this.next=[],this.wrapCache=[]}static parse(string,nodeTypes){var nfa;let labeled,stream=new TokenStream(string,nodeTypes);if(null==stream.next)return ContentMatch.empty;let expr=function parseExpr(stream){let exprs=[];do exprs.push(function(stream){let exprs=[];do exprs.push(function(stream){let expr=function(stream){if(stream.eat("(")){let expr=parseExpr(stream);return stream.eat(")")||stream.err("Missing closing paren"),expr}if(/\W/.test(stream.next))stream.err("Unexpected token '"+stream.next+"'");else{let exprs=(function(stream,name){let types=stream.nodeTypes,type=types[name];if(type)return[type];let result=[];for(let typeName in types){let type1=types[typeName];type1.groups.indexOf(name)>-1&&result.push(type1)}return 0==result.length&&stream.err("No node type or group '"+name+"' found"),result})(stream,stream.next).map(type=>(null==stream.inline?stream.inline=type.isInline:stream.inline!=type.isInline&&stream.err("Mixing inline and block content"),{type:"name",value:type}));return stream.pos++,1==exprs.length?exprs[0]:{type:"choice",exprs}}}(stream);for(;;)if(stream.eat("+"))expr={type:"plus",expr};else if(stream.eat("*"))expr={type:"star",expr};else if(stream.eat("?"))expr={type:"opt",expr};else if(stream.eat("{"))expr=function(stream,expr){let min=parseNum(stream),max=min;return stream.eat(",")&&(max="}"!=stream.next?parseNum(stream):-1),stream.eat("}")||stream.err("Unclosed braced range"),{type:"range",min,max,expr}}(stream,expr);else break;return expr}(stream));while(stream.next&&")"!=stream.next&&"|"!=stream.next);return 1==exprs.length?exprs[0]:{type:"seq",exprs}}(stream));while(stream.eat("|"));return 1==exprs.length?exprs[0]:{type:"choice",exprs}}(stream);stream.next&&stream.err("Unexpected trailing text");let match=(nfa=function(expr){let nfa=[[]];return connect(function compile(expr,from){if("choice"==expr.type)return expr.exprs.reduce((out,expr)=>out.concat(compile(expr,from)),[]);if("seq"==expr.type)for(let i=0;;i++){let next=compile(expr.exprs[i],from);if(i==expr.exprs.length-1)return next;connect(next,from=node())}else if("star"==expr.type){let loop=node();return edge(from,loop),connect(compile(expr.expr,loop),loop),[edge(loop)]}else if("plus"==expr.type){let loop1=node();return connect(compile(expr.expr,from),loop1),connect(compile(expr.expr,loop1),loop1),[edge(loop1)]}else if("opt"==expr.type)return[edge(from)].concat(compile(expr.expr,from));else if("range"==expr.type){let cur=from;for(let i1=0;i1<expr.min;i1++){let next1=node();connect(compile(expr.expr,cur),next1),cur=next1}if(-1==expr.max)connect(compile(expr.expr,cur),cur);else for(let i2=expr.min;i2<expr.max;i2++){let next2=node();edge(cur,next2),connect(compile(expr.expr,cur),next2),cur=next2}return[edge(cur)]}else if("name"==expr.type)return[edge(from,void 0,expr.value)];else throw Error("Unknown expr type")}(expr,0),node()),nfa;function node(){return nfa.push([])-1}function edge(from,to,term){let edge={term,to};return nfa[from].push(edge),edge}function connect(edges,to){edges.forEach(edge=>edge.to=to)}}(expr),labeled=Object.create(null),function explore(states){let out=[];states.forEach(node=>{nfa[node].forEach(({term,to})=>{let set;if(term){for(let i=0;i<out.length;i++)out[i][0]==term&&(set=out[i][1]);nullFrom(nfa,to).forEach(node=>{set||out.push([term,set=[]]),-1==set.indexOf(node)&&set.push(node)})}})});let state=labeled[states.join(",")]=new ContentMatch(states.indexOf(nfa.length-1)>-1);for(let i=0;i<out.length;i++){let states1=out[i][1].sort(cmp);state.next.push({type:out[i][0],next:labeled[states1.join(",")]||explore(states1)})}return state}(nullFrom(nfa,0)));return function(match,stream){for(let i=0,work=[match];i<work.length;i++){let state=work[i],dead=!state.validEnd,nodes=[];for(let j=0;j<state.next.length;j++){let{type,next}=state.next[j];nodes.push(type.name),dead&&!(type.isText||type.hasRequiredAttrs())&&(dead=!1),-1==work.indexOf(next)&&work.push(next)}dead&&stream.err("Only non-generatable nodes ("+nodes.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}(match,stream),match}matchType(type){for(let i=0;i<this.next.length;i++)if(this.next[i].type==type)return this.next[i].next;return null}matchFragment(frag,start=0,end=frag.childCount){let cur=this;for(let i=start;cur&&i<end;i++)cur=cur.matchType(frag.child(i).type);return cur}get inlineContent(){return 0!=this.next.length&&this.next[0].type.isInline}get defaultType(){for(let i=0;i<this.next.length;i++){let{type}=this.next[i];if(!(type.isText||type.hasRequiredAttrs()))return type}return null}compatible(other){for(let i=0;i<this.next.length;i++)for(let j=0;j<other.next.length;j++)if(this.next[i].type==other.next[j].type)return!0;return!1}fillBefore(after,toEnd=!1,startIndex=0){let seen=[this];return function search(match,types){let finished=match.matchFragment(after,startIndex);if(finished&&(!toEnd||finished.validEnd))return Fragment.from(types.map(tp=>tp.createAndFill()));for(let i=0;i<match.next.length;i++){let{type,next}=match.next[i];if(!(type.isText||type.hasRequiredAttrs())&&-1==seen.indexOf(next)){seen.push(next);let found=search(next,types.concat(type));if(found)return found}}return null}(this,[])}findWrapping(target){for(let i=0;i<this.wrapCache.length;i+=2)if(this.wrapCache[i]==target)return this.wrapCache[i+1];let computed=this.computeWrapping(target);return this.wrapCache.push(target,computed),computed}computeWrapping(target){let seen=Object.create(null),active=[{match:this,type:null,via:null}];for(;active.length;){let current=active.shift(),match=current.match;if(match.matchType(target)){let result=[];for(let obj=current;obj.type;obj=obj.via)result.push(obj.type);return result.reverse()}for(let i=0;i<match.next.length;i++){let{type,next}=match.next[i];type.isLeaf||type.hasRequiredAttrs()||type.name in seen||current.type&&!next.validEnd||(active.push({match:type.contentMatch,type,via:current}),seen[type.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(n){if(n>=this.next.length)throw RangeError(`There's no ${n}th edge in this content match`);return this.next[n]}toString(){let seen=[];return!function scan(m){seen.push(m);for(let i=0;i<m.next.length;i++)-1==seen.indexOf(m.next[i].next)&&scan(m.next[i].next)}(this),seen.map((m,i)=>{let out=i+(m.validEnd?"*":" ")+" ";for(let i1=0;i1<m.next.length;i1++)out+=(i1?", ":"")+m.next[i1].type.name+"->"+seen.indexOf(m.next[i1].next);return out}).join("\n")}}ContentMatch.empty=new ContentMatch(!0);class TokenStream{constructor(string,nodeTypes){this.string=string,this.nodeTypes=nodeTypes,this.inline=null,this.pos=0,this.tokens=string.split(/\s*(?=\b|\W|$)/),""==this.tokens[this.tokens.length-1]&&this.tokens.pop(),""==this.tokens[0]&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(tok){return this.next==tok&&(this.pos++||!0)}err(str){throw SyntaxError(str+" (in content expression '"+this.string+"')")}}function parseNum(stream){/\D/.test(stream.next)&&stream.err("Expected number, got '"+stream.next+"'");let result=Number(stream.next);return stream.pos++,result}function cmp(a,b){return b-a}function nullFrom(nfa,node){let result=[];return function scan(node){let edges=nfa[node];if(1==edges.length&&!edges[0].term)return scan(edges[0].to);result.push(node);for(let i=0;i<edges.length;i++){let{term,to}=edges[i];term||-1!=result.indexOf(to)||scan(to)}}(node),result.sort(cmp)}function defaultAttrs(attrs){let defaults=Object.create(null);for(let attrName in attrs){let attr=attrs[attrName];if(!attr.hasDefault)return null;defaults[attrName]=attr.default}return defaults}function computeAttrs(attrs,value){let built=Object.create(null);for(let name in attrs){let given=value&&value[name];if(void 0===given){let attr=attrs[name];if(attr.hasDefault)given=attr.default;else throw RangeError("No value supplied for attribute "+name)}built[name]=given}return built}function initAttrs(attrs){let result=Object.create(null);if(attrs)for(let name in attrs)result[name]=new Attribute(attrs[name]);return result}class NodeType{constructor(name,schema,spec){this.name=name,this.schema=schema,this.spec=spec,this.markSet=null,this.groups=spec.group?spec.group.split(" "):[],this.attrs=initAttrs(spec.attrs),this.defaultAttrs=defaultAttrs(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(spec.inline||"text"==name),this.isText="text"==name}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==ContentMatch.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let n in this.attrs)if(this.attrs[n].isRequired)return!0;return!1}compatibleContent(other){return this==other||this.contentMatch.compatible(other.contentMatch)}computeAttrs(attrs){return!attrs&&this.defaultAttrs?this.defaultAttrs:computeAttrs(this.attrs,attrs)}create(attrs=null,content,marks){if(this.isText)throw Error("NodeType.create can't construct text nodes");return new Node(this,this.computeAttrs(attrs),Fragment.from(content),Mark.setFrom(marks))}createChecked(attrs=null,content,marks){return content=Fragment.from(content),this.checkContent(content),new Node(this,this.computeAttrs(attrs),content,Mark.setFrom(marks))}createAndFill(attrs=null,content,marks){if(attrs=this.computeAttrs(attrs),(content=Fragment.from(content)).size){let before=this.contentMatch.fillBefore(content);if(!before)return null;content=before.append(content)}let matched=this.contentMatch.matchFragment(content),after=matched&&matched.fillBefore(Fragment.empty,!0);return after?new Node(this,attrs,content.append(after),Mark.setFrom(marks)):null}validContent(content){let result=this.contentMatch.matchFragment(content);if(!result||!result.validEnd)return!1;for(let i=0;i<content.childCount;i++)if(!this.allowsMarks(content.child(i).marks))return!1;return!0}checkContent(content){if(!this.validContent(content))throw RangeError(`Invalid content for node ${this.name}: ${content.toString().slice(0,50)}`)}allowsMarkType(markType){return null==this.markSet||this.markSet.indexOf(markType)>-1}allowsMarks(marks){if(null==this.markSet)return!0;for(let i=0;i<marks.length;i++)if(!this.allowsMarkType(marks[i].type))return!1;return!0}allowedMarks(marks){let copy;if(null==this.markSet)return marks;for(let i=0;i<marks.length;i++)this.allowsMarkType(marks[i].type)?copy&&copy.push(marks[i]):copy||(copy=marks.slice(0,i));return copy?copy.length?copy:Mark.none:marks}static compile(nodes,schema){let result=Object.create(null);nodes.forEach((name,spec)=>result[name]=new NodeType(name,schema,spec));let topType=schema.spec.topNode||"doc";if(!result[topType])throw RangeError("Schema is missing its top node type ('"+topType+"')");if(!result.text)throw RangeError("Every schema needs a 'text' type");for(let _ in result.text.attrs)throw RangeError("The text node type should not have attributes");return result}}class Attribute{constructor(options){this.hasDefault=Object.prototype.hasOwnProperty.call(options,"default"),this.default=options.default}get isRequired(){return!this.hasDefault}}class MarkType{constructor(name,rank,schema,spec){this.name=name,this.rank=rank,this.schema=schema,this.spec=spec,this.attrs=initAttrs(spec.attrs),this.excluded=null;let defaults=defaultAttrs(this.attrs);this.instance=defaults?new Mark(this,defaults):null}create(attrs=null){return!attrs&&this.instance?this.instance:new Mark(this,computeAttrs(this.attrs,attrs))}static compile(marks,schema){let result=Object.create(null),rank=0;return marks.forEach((name,spec)=>result[name]=new MarkType(name,rank++,schema,spec)),result}removeFromSet(set){for(var i=0;i<set.length;i++)set[i].type==this&&(set=set.slice(0,i).concat(set.slice(i+1)),i--);return set}isInSet(set){for(let i=0;i<set.length;i++)if(set[i].type==this)return set[i]}excludes(other){return this.excluded.indexOf(other)>-1}}class Schema{constructor(spec){this.cached=Object.create(null);let instanceSpec=this.spec={};for(let prop in spec)instanceSpec[prop]=spec[prop];instanceSpec.nodes=OrderedMap.from(spec.nodes),instanceSpec.marks=OrderedMap.from(spec.marks||{}),this.nodes=NodeType.compile(this.spec.nodes,this),this.marks=MarkType.compile(this.spec.marks,this);let contentExprCache=Object.create(null);for(let prop1 in this.nodes){if(prop1 in this.marks)throw RangeError(prop1+" can not be both a node and a mark");let type=this.nodes[prop1],contentExpr=type.spec.content||"",markExpr=type.spec.marks;type.contentMatch=contentExprCache[contentExpr]||(contentExprCache[contentExpr]=ContentMatch.parse(contentExpr,this.nodes)),type.inlineContent=type.contentMatch.inlineContent,type.markSet="_"==markExpr?null:markExpr?gatherMarks(this,markExpr.split(" ")):""!=markExpr&&type.inlineContent?null:[]}for(let prop2 in this.marks){let type1=this.marks[prop2],excl=type1.spec.excludes;type1.excluded=null==excl?[type1]:""==excl?[]:gatherMarks(this,excl.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(type,attrs=null,content,marks){if("string"==typeof type)type=this.nodeType(type);else if(type instanceof NodeType){if(type.schema!=this)throw RangeError("Node type from different schema used ("+type.name+")")}else throw RangeError("Invalid node type: "+type);return type.createChecked(attrs,content,marks)}text(text,marks){let type=this.nodes.text;return new TextNode(type,type.defaultAttrs,text,Mark.setFrom(marks))}mark(type,attrs){return"string"==typeof type&&(type=this.marks[type]),type.create(attrs)}nodeFromJSON(json){return Node.fromJSON(this,json)}markFromJSON(json){return Mark.fromJSON(this,json)}nodeType(name){let found=this.nodes[name];if(!found)throw RangeError("Unknown node type: "+name);return found}}function gatherMarks(schema,marks){let found=[];for(let i=0;i<marks.length;i++){let name=marks[i],mark=schema.marks[name],ok=mark;if(mark)found.push(mark);else for(let prop in schema.marks){let mark1=schema.marks[prop];("_"==name||mark1.spec.group&&mark1.spec.group.split(" ").indexOf(name)>-1)&&found.push(ok=mark1)}if(!ok)throw SyntaxError("Unknown mark type: '"+marks[i]+"'")}return found}class DOMParser{constructor(schema,rules){this.schema=schema,this.rules=rules,this.tags=[],this.styles=[],rules.forEach(rule=>{rule.tag?this.tags.push(rule):rule.style&&this.styles.push(rule)}),this.normalizeLists=!this.tags.some(r=>{if(!/^(ul|ol)\b/.test(r.tag)||!r.node)return!1;let node=schema.nodes[r.node];return node.contentMatch.matchType(node)})}parse(dom,options={}){let context=new ParseContext(this,options,!1);return context.addAll(dom,options.from,options.to),context.finish()}parseSlice(dom,options={}){let context=new ParseContext(this,options,!0);return context.addAll(dom,options.from,options.to),Slice.maxOpen(context.finish())}matchTag(dom,context,after){for(let i=after?this.tags.indexOf(after)+1:0;i<this.tags.length;i++){var selector;let rule=this.tags[i];if(selector=rule.tag,(dom.matches||dom.msMatchesSelector||dom.webkitMatchesSelector||dom.mozMatchesSelector).call(dom,selector)&&(void 0===rule.namespace||dom.namespaceURI==rule.namespace)&&(!rule.context||context.matchesContext(rule.context))){if(rule.getAttrs){let result=rule.getAttrs(dom);if(!1===result)continue;rule.attrs=result||void 0}return rule}}}matchStyle(prop,value,context,after){for(let i=after?this.styles.indexOf(after)+1:0;i<this.styles.length;i++){let rule=this.styles[i],style=rule.style;if(0==style.indexOf(prop)&&(!rule.context||context.matchesContext(rule.context))&&(!(style.length>prop.length)||61==style.charCodeAt(prop.length)&&style.slice(prop.length+1)==value)){if(rule.getAttrs){let result=rule.getAttrs(value);if(!1===result)continue;rule.attrs=result||void 0}return rule}}}static schemaRules(schema){let result=[];function insert(rule){let priority=null==rule.priority?50:rule.priority,i=0;for(;i<result.length;i++){let next=result[i];if((null==next.priority?50:next.priority)<priority)break}result.splice(i,0,rule)}for(let name in schema.marks){let rules=schema.marks[name].spec.parseDOM;rules&&rules.forEach(rule=>{insert(rule=copy(rule)),rule.mark||rule.ignore||rule.clearMark||(rule.mark=name)})}for(let name1 in schema.nodes){let rules1=schema.nodes[name1].spec.parseDOM;rules1&&rules1.forEach(rule=>{insert(rule=copy(rule)),rule.node||rule.ignore||rule.mark||(rule.node=name1)})}return result}static fromSchema(schema){return schema.cached.domParser||(schema.cached.domParser=new DOMParser(schema,DOMParser.schemaRules(schema)))}}let blockTags={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},ignoreTags={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},listTags={ol:!0,ul:!0};function wsOptionsFor(type,preserveWhitespace,base){return null!=preserveWhitespace?(preserveWhitespace?1:0)|("full"===preserveWhitespace?2:0):type&&"pre"==type.whitespace?3:-5&base}class NodeContext{constructor(type,attrs,marks,pendingMarks,solid,match,options){this.type=type,this.attrs=attrs,this.marks=marks,this.pendingMarks=pendingMarks,this.solid=solid,this.options=options,this.content=[],this.activeMarks=Mark.none,this.stashMarks=[],this.match=match||(4&options?null:type.contentMatch)}findWrapping(node){if(!this.match){if(!this.type)return[];let fill=this.type.contentMatch.fillBefore(Fragment.from(node));if(fill)this.match=this.type.contentMatch.matchFragment(fill);else{let start=this.type.contentMatch,wrap;return(wrap=start.findWrapping(node.type))?(this.match=start,wrap):null}}return this.match.findWrapping(node.type)}finish(openEnd){if(!(1&this.options)){let last=this.content[this.content.length-1],m;last&&last.isText&&(m=/[ \t\r\n\u000c]+$/.exec(last.text))&&(last.text.length==m[0].length?this.content.pop():this.content[this.content.length-1]=last.withText(last.text.slice(0,last.text.length-m[0].length)))}let content=Fragment.from(this.content);return!openEnd&&this.match&&(content=content.append(this.match.fillBefore(Fragment.empty,!0))),this.type?this.type.create(this.attrs,content,this.marks):content}popFromStashMark(mark){for(let i=this.stashMarks.length-1;i>=0;i--)if(mark.eq(this.stashMarks[i]))return this.stashMarks.splice(i,1)[0]}applyPending(nextType){for(let i=0,pending=this.pendingMarks;i<pending.length;i++){let mark=pending[i];(this.type?this.type.allowsMarkType(mark.type):function(markType,nodeType){let nodes=nodeType.schema.nodes;for(let name in nodes){let parent=nodes[name];if(!parent.allowsMarkType(markType))continue;let seen=[],scan=match=>{seen.push(match);for(let i=0;i<match.edgeCount;i++){let{type,next}=match.edge(i);if(type==nodeType||0>seen.indexOf(next)&&scan(next))return!0}};if(scan(parent.contentMatch))return!0}}(mark.type,nextType))&&!mark.isInSet(this.activeMarks)&&(this.activeMarks=mark.addToSet(this.activeMarks),this.pendingMarks=mark.removeFromSet(this.pendingMarks))}}inlineContext(node){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:node.parentNode&&!blockTags.hasOwnProperty(node.parentNode.nodeName.toLowerCase())}}class ParseContext{constructor(parser,options,isOpen){this.parser=parser,this.options=options,this.isOpen=isOpen,this.open=0;let topNode=options.topNode,topContext,topOptions=wsOptionsFor(null,options.preserveWhitespace,0)|(isOpen?4:0);topContext=topNode?new NodeContext(topNode.type,topNode.attrs,Mark.none,Mark.none,!0,options.topMatch||topNode.type.contentMatch,topOptions):isOpen?new NodeContext(null,null,Mark.none,Mark.none,!0,null,topOptions):new NodeContext(parser.schema.topNodeType,null,Mark.none,Mark.none,!0,null,topOptions),this.nodes=[topContext],this.find=options.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(dom){if(3==dom.nodeType)this.addTextNode(dom);else if(1==dom.nodeType){let style=dom.getAttribute("style");if(style){let marks=this.readStyles(function(style){let re=/\s*([\w-]+)\s*:\s*([^;]+)/g,m,result=[];for(;m=re.exec(style);)result.push(m[1],m[2].trim());return result}(style));if(!marks)return;let[addMarks,removeMarks]=marks,top=this.top;for(let i=0;i<removeMarks.length;i++)this.removePendingMark(removeMarks[i],top);for(let i1=0;i1<addMarks.length;i1++)this.addPendingMark(addMarks[i1]);this.addElement(dom);for(let i2=0;i2<addMarks.length;i2++)this.removePendingMark(addMarks[i2],top);for(let i3=0;i3<removeMarks.length;i3++)this.addPendingMark(removeMarks[i3])}else this.addElement(dom)}}addTextNode(dom){let value=dom.nodeValue,top=this.top;if(2&top.options||top.inlineContext(dom)||/[^ \t\r\n\u000c]/.test(value)){if(1&top.options)value=2&top.options?value.replace(/\r\n?/g,"\n"):value.replace(/\r?\n|\r/g," ");else if(value=value.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(value)&&this.open==this.nodes.length-1){let nodeBefore=top.content[top.content.length-1],domNodeBefore=dom.previousSibling;(!nodeBefore||domNodeBefore&&"BR"==domNodeBefore.nodeName||nodeBefore.isText&&/[ \t\r\n\u000c]$/.test(nodeBefore.text))&&(value=value.slice(1))}value&&this.insertNode(this.parser.schema.text(value)),this.findInText(dom)}else this.findInside(dom)}addElement(dom,matchAfter){let name=dom.nodeName.toLowerCase(),ruleID;listTags.hasOwnProperty(name)&&this.parser.normalizeLists&&function(dom){for(let child=dom.firstChild,prevItem=null;child;child=child.nextSibling){let name=1==child.nodeType?child.nodeName.toLowerCase():null;name&&listTags.hasOwnProperty(name)&&prevItem?(prevItem.appendChild(child),child=prevItem):"li"==name?prevItem=child:name&&(prevItem=null)}}(dom);let rule=this.options.ruleFromNode&&this.options.ruleFromNode(dom)||(ruleID=this.parser.matchTag(dom,this,matchAfter));if(rule?rule.ignore:ignoreTags.hasOwnProperty(name))this.findInside(dom),this.ignoreFallback(dom);else if(!rule||rule.skip||rule.closeParent){rule&&rule.closeParent?this.open=Math.max(0,this.open-1):rule&&rule.skip.nodeType&&(dom=rule.skip);let sync,top=this.top,oldNeedsBlock=this.needsBlock;if(blockTags.hasOwnProperty(name))top.content.length&&top.content[0].isInline&&this.open&&(this.open--,top=this.top),sync=!0,top.type||(this.needsBlock=!0);else if(!dom.firstChild){this.leafFallback(dom);return}this.addAll(dom),sync&&this.sync(top),this.needsBlock=oldNeedsBlock}else this.addElementByRule(dom,rule,!1===rule.consuming?ruleID:void 0)}leafFallback(dom){"BR"==dom.nodeName&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(dom.ownerDocument.createTextNode("\n"))}ignoreFallback(dom){"BR"!=dom.nodeName||this.top.type&&this.top.type.inlineContent||this.findPlace(this.parser.schema.text("-"))}readStyles(styles){let add=Mark.none,remove=Mark.none;style:for(let i=0;i<styles.length;i+=2)for(let after;;){let rule=this.parser.matchStyle(styles[i],styles[i+1],this,after);if(!rule)continue style;if(rule.ignore)return null;if(rule.clearMark?this.top.pendingMarks.forEach(m=>{rule.clearMark(m)&&(remove=m.addToSet(remove))}):add=this.parser.schema.marks[rule.mark].create(rule.attrs).addToSet(add),!1===rule.consuming)after=rule;else break}return[add,remove]}addElementByRule(dom,rule,continueAfter){let sync,nodeType,mark;rule.node?(nodeType=this.parser.schema.nodes[rule.node]).isLeaf?this.insertNode(nodeType.create(rule.attrs))||this.leafFallback(dom):sync=this.enter(nodeType,rule.attrs||null,rule.preserveWhitespace):(mark=this.parser.schema.marks[rule.mark].create(rule.attrs),this.addPendingMark(mark));let startIn=this.top;if(nodeType&&nodeType.isLeaf)this.findInside(dom);else if(continueAfter)this.addElement(dom,continueAfter);else if(rule.getContent)this.findInside(dom),rule.getContent(dom,this.parser.schema).forEach(node=>this.insertNode(node));else{let contentDOM=dom;"string"==typeof rule.contentElement?contentDOM=dom.querySelector(rule.contentElement):"function"==typeof rule.contentElement?contentDOM=rule.contentElement(dom):rule.contentElement&&(contentDOM=rule.contentElement),this.findAround(dom,contentDOM,!0),this.addAll(contentDOM)}sync&&this.sync(startIn)&&this.open--,mark&&this.removePendingMark(mark,startIn)}addAll(parent,startIndex,endIndex){let index=startIndex||0;for(let dom=startIndex?parent.childNodes[startIndex]:parent.firstChild,end=null==endIndex?null:parent.childNodes[endIndex];dom!=end;dom=dom.nextSibling,++index)this.findAtPoint(parent,index),this.addDOM(dom);this.findAtPoint(parent,index)}findPlace(node){let route,sync;for(let depth=this.open;depth>=0;depth--){let cx=this.nodes[depth],found=cx.findWrapping(node);if(found&&(!route||route.length>found.length)&&(route=found,sync=cx,!found.length)||cx.solid)break}if(!route)return!1;this.sync(sync);for(let i=0;i<route.length;i++)this.enterInner(route[i],null,!1);return!0}insertNode(node){if(node.isInline&&this.needsBlock&&!this.top.type){let block=this.textblockFromContext();block&&this.enterInner(block)}if(this.findPlace(node)){this.closeExtra();let top=this.top;top.applyPending(node.type),top.match&&(top.match=top.match.matchType(node.type));let marks=top.activeMarks;for(let i=0;i<node.marks.length;i++)(!top.type||top.type.allowsMarkType(node.marks[i].type))&&(marks=node.marks[i].addToSet(marks));return top.content.push(node.mark(marks)),!0}return!1}enter(type,attrs,preserveWS){let ok=this.findPlace(type.create(attrs));return ok&&this.enterInner(type,attrs,!0,preserveWS),ok}enterInner(type,attrs=null,solid=!1,preserveWS){this.closeExtra();let top=this.top;top.applyPending(type),top.match=top.match&&top.match.matchType(type);let options=wsOptionsFor(type,preserveWS,top.options);4&top.options&&0==top.content.length&&(options|=4),this.nodes.push(new NodeContext(type,attrs,top.activeMarks,top.pendingMarks,solid,null,options)),this.open++}closeExtra(openEnd=!1){let i=this.nodes.length-1;if(i>this.open){for(;i>this.open;i--)this.nodes[i-1].content.push(this.nodes[i].finish(openEnd));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(this.isOpen||this.options.topOpen)}sync(to){for(let i=this.open;i>=0;i--)if(this.nodes[i]==to)return this.open=i,!0;return!1}get currentPos(){this.closeExtra();let pos=0;for(let i=this.open;i>=0;i--){let content=this.nodes[i].content;for(let j=content.length-1;j>=0;j--)pos+=content[j].nodeSize;i&&pos++}return pos}findAtPoint(parent,offset){if(this.find)for(let i=0;i<this.find.length;i++)this.find[i].node==parent&&this.find[i].offset==offset&&(this.find[i].pos=this.currentPos)}findInside(parent){if(this.find)for(let i=0;i<this.find.length;i++)null==this.find[i].pos&&1==parent.nodeType&&parent.contains(this.find[i].node)&&(this.find[i].pos=this.currentPos)}findAround(parent,content,before){if(parent!=content&&this.find)for(let i=0;i<this.find.length;i++)null==this.find[i].pos&&1==parent.nodeType&&parent.contains(this.find[i].node)&&content.compareDocumentPosition(this.find[i].node)&(before?2:4)&&(this.find[i].pos=this.currentPos)}findInText(textNode){if(this.find)for(let i=0;i<this.find.length;i++)this.find[i].node==textNode&&(this.find[i].pos=this.currentPos-(textNode.nodeValue.length-this.find[i].offset))}matchesContext(context){if(context.indexOf("|")>-1)return context.split(/\s*\|\s*/).some(this.matchesContext,this);let parts=context.split("/"),option=this.options.context,useRoot=!this.isOpen&&(!option||option.parent.type==this.nodes[0].type),minDepth=-(option?option.depth+1:0)+(useRoot?0:1),match=(i,depth)=>{for(;i>=0;i--){let part=parts[i];if(""==part){if(i==parts.length-1||0==i)continue;for(;depth>=minDepth;depth--)if(match(i-1,depth))return!0;return!1}{let next=depth>0||0==depth&&useRoot?this.nodes[depth].type:option&&depth>=minDepth?option.node(depth-minDepth).type:null;if(!next||next.name!=part&&-1==next.groups.indexOf(part))return!1;depth--}}return!0};return match(parts.length-1,this.open)}textblockFromContext(){let $context=this.options.context;if($context)for(let d=$context.depth;d>=0;d--){let deflt=$context.node(d).contentMatchAt($context.indexAfter(d)).defaultType;if(deflt&&deflt.isTextblock&&deflt.defaultAttrs)return deflt}for(let name in this.parser.schema.nodes){let type=this.parser.schema.nodes[name];if(type.isTextblock&&type.defaultAttrs)return type}}addPendingMark(mark){let found=function(mark,set){for(let i=0;i<set.length;i++)if(mark.eq(set[i]))return set[i]}(mark,this.top.pendingMarks);found&&this.top.stashMarks.push(found),this.top.pendingMarks=mark.addToSet(this.top.pendingMarks)}removePendingMark(mark,upto){for(let depth=this.open;depth>=0;depth--){let level=this.nodes[depth];if(level.pendingMarks.lastIndexOf(mark)>-1)level.pendingMarks=mark.removeFromSet(level.pendingMarks);else{level.activeMarks=mark.removeFromSet(level.activeMarks);let stashMark=level.popFromStashMark(mark);stashMark&&level.type&&level.type.allowsMarkType(stashMark.type)&&(level.activeMarks=stashMark.addToSet(level.activeMarks))}if(level==upto)break}}}function copy(obj){let copy={};for(let prop in obj)copy[prop]=obj[prop];return copy}class DOMSerializer{constructor(nodes,marks){this.nodes=nodes,this.marks=marks}serializeFragment(fragment,options={},target){target||(target=doc(options).createDocumentFragment());let top=target,active=[];return fragment.forEach(node=>{if(active.length||node.marks.length){let keep=0,rendered=0;for(;keep<active.length&&rendered<node.marks.length;){let next=node.marks[rendered];if(!this.marks[next.type.name]){rendered++;continue}if(!next.eq(active[keep][0])||!1===next.type.spec.spanning)break;keep++,rendered++}for(;keep<active.length;)top=active.pop()[1];for(;rendered<node.marks.length;){let add=node.marks[rendered++],markDOM=this.serializeMark(add,node.isInline,options);markDOM&&(active.push([add,top]),top.appendChild(markDOM.dom),top=markDOM.contentDOM||markDOM.dom)}}top.appendChild(this.serializeNodeInner(node,options))}),target}serializeNodeInner(node,options){let{dom,contentDOM}=DOMSerializer.renderSpec(doc(options),this.nodes[node.type.name](node));if(contentDOM){if(node.isLeaf)throw RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(node.content,options,contentDOM)}return dom}serializeNode(node,options={}){let dom=this.serializeNodeInner(node,options);for(let i=node.marks.length-1;i>=0;i--){let wrap=this.serializeMark(node.marks[i],node.isInline,options);wrap&&((wrap.contentDOM||wrap.dom).appendChild(dom),dom=wrap.dom)}return dom}serializeMark(mark,inline,options={}){let toDOM=this.marks[mark.type.name];return toDOM&&DOMSerializer.renderSpec(doc(options),toDOM(mark,inline))}static renderSpec(doc,structure,xmlNS=null){let contentDOM;if("string"==typeof structure)return{dom:doc.createTextNode(structure)};if(null!=structure.nodeType)return{dom:structure};if(structure.dom&&null!=structure.dom.nodeType)return structure;let tagName=structure[0],space=tagName.indexOf(" ");space>0&&(xmlNS=tagName.slice(0,space),tagName=tagName.slice(space+1));let dom=xmlNS?doc.createElementNS(xmlNS,tagName):doc.createElement(tagName),attrs=structure[1],start=1;if(attrs&&"object"==typeof attrs&&null==attrs.nodeType&&!Array.isArray(attrs)){for(let name in start=2,attrs)if(null!=attrs[name]){let space1=name.indexOf(" ");space1>0?dom.setAttributeNS(name.slice(0,space1),name.slice(space1+1),attrs[name]):dom.setAttribute(name,attrs[name])}}for(let i=start;i<structure.length;i++){let child=structure[i];if(0===child){if(i<structure.length-1||i>start)throw RangeError("Content hole must be the only child of its parent node");return{dom,contentDOM:dom}}{let{dom:inner,contentDOM:innerContent}=DOMSerializer.renderSpec(doc,child,xmlNS);if(dom.appendChild(inner),innerContent){if(contentDOM)throw RangeError("Multiple content holes");contentDOM=innerContent}}}return{dom,contentDOM}}static fromSchema(schema){return schema.cached.domSerializer||(schema.cached.domSerializer=new DOMSerializer(this.nodesFromSchema(schema),this.marksFromSchema(schema)))}static nodesFromSchema(schema){let result=gatherToDOM(schema.nodes);return result.text||(result.text=node=>node.text),result}static marksFromSchema(schema){return gatherToDOM(schema.marks)}}function gatherToDOM(obj){let result={};for(let name in obj){let toDOM=obj[name].spec.toDOM;toDOM&&(result[name]=toDOM)}return result}function doc(options){return options.document||window.document}},39451:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{Bs:function(){return TextSelection},C1:function(){return AllSelection},H$:function(){return PluginKey},Sy:function(){return Plugin},Y1:function(){return Selection},qv:function(){return NodeSelection},xm:function(){return SelectionRange},yy:function(){return EditorState}});var prosemirror_model__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(57981),prosemirror_transform__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(21692);let classesById=Object.create(null);class Selection{constructor($anchor,$head,ranges){this.$anchor=$anchor,this.$head=$head,this.ranges=ranges||[new SelectionRange($anchor.min($head),$anchor.max($head))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let ranges=this.ranges;for(let i=0;i<ranges.length;i++)if(ranges[i].$from.pos!=ranges[i].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(tr,content=prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.p2.empty){let lastNode=content.content.lastChild,lastParent=null;for(let i=0;i<content.openEnd;i++)lastParent=lastNode,lastNode=lastNode.lastChild;let mapFrom=tr.steps.length,ranges=this.ranges;for(let i1=0;i1<ranges.length;i1++){let{$from,$to}=ranges[i1],mapping=tr.mapping.slice(mapFrom);tr.replaceRange(mapping.map($from.pos),mapping.map($to.pos),i1?prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.p2.empty:content),0==i1&&selectionToInsertionEnd(tr,mapFrom,(lastNode?lastNode.isInline:lastParent&&lastParent.isTextblock)?-1:1)}}replaceWith(tr,node){let mapFrom=tr.steps.length,ranges=this.ranges;for(let i=0;i<ranges.length;i++){let{$from,$to}=ranges[i],mapping=tr.mapping.slice(mapFrom),from=mapping.map($from.pos),to=mapping.map($to.pos);i?tr.deleteRange(from,to):(tr.replaceRangeWith(from,to,node),selectionToInsertionEnd(tr,mapFrom,node.isInline?-1:1))}}static findFrom($pos,dir,textOnly=!1){let inner=$pos.parent.inlineContent?new TextSelection($pos):findSelectionIn($pos.node(0),$pos.parent,$pos.pos,$pos.index(),dir,textOnly);if(inner)return inner;for(let depth=$pos.depth-1;depth>=0;depth--){let found=dir<0?findSelectionIn($pos.node(0),$pos.node(depth),$pos.before(depth+1),$pos.index(depth),dir,textOnly):findSelectionIn($pos.node(0),$pos.node(depth),$pos.after(depth+1),$pos.index(depth)+1,dir,textOnly);if(found)return found}return null}static near($pos,bias=1){return this.findFrom($pos,bias)||this.findFrom($pos,-bias)||new AllSelection($pos.node(0))}static atStart(doc){return findSelectionIn(doc,doc,0,0,1)||new AllSelection(doc)}static atEnd(doc){return findSelectionIn(doc,doc,doc.content.size,doc.childCount,-1)||new AllSelection(doc)}static fromJSON(doc,json){if(!json||!json.type)throw RangeError("Invalid input for Selection.fromJSON");let cls=classesById[json.type];if(!cls)throw RangeError(`No selection type ${json.type} defined`);return cls.fromJSON(doc,json)}static jsonID(id,selectionClass){if(id in classesById)throw RangeError("Duplicate use of selection JSON ID "+id);return classesById[id]=selectionClass,selectionClass.prototype.jsonID=id,selectionClass}getBookmark(){return TextSelection.between(this.$anchor,this.$head).getBookmark()}}Selection.prototype.visible=!0;class SelectionRange{constructor($from,$to){this.$from=$from,this.$to=$to}}let warnedAboutTextSelection=!1;function checkTextSelection($pos){warnedAboutTextSelection||$pos.parent.inlineContent||(warnedAboutTextSelection=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+$pos.parent.type.name+")"))}class TextSelection extends Selection{constructor($anchor,$head=$anchor){checkTextSelection($anchor),checkTextSelection($head),super($anchor,$head)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(doc,mapping){let $head=doc.resolve(mapping.map(this.head));if(!$head.parent.inlineContent)return Selection.near($head);let $anchor=doc.resolve(mapping.map(this.anchor));return new TextSelection($anchor.parent.inlineContent?$anchor:$head,$head)}replace(tr,content=prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.p2.empty){if(super.replace(tr,content),content==prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.p2.empty){let marks=this.$from.marksAcross(this.$to);marks&&tr.ensureMarks(marks)}}eq(other){return other instanceof TextSelection&&other.anchor==this.anchor&&other.head==this.head}getBookmark(){return new TextBookmark(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(doc,json){if("number"!=typeof json.anchor||"number"!=typeof json.head)throw RangeError("Invalid input for TextSelection.fromJSON");return new TextSelection(doc.resolve(json.anchor),doc.resolve(json.head))}static create(doc,anchor,head=anchor){let $anchor=doc.resolve(anchor);return new this($anchor,head==anchor?$anchor:doc.resolve(head))}static between($anchor,$head,bias){let dPos=$anchor.pos-$head.pos;if((!bias||dPos)&&(bias=dPos>=0?1:-1),!$head.parent.inlineContent){let found=Selection.findFrom($head,bias,!0)||Selection.findFrom($head,-bias,!0);if(!found)return Selection.near($head,bias);$head=found.$head}return $anchor.parent.inlineContent||(0==dPos?$anchor=$head:($anchor=(Selection.findFrom($anchor,-bias,!0)||Selection.findFrom($anchor,bias,!0)).$anchor).pos<$head.pos==dPos<0||($anchor=$head)),new TextSelection($anchor,$head)}}Selection.jsonID("text",TextSelection);class TextBookmark{constructor(anchor,head){this.anchor=anchor,this.head=head}map(mapping){return new TextBookmark(mapping.map(this.anchor),mapping.map(this.head))}resolve(doc){return TextSelection.between(doc.resolve(this.anchor),doc.resolve(this.head))}}class NodeSelection extends Selection{constructor($pos){let node=$pos.nodeAfter;super($pos,$pos.node(0).resolve($pos.pos+node.nodeSize)),this.node=node}map(doc,mapping){let{deleted,pos}=mapping.mapResult(this.anchor),$pos=doc.resolve(pos);return deleted?Selection.near($pos):new NodeSelection($pos)}content(){return new prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.p2(prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.HY.from(this.node),0,0)}eq(other){return other instanceof NodeSelection&&other.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new NodeBookmark(this.anchor)}static fromJSON(doc,json){if("number"!=typeof json.anchor)throw RangeError("Invalid input for NodeSelection.fromJSON");return new NodeSelection(doc.resolve(json.anchor))}static create(doc,from){return new NodeSelection(doc.resolve(from))}static isSelectable(node){return!node.isText&&!1!==node.type.spec.selectable}}NodeSelection.prototype.visible=!1,Selection.jsonID("node",NodeSelection);class NodeBookmark{constructor(anchor){this.anchor=anchor}map(mapping){let{deleted,pos}=mapping.mapResult(this.anchor);return deleted?new TextBookmark(pos,pos):new NodeBookmark(pos)}resolve(doc){let $pos=doc.resolve(this.anchor),node=$pos.nodeAfter;return node&&NodeSelection.isSelectable(node)?new NodeSelection($pos):Selection.near($pos)}}class AllSelection extends Selection{constructor(doc){super(doc.resolve(0),doc.resolve(doc.content.size))}replace(tr,content=prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.p2.empty){if(content==prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.p2.empty){tr.delete(0,tr.doc.content.size);let sel=Selection.atStart(tr.doc);sel.eq(tr.selection)||tr.setSelection(sel)}else super.replace(tr,content)}toJSON(){return{type:"all"}}static fromJSON(doc){return new AllSelection(doc)}map(doc){return new AllSelection(doc)}eq(other){return other instanceof AllSelection}getBookmark(){return AllBookmark}}Selection.jsonID("all",AllSelection);let AllBookmark={map(){return this},resolve:doc=>new AllSelection(doc)};function findSelectionIn(doc,node,pos,index,dir,text=!1){if(node.inlineContent)return TextSelection.create(doc,pos);for(let i=index-(dir>0?0:1);dir>0?i<node.childCount:i>=0;i+=dir){let child=node.child(i);if(child.isAtom){if(!text&&NodeSelection.isSelectable(child))return NodeSelection.create(doc,pos-(dir<0?child.nodeSize:0))}else{let inner=findSelectionIn(doc,child,pos+dir,dir<0?child.childCount:0,dir,text);if(inner)return inner}pos+=child.nodeSize*dir}return null}function selectionToInsertionEnd(tr,startLen,bias){let end,last=tr.steps.length-1;if(last<startLen)return;let step=tr.steps[last];(step instanceof prosemirror_transform__WEBPACK_IMPORTED_MODULE_1__.Pu||step instanceof prosemirror_transform__WEBPACK_IMPORTED_MODULE_1__.FC)&&(tr.mapping.maps[last].forEach((_from,_to,_newFrom,newTo)=>{null==end&&(end=newTo)}),tr.setSelection(Selection.near(tr.doc.resolve(end),bias)))}class Transaction extends prosemirror_transform__WEBPACK_IMPORTED_MODULE_1__.wx{constructor(state){super(state.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=state.selection,this.storedMarks=state.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(selection){if(selection.$from.doc!=this.doc)throw RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=selection,this.curSelectionFor=this.steps.length,this.updated=(1|this.updated)&-3,this.storedMarks=null,this}get selectionSet(){return(1&this.updated)>0}setStoredMarks(marks){return this.storedMarks=marks,this.updated|=2,this}ensureMarks(marks){return prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.vc.sameSet(this.storedMarks||this.selection.$from.marks(),marks)||this.setStoredMarks(marks),this}addStoredMark(mark){return this.ensureMarks(mark.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(mark){return this.ensureMarks(mark.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(2&this.updated)>0}addStep(step,doc){super.addStep(step,doc),this.updated=-3&this.updated,this.storedMarks=null}setTime(time){return this.time=time,this}replaceSelection(slice){return this.selection.replace(this,slice),this}replaceSelectionWith(node,inheritMarks=!0){let selection=this.selection;return inheritMarks&&(node=node.mark(this.storedMarks||(selection.empty?selection.$from.marks():selection.$from.marksAcross(selection.$to)||prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.vc.none))),selection.replaceWith(this,node),this}deleteSelection(){return this.selection.replace(this),this}insertText(text,from,to){let schema=this.doc.type.schema;if(null==from)return text?this.replaceSelectionWith(schema.text(text),!0):this.deleteSelection();{if(null==to&&(to=from),to=null==to?from:to,!text)return this.deleteRange(from,to);let marks=this.storedMarks;if(!marks){let $from=this.doc.resolve(from);marks=to==from?$from.marks():$from.marksAcross(this.doc.resolve(to))}return this.replaceRangeWith(from,to,schema.text(text,marks)),this.selection.empty||this.setSelection(Selection.near(this.selection.$to)),this}}setMeta(key,value){return this.meta["string"==typeof key?key:key.key]=value,this}getMeta(key){return this.meta["string"==typeof key?key:key.key]}get isGeneric(){for(let _ in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=4,this}get scrolledIntoView(){return(4&this.updated)>0}}function bind(f,self1){return self1&&f?f.bind(self1):f}class FieldDesc{constructor(name,desc,self1){this.name=name,this.init=bind(desc.init,self1),this.apply=bind(desc.apply,self1)}}let baseFields=[new FieldDesc("doc",{init:config=>config.doc||config.schema.topNodeType.createAndFill(),apply:tr=>tr.doc}),new FieldDesc("selection",{init:(config,instance)=>config.selection||Selection.atStart(instance.doc),apply:tr=>tr.selection}),new FieldDesc("storedMarks",{init:config=>config.storedMarks||null,apply:(tr,_marks,_old,state)=>state.selection.$cursor?tr.storedMarks:null}),new FieldDesc("scrollToSelection",{init:()=>0,apply:(tr,prev)=>tr.scrolledIntoView?prev+1:prev})];class Configuration{constructor(schema,plugins){this.schema=schema,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=baseFields.slice(),plugins&&plugins.forEach(plugin=>{if(this.pluginsByKey[plugin.key])throw RangeError("Adding different instances of a keyed plugin ("+plugin.key+")");this.plugins.push(plugin),this.pluginsByKey[plugin.key]=plugin,plugin.spec.state&&this.fields.push(new FieldDesc(plugin.key,plugin.spec.state,plugin))})}}class EditorState{constructor(config){this.config=config}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(tr){return this.applyTransaction(tr).state}filterTransaction(tr,ignore=-1){for(let i=0;i<this.config.plugins.length;i++)if(i!=ignore){let plugin=this.config.plugins[i];if(plugin.spec.filterTransaction&&!plugin.spec.filterTransaction.call(plugin,tr,this))return!1}return!0}applyTransaction(rootTr){if(!this.filterTransaction(rootTr))return{state:this,transactions:[]};let trs=[rootTr],newState=this.applyInner(rootTr),seen=null;for(;;){let haveNew=!1;for(let i=0;i<this.config.plugins.length;i++){let plugin=this.config.plugins[i];if(plugin.spec.appendTransaction){let n=seen?seen[i].n:0,oldState=seen?seen[i].state:this,tr=n<trs.length&&plugin.spec.appendTransaction.call(plugin,n?trs.slice(n):trs,oldState,newState);if(tr&&newState.filterTransaction(tr,i)){if(tr.setMeta("appendedTransaction",rootTr),!seen){seen=[];for(let j=0;j<this.config.plugins.length;j++)seen.push(j<i?{state:newState,n:trs.length}:{state:this,n:0})}trs.push(tr),newState=newState.applyInner(tr),haveNew=!0}seen&&(seen[i]={state:newState,n:trs.length})}}if(!haveNew)return{state:newState,transactions:trs}}}applyInner(tr){if(!tr.before.eq(this.doc))throw RangeError("Applying a mismatched transaction");let newInstance=new EditorState(this.config),fields=this.config.fields;for(let i=0;i<fields.length;i++){let field=fields[i];newInstance[field.name]=field.apply(tr,this[field.name],this,newInstance)}return newInstance}get tr(){return new Transaction(this)}static create(config){let $config=new Configuration(config.doc?config.doc.type.schema:config.schema,config.plugins),instance=new EditorState($config);for(let i=0;i<$config.fields.length;i++)instance[$config.fields[i].name]=$config.fields[i].init(config,instance);return instance}reconfigure(config){let $config=new Configuration(this.schema,config.plugins),fields=$config.fields,instance=new EditorState($config);for(let i=0;i<fields.length;i++){let name=fields[i].name;instance[name]=this.hasOwnProperty(name)?this[name]:fields[i].init(config,instance)}return instance}toJSON(pluginFields){let result={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(result.storedMarks=this.storedMarks.map(m=>m.toJSON())),pluginFields&&"object"==typeof pluginFields)for(let prop in pluginFields){if("doc"==prop||"selection"==prop)throw RangeError("The JSON fields `doc` and `selection` are reserved");let plugin=pluginFields[prop],state=plugin.spec.state;state&&state.toJSON&&(result[prop]=state.toJSON.call(plugin,this[plugin.key]))}return result}static fromJSON(config,json,pluginFields){if(!json)throw RangeError("Invalid input for EditorState.fromJSON");if(!config.schema)throw RangeError("Required config field 'schema' missing");let $config=new Configuration(config.schema,config.plugins),instance=new EditorState($config);return $config.fields.forEach(field=>{if("doc"==field.name)instance.doc=prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.NB.fromJSON(config.schema,json.doc);else if("selection"==field.name)instance.selection=Selection.fromJSON(instance.doc,json.selection);else if("storedMarks"==field.name)json.storedMarks&&(instance.storedMarks=json.storedMarks.map(config.schema.markFromJSON));else{if(pluginFields)for(let prop in pluginFields){let plugin=pluginFields[prop],state=plugin.spec.state;if(plugin.key==field.name&&state&&state.fromJSON&&Object.prototype.hasOwnProperty.call(json,prop)){instance[field.name]=state.fromJSON.call(plugin,config,json[prop],instance);return}}instance[field.name]=field.init(config,instance)}}),instance}}class Plugin{constructor(spec){this.spec=spec,this.props={},spec.props&&function bindProps(obj,self1,target){for(let prop in obj){let val=obj[prop];val instanceof Function?val=val.bind(self1):"handleDOMEvents"==prop&&(val=bindProps(val,self1,{})),target[prop]=val}return target}(spec.props,this,this.props),this.key=spec.key?spec.key.key:createKey("plugin")}getState(state){return state[this.key]}}let keys=Object.create(null);function createKey(name){return name in keys?name+"$"+ ++keys[name]:(keys[name]=0,name+"$")}class PluginKey{constructor(name="key"){this.key=createKey(name)}get(state){return state.config.pluginsByKey[this.key]}getState(state){return state[this.key]}}},75430:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{$Y:function(){return ChangeReason},C$:function(){return removeSuggester},D7:function(){return suggest},Ek:function(){return addSuggester},ZF:function(){return DEFAULT_SUGGESTER},gn:function(){return ignoreUpdateForSuggest},hu:function(){return getSuggestPluginState},j4:function(){return markActiveInRange}});var ExitReason2,ChangeReason2,_docChanged,_ignoreNextExit,_suggesters,_next,_prev,_handlerMatches,_ignored,_removed,_lastChangeFromAppend,prosemirror_state__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(39451),prosemirror_view__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(3401),_remirror_core_helpers__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(62120),escape_string_regexp__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(4882),escape_string_regexp__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(escape_string_regexp__WEBPACK_IMPORTED_MODULE_2__),_remirror_core_constants__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(9436),__defProp=Object.defineProperty,__defNormalProp=(obj,key,value)=>key in obj?__defProp(obj,key,{enumerable:!0,configurable:!0,writable:!0,value}):obj[key]=value,__publicField=(obj,key,value)=>(__defNormalProp(obj,"symbol"!=typeof key?key+"":key,value),value),__accessCheck=(obj,member,msg)=>{if(!member.has(obj))throw TypeError("Cannot "+msg)},__privateGet=(obj,member,getter)=>(__accessCheck(obj,member,"read from private field"),getter?getter.call(obj):member.get(obj)),__privateAdd=(obj,member,value)=>{if(member.has(obj))throw TypeError("Cannot add the same private member more than once");member instanceof WeakSet?member.add(obj):member.set(obj,value)},__privateSet=(obj,member,value,setter)=>(__accessCheck(obj,member,"write to private field"),setter?setter.call(obj,value):member.set(obj,value),value),ExitReason=((ExitReason2=ExitReason||{}).End="exit-end",ExitReason2.Removed="delete",ExitReason2.Split="exit-split",ExitReason2.InvalidSplit="invalid-exit-split",ExitReason2.MoveEnd="move-end",ExitReason2.MoveStart="move-start",ExitReason2.JumpForward="jump-forward-exit",ExitReason2.JumpBackward="jump-backward-exit",ExitReason2.SelectionOutside="selection-outside",ExitReason2),ChangeReason=((ChangeReason2=ChangeReason||{}).Start="start",ChangeReason2.Text="change-character",ChangeReason2.SelectionInside="selection-inside",ChangeReason2.Move="move",ChangeReason2.JumpBackward="jump-backward-change",ChangeReason2.JumpForward="jump-forward-change",ChangeReason2),exitJump=["jump-backward-exit","jump-forward-exit"],changeJump=["jump-backward-change","jump-forward-change"];function isValidMatch(match){return!!(match&&match.query.full.length>=match.suggester.matchOffset)}function isTextSelection(value){return(0,_remirror_core_helpers__WEBPACK_IMPORTED_MODULE_0__.Kn)(value)&&value instanceof prosemirror_state__WEBPACK_IMPORTED_MODULE_1__.Bs}function createMatchWithReason(props){let{match,changeReason,exitReason}=props;return{...match,changeReason,exitReason}}function findMatch(props){let{$pos,suggester}=props,{char,name,startOfLine,supportedCharacters,matchOffset,multiline,caseInsensitive,unicode}=suggester,regexp=function(props){let{char,matchOffset,startOfLine,supportedCharacters,captureChar=!0,caseInsensitive=!1,multiline=!1,unicode=!1}=props,flags=`g${multiline?"m":""}${caseInsensitive?"i":""}${unicode?"u":""}`,charRegex=((0,_remirror_core_helpers__WEBPACK_IMPORTED_MODULE_0__.HD)(char)?RegExp(escape_string_regexp__WEBPACK_IMPORTED_MODULE_2___default()(char)):char).source;return captureChar&&(charRegex=`(${charRegex})`),RegExp(`${startOfLine?"^":""}${charRegex}(?:${regexToString(supportedCharacters)}){${matchOffset},}`,flags)}({char,matchOffset,startOfLine,supportedCharacters,multiline,caseInsensitive,unicode}),text=$pos.doc.textBetween($pos.before(),$pos.end(),_remirror_core_constants__WEBPACK_IMPORTED_MODULE_3__.Vp,_remirror_core_constants__WEBPACK_IMPORTED_MODULE_3__.Vp);return function(props){let position;let{text,regexp,$pos,suggester}=props,start=$pos.start();return(0,_remirror_core_helpers__WEBPACK_IMPORTED_MODULE_0__.JD)(text,regexp).forEach(match=>{let matchPrefix=match.input.slice(Math.max(0,match.index-1),match.index);if(function(prefix,options){let{invalidPrefixCharacters,validPrefixCharacters}=options;if(invalidPrefixCharacters){let regex=RegExp(regexToString(invalidPrefixCharacters));return!regex.test(prefix)}{let regex1=RegExp(regexToString(validPrefixCharacters));return regex1.test(prefix)}}(matchPrefix,suggester)){let from=match.index+start,fullMatch=match[0],charMatch=match[1];if(!(0,_remirror_core_helpers__WEBPACK_IMPORTED_MODULE_0__.HD)(fullMatch)||!(0,_remirror_core_helpers__WEBPACK_IMPORTED_MODULE_0__.HD)(charMatch))return;let to=from+fullMatch.length,cursor=Math.min(to,$pos.pos),matchLength=cursor-from;from<$pos.pos&&to>=$pos.pos&&(position={range:{from,to,cursor},match,query:{partial:fullMatch.slice(charMatch.length,matchLength),full:fullMatch.slice(charMatch.length)},text:{partial:fullMatch.slice(0,matchLength),full:fullMatch},textAfter:$pos.doc.textBetween(to,$pos.end(),_remirror_core_constants__WEBPACK_IMPORTED_MODULE_3__.Vp,_remirror_core_constants__WEBPACK_IMPORTED_MODULE_3__.Vp),textBefore:$pos.doc.textBetween(start,from,_remirror_core_constants__WEBPACK_IMPORTED_MODULE_3__.Vp,_remirror_core_constants__WEBPACK_IMPORTED_MODULE_3__.Vp),suggester})}}),position}({suggester,text,regexp,$pos,char,name})}function recheckMatch(props){let{state,match}=props;try{return findMatch({$pos:state.doc.resolve(match.range.cursor),suggester:match.suggester})}catch{return}}function createInsertReason(props){let{prev,next,state}=props;return!next&&prev.range.from>=state.doc.nodeSize?{exit:createMatchWithReason({match:prev,exitReason:"delete"})}:next&&prev.query.partial?prev.range.to===next.range.cursor?{exit:createMatchWithReason({match:next,exitReason:"exit-end"})}:prev.query.partial?{exit:createMatchWithReason({match:next,exitReason:"exit-split"})}:{}:{exit:createMatchWithReason({match:prev,exitReason:"invalid-exit-split"})}}function hasParentNode($pos,types){for(let depth=$pos.depth;depth>0;depth--){let node=$pos.node(depth);if(types.includes(node.type.name))return!0}return!1}function markActiveInRange(resolvedRange,marks){let{$from,$to}=resolvedRange;return!!rangeHasMarks(resolvedRange,marks)||(0,_remirror_core_helpers__WEBPACK_IMPORTED_MODULE_0__.w6)($from.pos,$to.pos).some(value=>(function($pos,marks){let setOfMarks=new Set($pos.marks().map(mark=>mark.type.name));return marks.some(item=>setOfMarks.has(item))})($from.doc.resolve(value),marks))}function rangeHasMarks(resolvedRange,marks){var _a;let{$from,$to}=resolvedRange,setOfMarks=new Set((null!=(_a=$from.marksAcross($to))?_a:[]).map(mark=>mark.type.name));return marks.some(item=>setOfMarks.has(item))}function findFromSuggesters(props){let{suggesters,$pos,selectionEmpty}=props;for(let suggester of suggesters)if(!suggester.emptySelectionsOnly||selectionEmpty)try{let match=findMatch({suggester,$pos});if(!match)continue;let resolvedRange={$from:$pos.doc.resolve(match.range.from),$to:$pos.doc.resolve(match.range.to),$cursor:$pos};if(function(suggester,resolvedRange){let{$cursor}=resolvedRange,{validMarks,validNodes,invalidMarks,invalidNodes}=suggester;return!!(!validMarks&&!validNodes&&(0,_remirror_core_helpers__WEBPACK_IMPORTED_MODULE_0__.yD)(invalidMarks)&&(0,_remirror_core_helpers__WEBPACK_IMPORTED_MODULE_0__.yD)(invalidNodes))||!(validMarks&&!rangeHasMarks(resolvedRange,validMarks)||validNodes&&!hasParentNode($cursor,validNodes)||!validMarks&&markActiveInRange(resolvedRange,invalidMarks)||!validNodes&&hasParentNode($cursor,invalidNodes))}(suggester,resolvedRange)&&suggester.isValidPosition(resolvedRange,match))return match}catch{}}function regexToString(regexOrString){return(0,_remirror_core_helpers__WEBPACK_IMPORTED_MODULE_0__.Kj)(regexOrString)?regexOrString.source:regexOrString}var DEFAULT_SUGGESTER={appendTransaction:!1,priority:50,ignoredTag:"span",matchOffset:0,disableDecorations:!1,startOfLine:!1,suggestClassName:"suggest",suggestTag:"span",supportedCharacters:/\w+/,validPrefixCharacters:/^[\s\0]?$/,invalidPrefixCharacters:null,ignoredClassName:null,invalidMarks:[],invalidNodes:[],validMarks:null,validNodes:null,isValidPosition:()=>!0,checkNextValidSelection:null,emptySelectionsOnly:!1,caseInsensitive:!1,multiline:!1,unicode:!1,captureChar:!0},IGNORE_SUGGEST_META_KEY="__ignore_prosemirror_suggest_update__",_SuggestState=class{constructor(suggesters){__privateAdd(this,_docChanged,!1),__privateAdd(this,_ignoreNextExit,!1),__privateAdd(this,_suggesters,void 0),__privateAdd(this,_next,void 0),__privateAdd(this,_prev,void 0),__privateAdd(this,_handlerMatches,(0,_remirror_core_helpers__WEBPACK_IMPORTED_MODULE_0__.Ry)()),__publicField(this,"view"),__privateAdd(this,_ignored,prosemirror_view__WEBPACK_IMPORTED_MODULE_4__.EH.empty),__privateAdd(this,_removed,!1),__privateAdd(this,_lastChangeFromAppend,!1),__publicField(this,"setMarkRemoved",()=>{__privateSet(this,_removed,!0)}),__publicField(this,"findNextTextSelection",selection=>{let doc=selection.$from.doc,pos=Math.min(doc.nodeSize-2,selection.to+1),$pos=doc.resolve(pos),nextSelection=prosemirror_state__WEBPACK_IMPORTED_MODULE_1__.Y1.findFrom($pos,1,!0);if(isTextSelection(nextSelection))return nextSelection}),__publicField(this,"ignoreNextExit",()=>{__privateSet(this,_ignoreNextExit,!0)}),__publicField(this,"addIgnored",({from,name,specific=!1})=>{let suggester=__privateGet(this,_suggesters).find(value=>value.name===name);if(!suggester)throw Error(`No suggester exists for the name provided: ${name}`);let offset=(0,_remirror_core_helpers__WEBPACK_IMPORTED_MODULE_0__.HD)(suggester.char)?suggester.char.length:1,attributes=suggester.ignoredClassName?{class:suggester.ignoredClassName}:{},decoration=prosemirror_view__WEBPACK_IMPORTED_MODULE_4__.p.inline(from,from+offset,{nodeName:suggester.ignoredTag,...attributes},{name,specific,char:suggester.char});__privateSet(this,_ignored,__privateGet(this,_ignored).add(this.view.state.doc,[decoration]))}),__publicField(this,"removeIgnored",({from,name})=>{let suggester=__privateGet(this,_suggesters).find(value=>value.name===name);if(!suggester)throw Error(`No suggester exists for the name provided: ${name}`);let offset=(0,_remirror_core_helpers__WEBPACK_IMPORTED_MODULE_0__.HD)(suggester.char)?suggester.char.length:1,decoration=__privateGet(this,_ignored).find(from,from+offset)[0];decoration&&decoration.spec.name===name&&__privateSet(this,_ignored,__privateGet(this,_ignored).remove([decoration]))}),__publicField(this,"clearIgnored",name=>{if(!name){__privateSet(this,_ignored,prosemirror_view__WEBPACK_IMPORTED_MODULE_4__.EH.empty);return}let decorations=__privateGet(this,_ignored).find(),decorationsToClear=decorations.filter(({spec})=>spec.name===name);__privateSet(this,_ignored,__privateGet(this,_ignored).remove(decorationsToClear))}),__publicField(this,"findMatchAtPosition",($pos,name)=>{let suggesters=name?__privateGet(this,_suggesters).filter(suggester=>suggester.name===name):__privateGet(this,_suggesters);return findFromSuggesters({suggesters,$pos,docChanged:!1,selectionEmpty:!0})}),__publicField(this,"setLastChangeFromAppend",()=>{__privateSet(this,_lastChangeFromAppend,!0)});let mapper=createSuggesterMapper();__privateSet(this,_suggesters,suggesters.map(mapper)),__privateSet(this,_suggesters,(0,_remirror_core_helpers__WEBPACK_IMPORTED_MODULE_0__.DY)(__privateGet(this,_suggesters),(a,b)=>b.priority-a.priority))}static create(suggesters){return new _SuggestState(suggesters)}get decorationSet(){return __privateGet(this,_ignored)}get removed(){return __privateGet(this,_removed)}get match(){return __privateGet(this,_next)?__privateGet(this,_next):__privateGet(this,_prev)&&__privateGet(this,_handlerMatches).exit?__privateGet(this,_prev):void 0}init(view){return this.view=view,this}createProps(match){let{name,char}=match.suggester;return{view:this.view,addIgnored:this.addIgnored,clearIgnored:this.clearIgnored,ignoreNextExit:this.ignoreNextExit,setMarkRemoved:this.setMarkRemoved,name,char,...match}}shouldRunExit(){return!__privateGet(this,_ignoreNextExit)||(__privateSet(this,_ignoreNextExit,!1),!1)}updateWithNextSelection(tr){var _a,_b,_c;let nextSelection=this.findNextTextSelection(tr.selection);if(nextSelection)for(let suggester of __privateGet(this,_suggesters)){let change=null==(_a=__privateGet(this,_handlerMatches).change)?void 0:_a.suggester.name,exit=null==(_b=__privateGet(this,_handlerMatches).exit)?void 0:_b.suggester.name;null==(_c=suggester.checkNextValidSelection)||_c.call(suggester,nextSelection.$from,tr,{change,exit})}}changeHandler(tr,appendTransaction){var map,_a,_b;let{change,exit}=__privateGet(this,_handlerMatches),match=this.match;if(!change&&!exit||!isValidMatch(match))return;let shouldRunExit=appendTransaction===(null==exit?void 0:exit.suggester.appendTransaction)&&this.shouldRunExit(),shouldRunChange=appendTransaction===(null==change?void 0:change.suggester.appendTransaction);if(shouldRunExit||shouldRunChange){if(change&&exit&&(map={change,exit},(0,_remirror_core_helpers__WEBPACK_IMPORTED_MODULE_0__.q9)(exitJump,null==(_a=map.exit)?void 0:_a.exitReason)||(0,_remirror_core_helpers__WEBPACK_IMPORTED_MODULE_0__.q9)(changeJump,null==(_b=map.change)?void 0:_b.changeReason))){let exitDetails=this.createProps(exit),changeDetails=this.createProps(change);exit.range.from,change.range.from,shouldRunExit&&exit.suggester.onChange(exitDetails,tr),shouldRunChange&&change.suggester.onChange(changeDetails,tr),shouldRunExit&&__privateSet(this,_removed,!1);return}change&&shouldRunChange&&change.suggester.onChange(this.createProps(change),tr),exit&&shouldRunExit&&(exit.suggester.onChange(this.createProps(exit),tr),__privateSet(this,_removed,!1),"invalid-exit-split"===exit.exitReason&&__privateSet(this,_handlerMatches,(0,_remirror_core_helpers__WEBPACK_IMPORTED_MODULE_0__.Ry)()))}}mapIgnoredDecorations(tr){let ignored=__privateGet(this,_ignored).map(tr.mapping,tr.doc),decorations=ignored.find(),invalid=decorations.filter(({from,to,spec})=>{let charLength=(0,_remirror_core_helpers__WEBPACK_IMPORTED_MODULE_0__.HD)(spec.char)?spec.char.length:1;return to-from!==charLength});__privateSet(this,_ignored,ignored.remove(invalid))}shouldIgnoreMatch({range:range2,suggester:{name}}){let decorations=__privateGet(this,_ignored).find(),shouldIgnore=decorations.some(({spec,from})=>from===range2.from&&(!spec.specific||spec.name===name));return shouldIgnore}resetState(){__privateSet(this,_handlerMatches,(0,_remirror_core_helpers__WEBPACK_IMPORTED_MODULE_0__.Ry)()),__privateSet(this,_next,void 0),__privateSet(this,_removed,!1),__privateSet(this,_lastChangeFromAppend,!1)}updateReasons(props){let{$pos,state}=props,docChanged=__privateGet(this,_docChanged),suggesters=__privateGet(this,_suggesters),selectionEmpty=state.selection.empty,match=isTextSelection(state.selection)?findFromSuggesters({suggesters,$pos,docChanged,selectionEmpty}):void 0;__privateSet(this,_next,match&&this.shouldIgnoreMatch(match)?void 0:match),__privateSet(this,_handlerMatches,function(props){let{prev,next,state,$pos}=props,value=(0,_remirror_core_helpers__WEBPACK_IMPORTED_MODULE_0__.Ry)();if(!prev&&!next)return value;let compare={prev,next};return compare.prev&&compare.next&&compare.prev.range.from!==compare.next.range.from?function(props){let{prev,next,state}=props,value=(0,_remirror_core_helpers__WEBPACK_IMPORTED_MODULE_0__.Ry)(),updatedPrevious=recheckMatch({state,match:prev}),{exit}=updatedPrevious&&updatedPrevious.query.full!==prev.query.full?createInsertReason({prev,next:updatedPrevious,state}):value,isJumpForward=prev.range.from<next.range.from;return isJumpForward?{exit:null!=exit?exit:createMatchWithReason({match:prev,exitReason:"jump-forward-exit"}),change:createMatchWithReason({match:next,changeReason:"jump-forward-change"})}:{exit:null!=exit?exit:createMatchWithReason({match:prev,exitReason:"jump-backward-exit"}),change:createMatchWithReason({match:next,changeReason:"jump-backward-change"})}}({prev:compare.prev,next:compare.next,state}):!compare.prev&&compare.next?{change:createMatchWithReason({match:compare.next,changeReason:"start"})}:compare.prev&&!compare.next?function(props){let{match,state,$pos}=props,{selection}=state,updatedPrevious=recheckMatch({match,state});return updatedPrevious&&updatedPrevious.text.full===match.text.full?!selection.empty&&(selection.from<=match.range.from||selection.to>=match.range.to)?{exit:createMatchWithReason({match,exitReason:"selection-outside"})}:$pos.pos>match.range.to?{exit:createMatchWithReason({match,exitReason:"move-end"})}:$pos.pos<=match.range.from?{exit:createMatchWithReason({match,exitReason:"move-start"})}:{}:createInsertReason({prev:match,next:updatedPrevious,state})}({$pos,match:compare.prev,state}):compare.prev&&compare.next&&compare.prev.text.full!==compare.next.text.full?{change:createMatchWithReason({match:compare.next,changeReason:"change-character"})}:compare.prev&&compare.next&&compare.prev.range.cursor!==compare.next.range.cursor?{change:createMatchWithReason({match:compare.next,changeReason:state.selection.empty?"move":"selection-inside"})}:value}({next:__privateGet(this,_next),prev:__privateGet(this,_prev),state,$pos}))}addSuggester(suggester){let previous=__privateGet(this,_suggesters).find(item=>item.name===suggester.name),mapper=createSuggesterMapper();if(previous)__privateSet(this,_suggesters,__privateGet(this,_suggesters).map(item=>item===previous?mapper(suggester):item));else{let suggesters=[...__privateGet(this,_suggesters),mapper(suggester)];__privateSet(this,_suggesters,(0,_remirror_core_helpers__WEBPACK_IMPORTED_MODULE_0__.DY)(suggesters,(a,b)=>b.priority-a.priority))}return()=>this.removeSuggester(suggester.name)}removeSuggester(suggester){let name=(0,_remirror_core_helpers__WEBPACK_IMPORTED_MODULE_0__.HD)(suggester)?suggester:suggester.name;__privateSet(this,_suggesters,__privateGet(this,_suggesters).filter(item=>item.name!==name)),this.clearIgnored(name)}toJSON(){return this.match}apply(props){let{exit,change}=__privateGet(this,_handlerMatches);if(__privateGet(this,_lastChangeFromAppend)&&(__privateSet(this,_lastChangeFromAppend,!1),!(null==exit?void 0:exit.suggester.appendTransaction)&&!(null==change?void 0:change.suggester.appendTransaction)))return this;let{tr,state}=props,transactionHasChanged=tr.docChanged||tr.selectionSet,shouldIgnoreUpdate=tr.getMeta(IGNORE_SUGGEST_META_KEY);return!shouldIgnoreUpdate&&(transactionHasChanged||__privateGet(this,_removed))&&(__privateSet(this,_docChanged,tr.docChanged),this.mapIgnoredDecorations(tr),exit&&this.resetState(),__privateSet(this,_prev,__privateGet(this,_next)),this.updateReasons({$pos:tr.selection.$from,state})),this}createDecorations(state){let match=this.match;if(!isValidMatch(match))return __privateGet(this,_ignored);let{disableDecorations}=match.suggester,shouldSkip=(0,_remirror_core_helpers__WEBPACK_IMPORTED_MODULE_0__.mf)(disableDecorations)?disableDecorations(state,match):disableDecorations;if(shouldSkip)return __privateGet(this,_ignored);let{range:range2,suggester}=match,{name,suggestTag,suggestClassName}=suggester,{from,to}=range2;return this.shouldIgnoreMatch(match)?__privateGet(this,_ignored):__privateGet(this,_ignored).add(state.doc,[prosemirror_view__WEBPACK_IMPORTED_MODULE_4__.p.inline(from,to,{nodeName:suggestTag,class:name?`${suggestClassName} suggest-${name}`:suggestClassName},{name})])}};function createSuggesterMapper(){let names=new Set;return suggester=>{if(names.has(suggester.name))throw Error(`A suggester already exists with the name '${suggester.name}'. The name provided must be unique.`);let suggesterWithDefaults={...DEFAULT_SUGGESTER,...suggester};return names.add(suggester.name),suggesterWithDefaults}}_docChanged=new WeakMap,_ignoreNextExit=new WeakMap,_suggesters=new WeakMap,_next=new WeakMap,_prev=new WeakMap,_handlerMatches=new WeakMap,_ignored=new WeakMap,_removed=new WeakMap,_lastChangeFromAppend=new WeakMap;var suggestPluginKey=new prosemirror_state__WEBPACK_IMPORTED_MODULE_1__.H$("suggest");function getSuggestPluginState(state){return suggestPluginKey.getState(state)}function addSuggester(state,suggester){return getSuggestPluginState(state).addSuggester(suggester)}function ignoreUpdateForSuggest(tr){tr.setMeta(IGNORE_SUGGEST_META_KEY,!0)}function removeSuggester(state,suggester){return getSuggestPluginState(state).removeSuggester(suggester)}function suggest(...suggesters){let pluginState=_SuggestState.create(suggesters);return new prosemirror_state__WEBPACK_IMPORTED_MODULE_1__.Sy({key:suggestPluginKey,view:view=>(pluginState.init(view),{update:view2=>pluginState.changeHandler(view2.state.tr,!1)}),state:{init:()=>pluginState,apply:(tr,_pluginState,_oldState,state)=>pluginState.apply({tr,state})},appendTransaction(_,__,state){let tr=state.tr;return(pluginState.updateWithNextSelection(tr),pluginState.changeHandler(tr,!0),tr.docChanged||tr.steps.length>0||tr.selectionSet||tr.storedMarksSet)?(pluginState.setLastChangeFromAppend(),tr):null},props:{decorations:state=>pluginState.createDecorations(state)}})}},4882:function(module){module.exports=string=>{if("string"!=typeof string)throw TypeError("Expected a string");return string.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}},21692:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{Ax:function(){return canSplit},FC:function(){return ReplaceAroundStep},Mn:function(){return canJoin},Pu:function(){return ReplaceStep},WJ:function(){return AddMarkStep},Yo:function(){return insertPoint},dR:function(){return replaceStep},h8:function(){return Step},k9:function(){return liftTarget},nd:function(){return findWrapping},nj:function(){return dropPoint},oo:function(){return StepResult},vs:function(){return Mapping},wx:function(){return Transform},xu:function(){return RemoveMarkStep}});var prosemirror_model__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(57981);class MapResult{constructor(pos,delInfo,recover){this.pos=pos,this.delInfo=delInfo,this.recover=recover}get deleted(){return(8&this.delInfo)>0}get deletedBefore(){return(5&this.delInfo)>0}get deletedAfter(){return(6&this.delInfo)>0}get deletedAcross(){return(4&this.delInfo)>0}}class StepMap{constructor(ranges,inverted=!1){if(this.ranges=ranges,this.inverted=inverted,!ranges.length&&StepMap.empty)return StepMap.empty}recover(value){let diff=0,index=65535&value;if(!this.inverted)for(let i=0;i<index;i++)diff+=this.ranges[3*i+2]-this.ranges[3*i+1];return this.ranges[3*index]+diff+(value-(65535&value))/65536}mapResult(pos,assoc=1){return this._map(pos,assoc,!1)}map(pos,assoc=1){return this._map(pos,assoc,!0)}_map(pos,assoc,simple){let diff=0,oldIndex=this.inverted?2:1,newIndex=this.inverted?1:2;for(let i=0;i<this.ranges.length;i+=3){let start=this.ranges[i]-(this.inverted?diff:0);if(start>pos)break;let oldSize=this.ranges[i+oldIndex],newSize=this.ranges[i+newIndex],end=start+oldSize;if(pos<=end){let side=oldSize?pos==start?-1:pos==end?1:assoc:assoc,result=start+diff+(side<0?0:newSize);if(simple)return result;let recover=pos==(assoc<0?start:end)?null:i/3+(pos-start)*65536,del=pos==start?2:pos==end?1:4;return(assoc<0?pos!=start:pos!=end)&&(del|=8),new MapResult(result,del,recover)}diff+=newSize-oldSize}return simple?pos+diff:new MapResult(pos+diff,0,null)}touches(pos,recover){let diff=0,index=65535&recover,oldIndex=this.inverted?2:1,newIndex=this.inverted?1:2;for(let i=0;i<this.ranges.length;i+=3){let start=this.ranges[i]-(this.inverted?diff:0);if(start>pos)break;let oldSize=this.ranges[i+oldIndex];if(pos<=start+oldSize&&i==3*index)return!0;diff+=this.ranges[i+newIndex]-oldSize}return!1}forEach(f){let oldIndex=this.inverted?2:1,newIndex=this.inverted?1:2;for(let i=0,diff=0;i<this.ranges.length;i+=3){let start=this.ranges[i],oldStart=start-(this.inverted?diff:0),newStart=start+(this.inverted?0:diff),oldSize=this.ranges[i+oldIndex],newSize=this.ranges[i+newIndex];f(oldStart,oldStart+oldSize,newStart,newStart+newSize),diff+=newSize-oldSize}}invert(){return new StepMap(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(n){return 0==n?StepMap.empty:new StepMap(n<0?[0,-n,0]:[0,0,n])}}StepMap.empty=new StepMap([]);class Mapping{constructor(maps=[],mirror,from=0,to=maps.length){this.maps=maps,this.mirror=mirror,this.from=from,this.to=to}slice(from=0,to=this.maps.length){return new Mapping(this.maps,this.mirror,from,to)}copy(){return new Mapping(this.maps.slice(),this.mirror&&this.mirror.slice(),this.from,this.to)}appendMap(map,mirrors){this.to=this.maps.push(map),null!=mirrors&&this.setMirror(this.maps.length-1,mirrors)}appendMapping(mapping){for(let i=0,startSize=this.maps.length;i<mapping.maps.length;i++){let mirr=mapping.getMirror(i);this.appendMap(mapping.maps[i],null!=mirr&&mirr<i?startSize+mirr:void 0)}}getMirror(n){if(this.mirror){for(let i=0;i<this.mirror.length;i++)if(this.mirror[i]==n)return this.mirror[i+(i%2?-1:1)]}}setMirror(n,m){this.mirror||(this.mirror=[]),this.mirror.push(n,m)}appendMappingInverted(mapping){for(let i=mapping.maps.length-1,totalSize=this.maps.length+mapping.maps.length;i>=0;i--){let mirr=mapping.getMirror(i);this.appendMap(mapping.maps[i].invert(),null!=mirr&&mirr>i?totalSize-mirr-1:void 0)}}invert(){let inverse=new Mapping;return inverse.appendMappingInverted(this),inverse}map(pos,assoc=1){if(this.mirror)return this._map(pos,assoc,!0);for(let i=this.from;i<this.to;i++)pos=this.maps[i].map(pos,assoc);return pos}mapResult(pos,assoc=1){return this._map(pos,assoc,!1)}_map(pos,assoc,simple){let delInfo=0;for(let i=this.from;i<this.to;i++){let result=this.maps[i].mapResult(pos,assoc);if(null!=result.recover){let corr=this.getMirror(i);if(null!=corr&&corr>i&&corr<this.to){i=corr,pos=this.maps[corr].recover(result.recover);continue}}delInfo|=result.delInfo,pos=result.pos}return simple?pos:new MapResult(pos,delInfo,null)}}let stepsByID=Object.create(null);class Step{getMap(){return StepMap.empty}merge(other){return null}static fromJSON(schema,json){if(!json||!json.stepType)throw RangeError("Invalid input for Step.fromJSON");let type=stepsByID[json.stepType];if(!type)throw RangeError(`No step type ${json.stepType} defined`);return type.fromJSON(schema,json)}static jsonID(id,stepClass){if(id in stepsByID)throw RangeError("Duplicate use of step JSON ID "+id);return stepsByID[id]=stepClass,stepClass.prototype.jsonID=id,stepClass}}class StepResult{constructor(doc,failed){this.doc=doc,this.failed=failed}static ok(doc){return new StepResult(doc,null)}static fail(message){return new StepResult(null,message)}static fromReplace(doc,from,to,slice){try{return StepResult.ok(doc.replace(from,to,slice))}catch(e){if(e instanceof prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.e4)return StepResult.fail(e.message);throw e}}}function mapFragment(fragment,f,parent){let mapped=[];for(let i=0;i<fragment.childCount;i++){let child=fragment.child(i);child.content.size&&(child=child.copy(mapFragment(child.content,f,child))),child.isInline&&(child=f(child,parent,i)),mapped.push(child)}return prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.HY.fromArray(mapped)}class AddMarkStep extends Step{constructor(from,to,mark){super(),this.from=from,this.to=to,this.mark=mark}apply(doc){let oldSlice=doc.slice(this.from,this.to),$from=doc.resolve(this.from),parent=$from.node($from.sharedDepth(this.to)),slice=new prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.p2(mapFragment(oldSlice.content,(node,parent)=>node.isAtom&&parent.type.allowsMarkType(this.mark.type)?node.mark(this.mark.addToSet(node.marks)):node,parent),oldSlice.openStart,oldSlice.openEnd);return StepResult.fromReplace(doc,this.from,this.to,slice)}invert(){return new RemoveMarkStep(this.from,this.to,this.mark)}map(mapping){let from=mapping.mapResult(this.from,1),to=mapping.mapResult(this.to,-1);return from.deleted&&to.deleted||from.pos>=to.pos?null:new AddMarkStep(from.pos,to.pos,this.mark)}merge(other){return other instanceof AddMarkStep&&other.mark.eq(this.mark)&&this.from<=other.to&&this.to>=other.from?new AddMarkStep(Math.min(this.from,other.from),Math.max(this.to,other.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(schema,json){if("number"!=typeof json.from||"number"!=typeof json.to)throw RangeError("Invalid input for AddMarkStep.fromJSON");return new AddMarkStep(json.from,json.to,schema.markFromJSON(json.mark))}}Step.jsonID("addMark",AddMarkStep);class RemoveMarkStep extends Step{constructor(from,to,mark){super(),this.from=from,this.to=to,this.mark=mark}apply(doc){let oldSlice=doc.slice(this.from,this.to),slice=new prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.p2(mapFragment(oldSlice.content,node=>node.mark(this.mark.removeFromSet(node.marks)),doc),oldSlice.openStart,oldSlice.openEnd);return StepResult.fromReplace(doc,this.from,this.to,slice)}invert(){return new AddMarkStep(this.from,this.to,this.mark)}map(mapping){let from=mapping.mapResult(this.from,1),to=mapping.mapResult(this.to,-1);return from.deleted&&to.deleted||from.pos>=to.pos?null:new RemoveMarkStep(from.pos,to.pos,this.mark)}merge(other){return other instanceof RemoveMarkStep&&other.mark.eq(this.mark)&&this.from<=other.to&&this.to>=other.from?new RemoveMarkStep(Math.min(this.from,other.from),Math.max(this.to,other.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(schema,json){if("number"!=typeof json.from||"number"!=typeof json.to)throw RangeError("Invalid input for RemoveMarkStep.fromJSON");return new RemoveMarkStep(json.from,json.to,schema.markFromJSON(json.mark))}}Step.jsonID("removeMark",RemoveMarkStep);class AddNodeMarkStep extends Step{constructor(pos,mark){super(),this.pos=pos,this.mark=mark}apply(doc){let node=doc.nodeAt(this.pos);if(!node)return StepResult.fail("No node at mark step's position");let updated=node.type.create(node.attrs,null,this.mark.addToSet(node.marks));return StepResult.fromReplace(doc,this.pos,this.pos+1,new prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.p2(prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.HY.from(updated),0,node.isLeaf?0:1))}invert(doc){let node=doc.nodeAt(this.pos);if(node){let newSet=this.mark.addToSet(node.marks);if(newSet.length==node.marks.length){for(let i=0;i<node.marks.length;i++)if(!node.marks[i].isInSet(newSet))return new AddNodeMarkStep(this.pos,node.marks[i]);return new AddNodeMarkStep(this.pos,this.mark)}}return new RemoveNodeMarkStep(this.pos,this.mark)}map(mapping){let pos=mapping.mapResult(this.pos,1);return pos.deletedAfter?null:new AddNodeMarkStep(pos.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(schema,json){if("number"!=typeof json.pos)throw RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new AddNodeMarkStep(json.pos,schema.markFromJSON(json.mark))}}Step.jsonID("addNodeMark",AddNodeMarkStep);class RemoveNodeMarkStep extends Step{constructor(pos,mark){super(),this.pos=pos,this.mark=mark}apply(doc){let node=doc.nodeAt(this.pos);if(!node)return StepResult.fail("No node at mark step's position");let updated=node.type.create(node.attrs,null,this.mark.removeFromSet(node.marks));return StepResult.fromReplace(doc,this.pos,this.pos+1,new prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.p2(prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.HY.from(updated),0,node.isLeaf?0:1))}invert(doc){let node=doc.nodeAt(this.pos);return node&&this.mark.isInSet(node.marks)?new AddNodeMarkStep(this.pos,this.mark):this}map(mapping){let pos=mapping.mapResult(this.pos,1);return pos.deletedAfter?null:new RemoveNodeMarkStep(pos.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(schema,json){if("number"!=typeof json.pos)throw RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new RemoveNodeMarkStep(json.pos,schema.markFromJSON(json.mark))}}Step.jsonID("removeNodeMark",RemoveNodeMarkStep);class ReplaceStep extends Step{constructor(from,to,slice,structure=!1){super(),this.from=from,this.to=to,this.slice=slice,this.structure=structure}apply(doc){return this.structure&&contentBetween(doc,this.from,this.to)?StepResult.fail("Structure replace would overwrite content"):StepResult.fromReplace(doc,this.from,this.to,this.slice)}getMap(){return new StepMap([this.from,this.to-this.from,this.slice.size])}invert(doc){return new ReplaceStep(this.from,this.from+this.slice.size,doc.slice(this.from,this.to))}map(mapping){let from=mapping.mapResult(this.from,1),to=mapping.mapResult(this.to,-1);return from.deletedAcross&&to.deletedAcross?null:new ReplaceStep(from.pos,Math.max(from.pos,to.pos),this.slice)}merge(other){if(!(other instanceof ReplaceStep)||other.structure||this.structure)return null;if(this.from+this.slice.size!=other.from||this.slice.openEnd||other.slice.openStart){if(other.to!=this.from||this.slice.openStart||other.slice.openEnd)return null;{let slice=this.slice.size+other.slice.size==0?prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.p2.empty:new prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.p2(other.slice.content.append(this.slice.content),other.slice.openStart,this.slice.openEnd);return new ReplaceStep(other.from,this.to,slice,this.structure)}}{let slice1=this.slice.size+other.slice.size==0?prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.p2.empty:new prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.p2(this.slice.content.append(other.slice.content),this.slice.openStart,other.slice.openEnd);return new ReplaceStep(this.from,this.to+(other.to-other.from),slice1,this.structure)}}toJSON(){let json={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(json.slice=this.slice.toJSON()),this.structure&&(json.structure=!0),json}static fromJSON(schema,json){if("number"!=typeof json.from||"number"!=typeof json.to)throw RangeError("Invalid input for ReplaceStep.fromJSON");return new ReplaceStep(json.from,json.to,prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.p2.fromJSON(schema,json.slice),!!json.structure)}}Step.jsonID("replace",ReplaceStep);class ReplaceAroundStep extends Step{constructor(from,to,gapFrom,gapTo,slice,insert,structure=!1){super(),this.from=from,this.to=to,this.gapFrom=gapFrom,this.gapTo=gapTo,this.slice=slice,this.insert=insert,this.structure=structure}apply(doc){if(this.structure&&(contentBetween(doc,this.from,this.gapFrom)||contentBetween(doc,this.gapTo,this.to)))return StepResult.fail("Structure gap-replace would overwrite content");let gap=doc.slice(this.gapFrom,this.gapTo);if(gap.openStart||gap.openEnd)return StepResult.fail("Gap is not a flat range");let inserted=this.slice.insertAt(this.insert,gap.content);return inserted?StepResult.fromReplace(doc,this.from,this.to,inserted):StepResult.fail("Content does not fit in gap")}getMap(){return new StepMap([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(doc){let gap=this.gapTo-this.gapFrom;return new ReplaceAroundStep(this.from,this.from+this.slice.size+gap,this.from+this.insert,this.from+this.insert+gap,doc.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(mapping){let from=mapping.mapResult(this.from,1),to=mapping.mapResult(this.to,-1),gapFrom=mapping.map(this.gapFrom,-1),gapTo=mapping.map(this.gapTo,1);return from.deletedAcross&&to.deletedAcross||gapFrom<from.pos||gapTo>to.pos?null:new ReplaceAroundStep(from.pos,to.pos,gapFrom,gapTo,this.slice,this.insert,this.structure)}toJSON(){let json={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(json.slice=this.slice.toJSON()),this.structure&&(json.structure=!0),json}static fromJSON(schema,json){if("number"!=typeof json.from||"number"!=typeof json.to||"number"!=typeof json.gapFrom||"number"!=typeof json.gapTo||"number"!=typeof json.insert)throw RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new ReplaceAroundStep(json.from,json.to,json.gapFrom,json.gapTo,prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.p2.fromJSON(schema,json.slice),json.insert,!!json.structure)}}function contentBetween(doc,from,to){let $from=doc.resolve(from),dist=to-from,depth=$from.depth;for(;dist>0&&depth>0&&$from.indexAfter(depth)==$from.node(depth).childCount;)depth--,dist--;if(dist>0){let next=$from.node(depth).maybeChild($from.indexAfter(depth));for(;dist>0;){if(!next||next.isLeaf)return!0;next=next.firstChild,dist--}}return!1}function liftTarget(range){let content=range.parent.content.cutByIndex(range.startIndex,range.endIndex);for(let depth=range.depth;;--depth){let node=range.$from.node(depth),index=range.$from.index(depth),endIndex=range.$to.indexAfter(depth);if(depth<range.depth&&node.canReplace(index,endIndex,content))return depth;if(0==depth||node.type.spec.isolating||!((0==index||node.canReplace(index,node.childCount))&&(endIndex==node.childCount||node.canReplace(0,endIndex))))break}return null}function findWrapping(range,nodeType,attrs=null,innerRange=range){let around=function(range,type){let{parent,startIndex,endIndex}=range,around=parent.contentMatchAt(startIndex).findWrapping(type);if(!around)return null;let outer=around.length?around[0]:type;return parent.canReplaceWith(startIndex,endIndex,outer)?around:null}(range,nodeType),inner=around&&function(range,type){let{parent,startIndex,endIndex}=range,inner=parent.child(startIndex),inside=type.contentMatch.findWrapping(inner.type);if(!inside)return null;let innerMatch=(inside.length?inside[inside.length-1]:type).contentMatch;for(let i=startIndex;innerMatch&&i<endIndex;i++)innerMatch=innerMatch.matchType(parent.child(i).type);return innerMatch&&innerMatch.validEnd?inside:null}(innerRange,nodeType);return inner?around.map(withAttrs).concat({type:nodeType,attrs}).concat(inner.map(withAttrs)):null}function withAttrs(type){return{type,attrs:null}}function canSplit(doc,pos,depth=1,typesAfter){let $pos=doc.resolve(pos),base=$pos.depth-depth,innerType=typesAfter&&typesAfter[typesAfter.length-1]||$pos.parent;if(base<0||$pos.parent.type.spec.isolating||!$pos.parent.canReplace($pos.index(),$pos.parent.childCount)||!innerType.type.validContent($pos.parent.content.cutByIndex($pos.index(),$pos.parent.childCount)))return!1;for(let d=$pos.depth-1,i=depth-2;d>base;d--,i--){let node=$pos.node(d),index=$pos.index(d);if(node.type.spec.isolating)return!1;let rest=node.content.cutByIndex(index,node.childCount),after=typesAfter&&typesAfter[i]||node;if(after!=node&&(rest=rest.replaceChild(0,after.type.create(after.attrs))),!node.canReplace(index+1,node.childCount)||!after.type.validContent(rest))return!1}let index1=$pos.indexAfter(base),baseType=typesAfter&&typesAfter[0];return $pos.node(base).canReplaceWith(index1,index1,baseType?baseType.type:$pos.node(base+1).type)}function canJoin(doc,pos){var a,b;let $pos=doc.resolve(pos),index=$pos.index();return a=$pos.nodeBefore,b=$pos.nodeAfter,!!(a&&b&&!a.isLeaf&&a.canAppend(b))&&$pos.parent.canReplace(index,index+1)}function insertPoint(doc,pos,nodeType){let $pos=doc.resolve(pos);if($pos.parent.canReplaceWith($pos.index(),$pos.index(),nodeType))return pos;if(0==$pos.parentOffset)for(let d=$pos.depth-1;d>=0;d--){let index=$pos.index(d);if($pos.node(d).canReplaceWith(index,index,nodeType))return $pos.before(d+1);if(index>0)return null}if($pos.parentOffset==$pos.parent.content.size)for(let d1=$pos.depth-1;d1>=0;d1--){let index1=$pos.indexAfter(d1);if($pos.node(d1).canReplaceWith(index1,index1,nodeType))return $pos.after(d1+1);if(index1<$pos.node(d1).childCount)break}return null}function dropPoint(doc,pos,slice){let $pos=doc.resolve(pos);if(!slice.content.size)return pos;let content=slice.content;for(let i=0;i<slice.openStart;i++)content=content.firstChild.content;for(let pass=1;pass<=(0==slice.openStart&&slice.size?2:1);pass++)for(let d=$pos.depth;d>=0;d--){let bias=d==$pos.depth?0:$pos.pos<=($pos.start(d+1)+$pos.end(d+1))/2?-1:1,insertPos=$pos.index(d)+(bias>0?1:0),parent=$pos.node(d),fits=!1;if(1==pass)fits=parent.canReplace(insertPos,insertPos,content);else{let wrapping=parent.contentMatchAt(insertPos).findWrapping(content.firstChild.type);fits=wrapping&&parent.canReplaceWith(insertPos,insertPos,wrapping[0])}if(fits)return 0==bias?$pos.pos:bias<0?$pos.before(d+1):$pos.after(d+1)}return null}function replaceStep(doc,from,to=from,slice=prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.p2.empty){if(from==to&&!slice.size)return null;let $from=doc.resolve(from),$to=doc.resolve(to);return fitsTrivially($from,$to,slice)?new ReplaceStep(from,to,slice):new Fitter($from,$to,slice).fit()}function fitsTrivially($from,$to,slice){return!slice.openStart&&!slice.openEnd&&$from.start()==$to.start()&&$from.parent.canReplace($from.index(),$to.index(),slice.content)}Step.jsonID("replaceAround",ReplaceAroundStep);class Fitter{constructor($from,$to,unplaced){this.$from=$from,this.$to=$to,this.unplaced=unplaced,this.frontier=[],this.placed=prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.HY.empty;for(let i=0;i<=$from.depth;i++){let node=$from.node(i);this.frontier.push({type:node.type,match:node.contentMatchAt($from.indexAfter(i))})}for(let i1=$from.depth;i1>0;i1--)this.placed=prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.HY.from($from.node(i1).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let fit=this.findFittable();fit?this.placeNodes(fit):this.openMore()||this.dropNode()}let moveInline=this.mustMoveInline(),placedSize=this.placed.size-this.depth-this.$from.depth,$from=this.$from,$to=this.close(moveInline<0?this.$to:$from.doc.resolve(moveInline));if(!$to)return null;let content=this.placed,openStart=$from.depth,openEnd=$to.depth;for(;openStart&&openEnd&&1==content.childCount;)content=content.firstChild.content,openStart--,openEnd--;let slice=new prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.p2(content,openStart,openEnd);return moveInline>-1?new ReplaceAroundStep($from.pos,moveInline,this.$to.pos,this.$to.end(),slice,placedSize):slice.size||$from.pos!=this.$to.pos?new ReplaceStep($from.pos,$to.pos,slice):null}findFittable(){let startDepth=this.unplaced.openStart;for(let cur=this.unplaced.content,d=0,openEnd=this.unplaced.openEnd;d<startDepth;d++){let node=cur.firstChild;if(cur.childCount>1&&(openEnd=0),node.type.spec.isolating&&openEnd<=d){startDepth=d;break}cur=node.content}for(let pass=1;pass<=2;pass++)for(let sliceDepth=1==pass?startDepth:this.unplaced.openStart;sliceDepth>=0;sliceDepth--){let parent=null,first=(sliceDepth?(parent=contentAt(this.unplaced.content,sliceDepth-1).firstChild).content:this.unplaced.content).firstChild;for(let frontierDepth=this.depth;frontierDepth>=0;frontierDepth--){let{type,match}=this.frontier[frontierDepth],wrap,inject=null;if(1==pass&&(first?match.matchType(first.type)||(inject=match.fillBefore(prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.HY.from(first),!1)):parent&&type.compatibleContent(parent.type)))return{sliceDepth,frontierDepth,parent,inject};if(2==pass&&first&&(wrap=match.findWrapping(first.type)))return{sliceDepth,frontierDepth,parent,wrap};if(parent&&match.matchType(parent.type))break}}}openMore(){let{content,openStart,openEnd}=this.unplaced,inner=contentAt(content,openStart);return!!inner.childCount&&!inner.firstChild.isLeaf&&(this.unplaced=new prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.p2(content,openStart+1,Math.max(openEnd,inner.size+openStart>=content.size-openEnd?openStart+1:0)),!0)}dropNode(){let{content,openStart,openEnd}=this.unplaced,inner=contentAt(content,openStart);if(inner.childCount<=1&&openStart>0){let openAtEnd=content.size-openStart<=openStart+inner.size;this.unplaced=new prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.p2(dropFromFragment(content,openStart-1,1),openStart-1,openAtEnd?openStart-1:openEnd)}else this.unplaced=new prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.p2(dropFromFragment(content,openStart,1),openStart,openEnd)}placeNodes({sliceDepth,frontierDepth,parent,inject,wrap}){for(;this.depth>frontierDepth;)this.closeFrontierNode();if(wrap)for(let i=0;i<wrap.length;i++)this.openFrontierNode(wrap[i]);let slice=this.unplaced,fragment=parent?parent.content:slice.content,openStart=slice.openStart-sliceDepth,taken=0,add=[],{match,type}=this.frontier[frontierDepth];if(inject){for(let i1=0;i1<inject.childCount;i1++)add.push(inject.child(i1));match=match.matchFragment(inject)}let openEndCount=fragment.size+sliceDepth-(slice.content.size-slice.openEnd);for(;taken<fragment.childCount;){let next=fragment.child(taken),matches=match.matchType(next.type);if(!matches)break;(++taken>1||0==openStart||next.content.size)&&(match=matches,add.push(function closeNodeStart(node,openStart,openEnd){if(openStart<=0)return node;let frag=node.content;return openStart>1&&(frag=frag.replaceChild(0,closeNodeStart(frag.firstChild,openStart-1,1==frag.childCount?openEnd-1:0))),openStart>0&&(frag=node.type.contentMatch.fillBefore(frag).append(frag),openEnd<=0&&(frag=frag.append(node.type.contentMatch.matchFragment(frag).fillBefore(prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.HY.empty,!0)))),node.copy(frag)}(next.mark(type.allowedMarks(next.marks)),1==taken?openStart:0,taken==fragment.childCount?openEndCount:-1)))}let toEnd=taken==fragment.childCount;toEnd||(openEndCount=-1),this.placed=addToFragment(this.placed,frontierDepth,prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.HY.from(add)),this.frontier[frontierDepth].match=match,toEnd&&openEndCount<0&&parent&&parent.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let i2=0,cur=fragment;i2<openEndCount;i2++){let node=cur.lastChild;this.frontier.push({type:node.type,match:node.contentMatchAt(node.childCount)}),cur=node.content}this.unplaced=toEnd?0==sliceDepth?prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.p2.empty:new prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.p2(dropFromFragment(slice.content,sliceDepth-1,1),sliceDepth-1,openEndCount<0?slice.openEnd:sliceDepth-1):new prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.p2(dropFromFragment(slice.content,sliceDepth,taken),slice.openStart,slice.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return -1;let top=this.frontier[this.depth],level;if(!top.type.isTextblock||!contentAfterFits(this.$to,this.$to.depth,top.type,top.match,!1)||this.$to.depth==this.depth&&(level=this.findCloseLevel(this.$to))&&level.depth==this.depth)return -1;let{depth}=this.$to,after=this.$to.after(depth);for(;depth>1&&after==this.$to.end(--depth);)++after;return after}findCloseLevel($to){scan:for(let i=Math.min(this.depth,$to.depth);i>=0;i--){let{match,type}=this.frontier[i],dropInner=i<$to.depth&&$to.end(i+1)==$to.pos+($to.depth-(i+1)),fit=contentAfterFits($to,i,type,match,dropInner);if(fit){for(let d=i-1;d>=0;d--){let{match:match1,type:type1}=this.frontier[d],matches=contentAfterFits($to,d,type1,match1,!0);if(!matches||matches.childCount)continue scan}return{depth:i,fit,move:dropInner?$to.doc.resolve($to.after(i+1)):$to}}}}close($to){let close=this.findCloseLevel($to);if(!close)return null;for(;this.depth>close.depth;)this.closeFrontierNode();close.fit.childCount&&(this.placed=addToFragment(this.placed,close.depth,close.fit)),$to=close.move;for(let d=close.depth+1;d<=$to.depth;d++){let node=$to.node(d),add=node.type.contentMatch.fillBefore(node.content,!0,$to.index(d));this.openFrontierNode(node.type,node.attrs,add)}return $to}openFrontierNode(type,attrs=null,content){let top=this.frontier[this.depth];top.match=top.match.matchType(type),this.placed=addToFragment(this.placed,this.depth,prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.HY.from(type.create(attrs,content))),this.frontier.push({type,match:type.contentMatch})}closeFrontierNode(){let add=this.frontier.pop().match.fillBefore(prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.HY.empty,!0);add.childCount&&(this.placed=addToFragment(this.placed,this.frontier.length,add))}}function dropFromFragment(fragment,depth,count){return 0==depth?fragment.cutByIndex(count,fragment.childCount):fragment.replaceChild(0,fragment.firstChild.copy(dropFromFragment(fragment.firstChild.content,depth-1,count)))}function addToFragment(fragment,depth,content){return 0==depth?fragment.append(content):fragment.replaceChild(fragment.childCount-1,fragment.lastChild.copy(addToFragment(fragment.lastChild.content,depth-1,content)))}function contentAt(fragment,depth){for(let i=0;i<depth;i++)fragment=fragment.firstChild.content;return fragment}function contentAfterFits($to,depth,type,match,open){let node=$to.node(depth),index=open?$to.indexAfter(depth):$to.index(depth);if(index==node.childCount&&!type.compatibleContent(node.type))return null;let fit=match.fillBefore(node.content,!0,index);return fit&&!function(type,fragment,start){for(let i=start;i<fragment.childCount;i++)if(!type.allowsMarks(fragment.child(i).marks))return!0;return!1}(type,node.content,index)?fit:null}function coveredDepths($from,$to){let result=[],minDepth=Math.min($from.depth,$to.depth);for(let d=minDepth;d>=0;d--){let start=$from.start(d);if(start<$from.pos-($from.depth-d)||$to.end(d)>$to.pos+($to.depth-d)||$from.node(d).type.spec.isolating||$to.node(d).type.spec.isolating)break;(start==$to.start(d)||d==$from.depth&&d==$to.depth&&$from.parent.inlineContent&&$to.parent.inlineContent&&d&&$to.start(d-1)==start-1)&&result.push(d)}return result}class AttrStep extends Step{constructor(pos,attr,value){super(),this.pos=pos,this.attr=attr,this.value=value}apply(doc){let node=doc.nodeAt(this.pos);if(!node)return StepResult.fail("No node at attribute step's position");let attrs=Object.create(null);for(let name in node.attrs)attrs[name]=node.attrs[name];attrs[this.attr]=this.value;let updated=node.type.create(attrs,null,node.marks);return StepResult.fromReplace(doc,this.pos,this.pos+1,new prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.p2(prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.HY.from(updated),0,node.isLeaf?0:1))}getMap(){return StepMap.empty}invert(doc){return new AttrStep(this.pos,this.attr,doc.nodeAt(this.pos).attrs[this.attr])}map(mapping){let pos=mapping.mapResult(this.pos,1);return pos.deletedAfter?null:new AttrStep(pos.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(schema,json){if("number"!=typeof json.pos||"string"!=typeof json.attr)throw RangeError("Invalid input for AttrStep.fromJSON");return new AttrStep(json.pos,json.attr,json.value)}}Step.jsonID("attr",AttrStep);let TransformError=class extends Error{};(TransformError=function TransformError(message){let err=Error.call(this,message);return err.__proto__=TransformError.prototype,err}).prototype=Object.create(Error.prototype),TransformError.prototype.constructor=TransformError,TransformError.prototype.name="TransformError";class Transform{constructor(doc){this.doc=doc,this.steps=[],this.docs=[],this.mapping=new Mapping}get before(){return this.docs.length?this.docs[0]:this.doc}step(step){let result=this.maybeStep(step);if(result.failed)throw new TransformError(result.failed);return this}maybeStep(step){let result=step.apply(this.doc);return result.failed||this.addStep(step,result.doc),result}get docChanged(){return this.steps.length>0}addStep(step,doc){this.docs.push(this.doc),this.steps.push(step),this.mapping.appendMap(step.getMap()),this.doc=doc}replace(from,to=from,slice=prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.p2.empty){let step=replaceStep(this.doc,from,to,slice);return step&&this.step(step),this}replaceWith(from,to,content){return this.replace(from,to,new prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.p2(prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.HY.from(content),0,0))}delete(from,to){return this.replace(from,to,prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.p2.empty)}insert(pos,content){return this.replaceWith(pos,pos,content)}replaceRange(from,to,slice){return!function(tr,from,to,slice){if(!slice.size)return tr.deleteRange(from,to);let $from=tr.doc.resolve(from),$to=tr.doc.resolve(to);if(fitsTrivially($from,$to,slice))return tr.step(new ReplaceStep(from,to,slice));let targetDepths=coveredDepths($from,tr.doc.resolve(to));0==targetDepths[targetDepths.length-1]&&targetDepths.pop();let preferredTarget=-($from.depth+1);targetDepths.unshift(preferredTarget);for(let d=$from.depth,pos=$from.pos-1;d>0;d--,pos--){let spec=$from.node(d).type.spec;if(spec.defining||spec.definingAsContext||spec.isolating)break;targetDepths.indexOf(d)>-1?preferredTarget=d:$from.before(d)==pos&&targetDepths.splice(1,0,-d)}let preferredTargetIndex=targetDepths.indexOf(preferredTarget),leftNodes=[],preferredDepth=slice.openStart;for(let content=slice.content,i=0;;i++){let node=content.firstChild;if(leftNodes.push(node),i==slice.openStart)break;content=node.content}for(let d1=preferredDepth-1;d1>=0;d1--){let type=leftNodes[d1].type,def=type.spec.defining||type.spec.definingForContent;if(def&&$from.node(preferredTargetIndex).type!=type)preferredDepth=d1;else if(def||!type.isTextblock)break}for(let j=slice.openStart;j>=0;j--){let openDepth=(j+preferredDepth+1)%(slice.openStart+1),insert=leftNodes[openDepth];if(insert)for(let i1=0;i1<targetDepths.length;i1++){let targetDepth=targetDepths[(i1+preferredTargetIndex)%targetDepths.length],expand=!0;targetDepth<0&&(expand=!1,targetDepth=-targetDepth);let parent=$from.node(targetDepth-1),index=$from.index(targetDepth-1);if(parent.canReplaceWith(index,index,insert.type,insert.marks))return tr.replace($from.before(targetDepth),expand?$to.after(targetDepth):to,new prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.p2(function closeFragment(fragment,depth,oldOpen,newOpen,parent){if(depth<oldOpen){let first=fragment.firstChild;fragment=fragment.replaceChild(0,first.copy(closeFragment(first.content,depth+1,oldOpen,newOpen,first)))}if(depth>newOpen){let match=parent.contentMatchAt(0),start=match.fillBefore(fragment).append(fragment);fragment=start.append(match.matchFragment(start).fillBefore(prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.HY.empty,!0))}return fragment}(slice.content,0,slice.openStart,openDepth),openDepth,slice.openEnd))}}let startSteps=tr.steps.length;for(let i2=targetDepths.length-1;i2>=0&&(tr.replace(from,to,slice),!(tr.steps.length>startSteps));i2--){let depth=targetDepths[i2];depth<0||(from=$from.before(depth),to=$to.after(depth))}}(this,from,to,slice),this}replaceRangeWith(from,to,node){return!function(tr,from,to,node){if(!node.isInline&&from==to&&tr.doc.resolve(from).parent.content.size){let point=insertPoint(tr.doc,from,node.type);null!=point&&(from=to=point)}tr.replaceRange(from,to,new prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.p2(prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.HY.from(node),0,0))}(this,from,to,node),this}deleteRange(from,to){return!function(tr,from,to){let $from=tr.doc.resolve(from),$to=tr.doc.resolve(to),covered=coveredDepths($from,$to);for(let i=0;i<covered.length;i++){let depth=covered[i],last=i==covered.length-1;if(last&&0==depth||$from.node(depth).type.contentMatch.validEnd)return tr.delete($from.start(depth),$to.end(depth));if(depth>0&&(last||$from.node(depth-1).canReplace($from.index(depth-1),$to.indexAfter(depth-1))))return tr.delete($from.before(depth),$to.after(depth))}for(let d=1;d<=$from.depth&&d<=$to.depth;d++)if(from-$from.start(d)==$from.depth-d&&to>$from.end(d)&&$to.end(d)-to!=$to.depth-d)return tr.delete($from.before(d),to);tr.delete(from,to)}(this,from,to),this}lift(range,target){return!function(tr,range,target){let{$from,$to,depth}=range,gapStart=$from.before(depth+1),gapEnd=$to.after(depth+1),start=gapStart,end=gapEnd,before=prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.HY.empty,openStart=0;for(let d=depth,splitting=!1;d>target;d--)splitting||$from.index(d)>0?(splitting=!0,before=prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.HY.from($from.node(d).copy(before)),openStart++):start--;let after=prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.HY.empty,openEnd=0;for(let d1=depth,splitting1=!1;d1>target;d1--)splitting1||$to.after(d1+1)<$to.end(d1)?(splitting1=!0,after=prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.HY.from($to.node(d1).copy(after)),openEnd++):end++;tr.step(new ReplaceAroundStep(start,end,gapStart,gapEnd,new prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.p2(before.append(after),openStart,openEnd),before.size-openStart,!0))}(this,range,target),this}join(pos,depth=1){return!function(tr,pos,depth){let step=new ReplaceStep(pos-depth,pos+depth,prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.p2.empty,!0);tr.step(step)}(this,pos,depth),this}wrap(range,wrappers){return!function(tr,range,wrappers){let content=prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.HY.empty;for(let i=wrappers.length-1;i>=0;i--){if(content.size){let match=wrappers[i].type.contentMatch.matchFragment(content);if(!match||!match.validEnd)throw RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}content=prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.HY.from(wrappers[i].type.create(wrappers[i].attrs,content))}let start=range.start,end=range.end;tr.step(new ReplaceAroundStep(start,end,start,end,new prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.p2(content,0,0),wrappers.length,!0))}(this,range,wrappers),this}setBlockType(from,to=from,type,attrs=null){return!function(tr,from,to,type,attrs){if(!type.isTextblock)throw RangeError("Type given to setBlockType should be a textblock");let mapFrom=tr.steps.length;tr.doc.nodesBetween(from,to,(node,pos)=>{var doc,pos1;let $pos,index;if(node.isTextblock&&!node.hasMarkup(type,attrs)&&(doc=tr.doc,pos1=tr.mapping.slice(mapFrom).map(pos),index=($pos=doc.resolve(pos1)).index(),$pos.parent.canReplaceWith(index,index+1,type))){tr.clearIncompatible(tr.mapping.slice(mapFrom).map(pos,1),type);let mapping=tr.mapping.slice(mapFrom),startM=mapping.map(pos,1),endM=mapping.map(pos+node.nodeSize,1);return tr.step(new ReplaceAroundStep(startM,endM,startM+1,endM-1,new prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.p2(prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.HY.from(type.create(attrs,null,node.marks)),0,0),1,!0)),!1}})}(this,from,to,type,attrs),this}setNodeMarkup(pos,type,attrs=null,marks){return!function(tr,pos,type,attrs,marks){let node=tr.doc.nodeAt(pos);if(!node)throw RangeError("No node at given position");type||(type=node.type);let newNode=type.create(attrs,null,marks||node.marks);if(node.isLeaf)return tr.replaceWith(pos,pos+node.nodeSize,newNode);if(!type.validContent(node.content))throw RangeError("Invalid content for node type "+type.name);tr.step(new ReplaceAroundStep(pos,pos+node.nodeSize,pos+1,pos+node.nodeSize-1,new prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.p2(prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.HY.from(newNode),0,0),1,!0))}(this,pos,type,attrs,marks),this}setNodeAttribute(pos,attr,value){return this.step(new AttrStep(pos,attr,value)),this}addNodeMark(pos,mark){return this.step(new AddNodeMarkStep(pos,mark)),this}removeNodeMark(pos,mark){if(!(mark instanceof prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.vc)){let node=this.doc.nodeAt(pos);if(!node)throw RangeError("No node at position "+pos);if(!(mark=mark.isInSet(node.marks)))return this}return this.step(new RemoveNodeMarkStep(pos,mark)),this}split(pos,depth=1,typesAfter){return!function(tr,pos,depth=1,typesAfter){let $pos=tr.doc.resolve(pos),before=prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.HY.empty,after=prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.HY.empty;for(let d=$pos.depth,e=$pos.depth-depth,i=depth-1;d>e;d--,i--){before=prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.HY.from($pos.node(d).copy(before));let typeAfter=typesAfter&&typesAfter[i];after=prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.HY.from(typeAfter?typeAfter.type.create(typeAfter.attrs,after):$pos.node(d).copy(after))}tr.step(new ReplaceStep(pos,pos,new prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.p2(before.append(after),depth,depth),!0))}(this,pos,depth,typesAfter),this}addMark(from,to,mark){var tr;let removing,adding,removed,added;return tr=this,removed=[],added=[],tr.doc.nodesBetween(from,to,(node,pos,parent)=>{if(!node.isInline)return;let marks=node.marks;if(!mark.isInSet(marks)&&parent.type.allowsMarkType(mark.type)){let start=Math.max(pos,from),end=Math.min(pos+node.nodeSize,to),newSet=mark.addToSet(marks);for(let i=0;i<marks.length;i++)marks[i].isInSet(newSet)||(removing&&removing.to==start&&removing.mark.eq(marks[i])?removing.to=end:removed.push(removing=new RemoveMarkStep(start,end,marks[i])));adding&&adding.to==start?adding.to=end:added.push(adding=new AddMarkStep(start,end,mark))}}),removed.forEach(s=>tr.step(s)),added.forEach(s=>tr.step(s)),this}removeMark(from,to,mark){var tr;let matched,step;return tr=this,matched=[],step=0,tr.doc.nodesBetween(from,to,(node,pos)=>{if(!node.isInline)return;step++;let toRemove=null;if(mark instanceof prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.ZU){let set=node.marks,found;for(;found=mark.isInSet(set);)(toRemove||(toRemove=[])).push(found),set=found.removeFromSet(set)}else mark?mark.isInSet(node.marks)&&(toRemove=[mark]):toRemove=node.marks;if(toRemove&&toRemove.length){let end=Math.min(pos+node.nodeSize,to);for(let i=0;i<toRemove.length;i++){let style=toRemove[i],found1;for(let j=0;j<matched.length;j++){let m=matched[j];m.step==step-1&&style.eq(matched[j].style)&&(found1=m)}found1?(found1.to=end,found1.step=step):matched.push({style,from:Math.max(pos,from),to:end,step})}}}),matched.forEach(m=>tr.step(new RemoveMarkStep(m.from,m.to,m.style))),this}clearIncompatible(pos,parentType,match){return!function(tr,pos,parentType,match=parentType.contentMatch){let node=tr.doc.nodeAt(pos),delSteps=[],cur=pos+1;for(let i=0;i<node.childCount;i++){let child=node.child(i),end=cur+child.nodeSize,allowed=match.matchType(child.type);if(allowed){match=allowed;for(let j=0;j<child.marks.length;j++)parentType.allowsMarkType(child.marks[j].type)||tr.step(new RemoveMarkStep(cur,end,child.marks[j]))}else delSteps.push(new ReplaceStep(cur,end,prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.p2.empty));cur=end}if(!match.validEnd){let fill=match.fillBefore(prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.HY.empty,!0);tr.replace(cur,cur,new prosemirror_model__WEBPACK_IMPORTED_MODULE_0__.p2(fill,0,0))}for(let i1=delSteps.length-1;i1>=0;i1--)tr.step(delSteps[i1])}(this,pos,parentType,match),this}}}}]);